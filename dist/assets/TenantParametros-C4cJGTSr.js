import{j as e,m as a}from"./utils-CdldNp8C.js";import{r as t}from"./react-vendor-qiAl16-a.js";import{u as r}from"./index-Cw49fHmj.js";import{F as s,t as l,S as n,B as o,l as i,h as d,I as c,s as m}from"./ui-vendor-CnmmTMy8.js";function u(){const u=r(),[x,p]=t.useState([]),[I,j]=t.useState(null),[h,y]=t.useState([]),[T,f]=t.useState(!1),[E,P]=t.useState(!1),[v,S]=t.useState(null),[w]=s.useForm(),O=async()=>{if(I)try{f(!0);const e=await u.listTenantParametros(I);y(e.rows||[])}catch(e){m.error(e?.response?.data?.detail||"Erro ao carregar parâmetros")}finally{f(!1)}};t.useEffect(()=>{(async()=>{try{const e=await u.listTenants();p(e.rows||[]);const a=localStorage.getItem("tenantSlug")||"captar",t=(e.rows||[]).find(e=>e.Slug===a);t?.IdTenant&&j(t.IdTenant)}catch{}})()},[]),t.useEffect(()=>{O()},[I]);const b=[{title:"ID",dataIndex:"IdParametro"},{title:"CHAVE",dataIndex:"Chave"},{title:"VALOR",dataIndex:"Valor"},{title:"TIPO",dataIndex:"Tipo"},{title:"DESCRIÇÃO",dataIndex:"Descricao"},{title:"ATUALIZADO",dataIndex:"AtualizadoEm"},{title:"AÇÕES",dataIndex:"__actions__",render:(a,t)=>e.jsxs(n,{children:[e.jsx(o,{type:"text",onClick:()=>{S(t),w.setFieldsValue(t),P(!0)},children:"EDITAR"}),e.jsx(o,{type:"text",danger:!0,onClick:async()=>{try{await u.deleteTenantParametro(I,t.IdParametro),m.success("Parâmetro deletado"),await O()}catch(e){m.error(e?.response?.data?.detail||"Erro ao deletar")}},children:"DELETAR"})]})}],g=(x||[]).map(e=>({value:e.IdTenant,label:e.Nome}));return e.jsxs(a.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[e.jsx(l,{style:{width:280},placeholder:"Selecione o tenant",options:g,value:I??void 0,onChange:e=>j(e)}),e.jsx(n,{children:e.jsx(o,{type:"primary",onClick:()=>{S(null),w.resetFields(),P(!0)},disabled:!I,children:"NOVO PARÂMETRO"})})]}),e.jsx(i,{rowKey:e=>e.IdParametro||JSON.stringify(e),loading:T,dataSource:h,columns:b,bordered:!0,size:"middle"}),e.jsx(d,{open:E,title:v?.IdParametro?"Editar Parâmetro":"Novo Parâmetro",onCancel:()=>P(!1),onOk:async()=>{if(I)try{const e=await w.validateFields();v?.IdParametro?(await u.updateTenantParametro(I,v.IdParametro,e),m.success("Parâmetro atualizado")):(await u.createTenantParametro(I,e),m.success("Parâmetro criado")),P(!1),S(null),await O()}catch{}},children:e.jsxs(s,{form:w,layout:"vertical",children:[e.jsx(s.Item,{name:"Chave",label:"Chave",rules:[{required:!0}],children:e.jsx(c,{})}),e.jsx(s.Item,{name:"Valor",label:"Valor",rules:[{required:!0}],children:e.jsx(c,{})}),e.jsx(s.Item,{name:"Tipo",label:"Tipo",children:e.jsx(l,{options:[{value:"TEXT",label:"TEXT"},{value:"NUMBER",label:"NUMBER"},{value:"BOOL",label:"BOOL"}]})}),e.jsx(s.Item,{name:"Descricao",label:"Descrição",children:e.jsx(c,{})})]})})]})}export{u as default};
