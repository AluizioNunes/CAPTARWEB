const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Disparos-BY_e1a6j.js","assets/utils-CdldNp8C.js","assets/react-vendor-qiAl16-a.js","assets/ui-vendor-W3kvUvq_.js","assets/Campanha-2pxynhbc.js","assets/Dashboard-CocegMTM.js","assets/Estatisticas-9DkqdTPw.js","assets/Tenants-esovPh8J.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,a,r)=>((t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r)(t,"symbol"!=typeof a?a+"":a,r);import{a,j as r,p as n,i as o,c as s,b as i,d as l,e as c,f as d,g as u,m,A as p}from"./utils-CdldNp8C.js";import{f as h,g,r as f,R as y,u as x,h as v,a as b,B as j,i as w,j as S,N as C}from"./react-vendor-qiAl16-a.js";import{L as I,R as A,a as T,b as E,c as N,d as k,e as D,f as U,M as O,D as R,B as M,A as L,g as P,h as F,F as _,i as $,I as V,j as z,S as B,T as H,k as Y,s as q,l as W,m as J,C as X,n as K,o as G,p as Z,q as Q,r as ee,t as te,u as ae,v as re,w as ne,x as oe,y as se,z as ie,E as le,G as ce,H as de,J as ue,K as me,N as pe,O as he,P as ge,Q as fe,U as ye,V as xe,W as ve,X as be,Y as je}from"./ui-vendor-W3kvUvq_.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var we,Se={};const Ce=g(function(){if(we)return Se;we=1;var e=h();return Se.createRoot=e.createRoot,Se.hydrateRoot=e.hydrateRoot,Se}()),Ie=(import.meta,"/api");const Ae=new class{constructor(){t(this,"api"),this.api=a.create({baseURL:Ie,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(e=>{const t=localStorage.getItem("token");t&&(e.headers.Authorization=`Bearer ${t}`);const a=String(e.url||"").includes("/auth/login"),r=!(!e.headers||!e.headers["X-Tenant"]);if(a)!r&&e.headers&&delete e.headers["X-Tenant"];else{const t=localStorage.getItem("rootTenantSlug")||"captar",a="1"===localStorage.getItem("adminContext"),r=localStorage.getItem("tenantSlug")||"captar",n=a&&"captar"===String(t).toLowerCase()?"captar":r;e.headers["X-Tenant"]=n;const o=localStorage.getItem("viewTenantSlug")||"";a&&o?e.headers["X-View-Tenant"]=o:e.headers["X-View-Tenant"]&&delete e.headers["X-View-Tenant"]}return e}),this.api.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)))}async login(e){const t=async t=>{const a=t??"captar",r=a?{headers:{"X-Tenant":a}}:{},n=(await this.api.post("/auth/login",e,r)).data,o=String((n?.tenantSlug??n?.tenant??n?.slug??n?.TenantSlug??n?.Tenant)||a);localStorage.setItem("tenantSlug",o);try{localStorage.getItem("rootTenantSlug")||localStorage.setItem("rootTenantSlug",o),"captar"===o.toLowerCase()&&(localStorage.setItem("rootTenantSlug","captar"),localStorage.setItem("adminContext","1"))}catch{}try{const e=await this.listTenants(),t=(e.rows||[]).find(e=>String(e.Slug??e.slug).toUpperCase()===o.toUpperCase()),a=t?String(t.Nome??t.nome):o;localStorage.setItem("tenantName",a)}catch{}if(n&&n.token&&!n.user){const e={id:n.id,nome:n.nome,funcao:n.funcao,usuario:n.usuario,email:n.email,cpf:n.cpf,perfil:n.funcao};return{token:n.token,user:e}}return n};try{return await t()}catch(a){try{return await t("captar")}catch(r){try{const e=await this.listTenants().catch(()=>({rows:[]})),a=(e.rows||[]).map(e=>String(e.Slug??e.slug??"")).filter(Boolean);for(const r of a)try{return await t(r)}catch{}}catch{}throw a}}}async healthDb(){try{return(await this.api.get("/health/db")).data}catch(e){try{return{ok:!!(await this.api.get("/health")).data}}catch(t){try{const e=a.create({baseURL:"http://localhost:8001",headers:{"Content-Type":"application/json"}});return(await e.get("/api/health/db")).data}catch(r){const e=a.create({baseURL:"http://localhost:8001",headers:{"Content-Type":"application/json"}});return{ok:!!(await e.get("/health")).data}}}}}async logout(){await this.api.post("/auth/logout")}async getCurrentUser(){return(await this.api.get("/auth/me")).data}async getPermissoes(){return(await this.api.get("/permissoes")).data}async getPermissao(e){return(await this.api.get(`/permissoes/${e}`)).data}async updatePermissao(e,t){return(await this.api.put(`/permissoes/${e}`,t)).data}async createPermissao(e){return(await this.api.post("/permissoes",e)).data}async deletePermissao(e){return(await this.api.delete(`/permissoes/${e}`)).data}async getPerfilSchema(){try{return(await this.api.get("/perfil/schema")).data}catch(e){const t=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}});return(await t.get("/perfil/schema")).data}}async listPerfil(){const e=(localStorage.getItem("tenantSlug")||"captar").toLowerCase(),t=await this.api.get("/perfil").then(e=>e.data).catch(async()=>{const e=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}});return(await e.get("/perfil")).data});if("captar"===e)return t;const r={"Content-Type":"application/json","X-Tenant":"captar"},n=localStorage.getItem("token");n&&(r.Authorization=`Bearer ${n}`);const o=a.create({baseURL:Ie,headers:r}),s=await o.get("/perfil").then(e=>e.data).catch(async()=>{const e=a.create({baseURL:"http://localhost:8001/api",headers:r});return(await e.get("/perfil")).data}),i=t.rows||[],l=s.rows||[],c={};for(const a of[...l,...i]){const e=String(a.Perfil??a.perfil??a.Descricao??a.descricao??"").toUpperCase();c[e]||(c[e]=a)}return{rows:Object.values(c),columns:t.columns||s.columns||[]}}async createPerfil(e){try{return(await this.api.post("/perfil",e)).data}catch(t){const r=a.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"}});return(await r.post("/perfil",e)).data}}async updatePerfil(e,t){try{return(await this.api.put(`/perfil/${e}`,t)).data}catch(r){const n=a.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"}});return(await n.put(`/perfil/${e}`,t)).data}}async deletePerfil(e){try{return(await this.api.delete(`/perfil/${e}`)).data}catch(t){const r=a.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"}});return(await r.delete(`/perfil/${e}`)).data}}async getFuncoesSchema(){return(await this.api.get("/funcoes/schema")).data}async listFuncoes(){const e=(localStorage.getItem("tenantSlug")||"captar").toLowerCase(),t=await this.api.get("/funcoes").then(e=>e.data).catch(async()=>{const e=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}});return(await e.get("/funcoes")).data});if("captar"===e)return t;const r={"Content-Type":"application/json","X-Tenant":"captar"},n=localStorage.getItem("token");n&&(r.Authorization=`Bearer ${n}`);const o=a.create({baseURL:Ie,headers:r}),s=await o.get("/funcoes").then(e=>e.data).catch(async()=>{const e=a.create({baseURL:"http://localhost:8001/api",headers:r});return(await e.get("/funcoes")).data}),i=t.rows||[],l=s.rows||[],c={};for(const a of[...l,...i]){const e=String(a.Funcao??a.funcao??a.Descricao??a.descricao??"").toUpperCase();c[e]||(c[e]=a)}return{rows:Object.values(c),columns:t.columns||s.columns||[]}}async createFuncao(e){return(await this.api.post("/funcoes",e)).data}async updateFuncao(e,t){return(await this.api.put(`/funcoes/${e}`,t)).data}async deleteFuncao(e){return(await this.api.delete(`/funcoes/${e}`)).data}async applyFilter(e){return(await this.api.post("/filtros/aplicar",e)).data}async exportExcel(e){return(await this.api.post("/export/excel",{tabela:e},{responseType:"blob"})).data}async exportPdf(e){return(await this.api.post("/export/pdf",{tabela:e},{responseType:"blob"})).data}async exportData(e,t){try{const a="excel"===t?await this.exportExcel(e):await this.exportPdf(e),r=window.URL.createObjectURL(new Blob([a])),n=document.createElement("a");n.href=r,n.setAttribute("download",`${e}.${"excel"===t?"xlsx":"pdf"}`),document.body.appendChild(n),n.click(),n.parentNode?.removeChild(n)}catch(a){throw a}}async getAuditLogs(e=0,t=100){return(await this.api.get("/audit-logs",{params:{skip:e,limit:t}})).data}async createAuditLog(e){return(await this.api.post("/audit-logs",e)).data}async getAuditLogsByUser(e){return(await this.api.get(`/audit-logs/usuario/${e}`)).data}async importCsv(e){const t=new FormData;t.append("file",e);return(await this.api.post("/import/csv",t,{headers:{"Content-Type":"multipart/form-data"}})).data}async getNotificacoes(e){return(await this.api.get(`/notificacoes/${e}`)).data}async createNotificacao(e){return(await this.api.post("/notificacoes",e)).data}async marcarNotificacaoLida(e){return(await this.api.put(`/notificacoes/${e}/marcar-lida`)).data}async getEleitoresSchema(){try{return(await this.api.get("/eleitores/schema")).data}catch(e){return{columns:[{name:"id",type:"integer",nullable:!1},{name:"nome",type:"string",nullable:!1},{name:"cpf",type:"string",nullable:!0},{name:"celular",type:"string",nullable:!0},{name:"bairro",type:"string",nullable:!0},{name:"zona_eleitoral",type:"string",nullable:!0},{name:"DataCadastro",type:"datetime",nullable:!0},{name:"TenantLayer",type:"string",nullable:!0}]}}}async getEleitores(){try{const e=(await this.api.get("/eleitores")).data,t=Array.isArray(e)?e:e.rows||[],a="1"===(localStorage.getItem("adminContext")||""),r=(localStorage.getItem("viewTenantSlug")||"").toUpperCase(),n=(localStorage.getItem("viewTenantName")||"").toUpperCase();if(a&&r){const a=new Set([r,n]);return{rows:t.filter(e=>a.has(String(e.TenantLayer||"").toUpperCase())),columns:Array.isArray(e)?[]:e.columns||[]}}return{rows:t,columns:Array.isArray(e)?[]:e.columns||[]}}catch(e){const t=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}}),r=(await t.get("/eleitores")).data,n=Array.isArray(r)?r:r.rows||[],o="1"===(localStorage.getItem("adminContext")||""),s=(localStorage.getItem("viewTenantSlug")||"").toUpperCase(),i=(localStorage.getItem("viewTenantName")||"").toUpperCase();if(o&&s){const e=new Set([s,i]);return{rows:n.filter(t=>e.has(String(t.TenantLayer||"").toUpperCase())),columns:Array.isArray(r)?[]:r.columns||[]}}return{rows:n,columns:Array.isArray(r)?[]:r.columns||[]}}}async createEleitor(e){return(await this.api.post("/eleitores",e)).data}async updateEleitor(e,t){return(await this.api.put(`/eleitores/${e}`,t)).data}async deleteEleitor(e){return(await this.api.delete(`/eleitores/${e}`)).data}async getAtivistasSchema(){try{return(await this.api.get("/ativistas/schema")).data}catch(e){return{columns:[{name:"id",type:"integer",nullable:!1},{name:"nome",type:"string",nullable:!1},{name:"tipo_apoio",type:"string",nullable:!0},{name:"area_atuacao",type:"string",nullable:!0},{name:"DataCadastro",type:"datetime",nullable:!0},{name:"TenantLayer",type:"string",nullable:!0}]}}}async getAtivistas(){try{const e=(await this.api.get("/ativistas")).data,t=Array.isArray(e)?e:e.rows||[],a="1"===(localStorage.getItem("adminContext")||""),r=(localStorage.getItem("viewTenantSlug")||"").toUpperCase(),n=(localStorage.getItem("viewTenantName")||"").toUpperCase();if(a&&r){const a=new Set([r,n]);return{rows:t.filter(e=>a.has(String(e.TenantLayer||"").toUpperCase())),columns:Array.isArray(e)?[]:e.columns||[]}}return{rows:t,columns:Array.isArray(e)?[]:e.columns||[]}}catch(e){const t=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}}),r=(await t.get("/ativistas")).data,n=Array.isArray(r)?r:r.rows||[],o="1"===(localStorage.getItem("adminContext")||""),s=(localStorage.getItem("viewTenantSlug")||"").toUpperCase(),i=(localStorage.getItem("viewTenantName")||"").toUpperCase();if(o&&s){const e=new Set([s,i]);return{rows:n.filter(t=>e.has(String(t.TenantLayer||"").toUpperCase())),columns:Array.isArray(r)?[]:r.columns||[]}}return{rows:n,columns:Array.isArray(r)?[]:r.columns||[]}}}async createAtivista(e){return(await this.api.post("/ativistas",e)).data}async updateAtivista(e,t){return(await this.api.put(`/ativistas/${e}`,t)).data}async deleteAtivista(e){return(await this.api.delete(`/ativistas/${e}`)).data}async getCampanhasSchema(){try{return(await this.api.get("/campanhas/schema")).data}catch(e){return{columns:[{name:"id",type:"integer",nullable:!1},{name:"nome",type:"string",nullable:!1},{name:"descricao",type:"text",nullable:!0},{name:"status",type:"boolean",nullable:!0},{name:"data_inicio",type:"date",nullable:!1},{name:"data_fim",type:"date",nullable:!0},{name:"meta",type:"integer",nullable:!0},{name:"enviados",type:"integer",nullable:!0},{name:"nao_enviados",type:"integer",nullable:!0},{name:"positivos",type:"integer",nullable:!0},{name:"negativos",type:"integer",nullable:!0},{name:"aguardando",type:"integer",nullable:!0},{name:"created_at",type:"datetime",nullable:!0}]}}}async getCampanhas(){return(await this.api.get("/campanhas")).data}async createCampanha(e){return(await this.api.post("/campanhas",e)).data}async updateCampanha(e,t){return(await this.api.put(`/campanhas/${e}`,t)).data}async deleteCampanha(e){return(await this.api.delete(`/campanhas/${e}`)).data}async uploadCampanhaAnexo(e,t){const a=new FormData;t.file&&a.append("file",t.file),t.data_url&&a.append("data_url",t.data_url),t.type&&a.append("type",t.type);return(await this.api.post(`/campanhas/${e}/anexo`,a,{headers:{"Content-Type":"multipart/form-data"}})).data}async listCandidatos(){return(await this.api.get("/candidatos")).data}async createCandidato(e){return(await this.api.post("/candidatos",e)).data}async updateCandidato(e,t){return(await this.api.put(`/candidatos/${e}`,t)).data}async deleteCandidato(e){return(await this.api.delete(`/candidatos/${e}`)).data}async listEleicoes(){return(await this.api.get("/eleicoes")).data}async createEleicao(e){return(await this.api.post("/eleicoes",e)).data}async updateEleicao(e,t){return(await this.api.put(`/eleicoes/${e}`,t)).data}async deleteEleicao(e){return(await this.api.delete(`/eleicoes/${e}`)).data}async listMetas(){return(await this.api.get("/metas")).data}async createMeta(e){return(await this.api.post("/metas",e)).data}async updateMeta(e,t){return(await this.api.put(`/metas/${e}`,t)).data}async deleteMeta(e){return(await this.api.delete(`/metas/${e}`)).data}async getUsuariosSchema(){try{return(await this.api.get("/usuarios/schema")).data}catch(e){const t=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}});return(await t.get("/usuarios/schema")).data}}async listUsuarios(){const e=async()=>{try{const e=localStorage.getItem("tenantSlug")||"captar",t=localStorage.getItem("tenantName")||"",a=(await this.listTenants()).rows||[],r=a.find(e=>String(e.Nome??e.nome).toUpperCase()===String(t).toUpperCase()),n=a.find(t=>String(t.Slug??t.slug)===e),o=r||n;return{id:o?.IdTenant??o?.id,nome:o?.Nome??o?.nome,slug:e}}catch{return{slug:localStorage.getItem("tenantSlug")||"captar",nome:localStorage.getItem("tenantName")||""}}};try{const t=(await this.api.get("/usuarios")).data,a="1"===(localStorage.getItem("adminContext")||""),r=(localStorage.getItem("viewTenantSlug")||"").toUpperCase(),n=(localStorage.getItem("viewTenantName")||"").toUpperCase(),o=await e();if("captar"!==(o.slug||"").toLowerCase()){return{rows:(t.rows||[]).filter(e=>Number(e.IdTenant??e.idTenant)===Number(o.id)),columns:t.columns||[]}}if(a&&r){const e=new Set([r,n]);return{rows:(t.rows||[]).filter(t=>e.has(String(t.TenantLayer||"").toUpperCase())),columns:t.columns||[]}}return t}catch(t){const r=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}}),n=(await r.get("/usuarios")).data,o="1"===(localStorage.getItem("adminContext")||""),s=(localStorage.getItem("viewTenantSlug")||"").toUpperCase(),i=(localStorage.getItem("viewTenantName")||"").toUpperCase(),l=await e();if("captar"!==(l.slug||"").toLowerCase()){return{rows:(n.rows||[]).filter(e=>Number(e.IdTenant??e.idTenant)===Number(l.id)),columns:n.columns||[]}}if(o&&s){const e=new Set([s,i]);return{rows:(n.rows||[]).filter(t=>e.has(String(t.TenantLayer||"").toUpperCase())),columns:n.columns||[]}}return n}}async createUsuario(e){try{return(await this.api.post("/usuarios",e)).data}catch(t){const r=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}});return(await r.post("/usuarios",e)).data}}async updateUsuario(e,t){try{return(await this.api.put(`/usuarios/${e}`,t)).data}catch(r){const n=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}});return(await n.put(`/usuarios/${e}`,t)).data}}async uploadUsuarioFoto(e,t){const a=new FormData;t.file&&a.append("file",t.file),t.data_url&&a.append("data_url",t.data_url);return(await this.api.post(`/usuarios/${e}/foto`,a,{headers:{"Content-Type":"multipart/form-data"}})).data}async deleteUsuario(e){try{return(await this.api.delete(`/usuarios/${e}`)).data}catch(t){const r=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}});return(await r.delete(`/usuarios/${e}`)).data}}async getDashboardStats(){const e="1"===(localStorage.getItem("adminContext")||""),t=(localStorage.getItem("viewTenantSlug")||"").trim(),a={};e&&t&&(a["X-View-Tenant"]=t);const r=(await this.api.get("/dashboard/stats",{headers:a})).data||{};try{if("captar"!==(localStorage.getItem("tenantSlug")||"captar").toLowerCase()){const e=await this.listUsuarios();r.total_usuarios=(e.rows||[]).length}else if(e&&t){const e=await this.listUsuarios();r.total_usuarios=(e.rows||[]).length;try{const e=await this.getEleitores();r.total_eleitores=(e.rows||e||[]).length;const t=await this.getAtivistas();r.total_ativistas=(t.rows||t||[]).length}catch{}}}catch{}return r}async getTopAtivistas(){return(await this.api.get("/dashboard/top-ativistas")).data}async getTopUsuarios(){return(await this.api.get("/dashboard/top-usuarios")).data}async getTopSupervisores(){return(await this.api.get("/dashboard/top-supervisores")).data}async getTopCoordenadores(){return(await this.api.get("/dashboard/top-coordenadores")).data}async getTopBairros(){return(await this.api.get("/dashboard/top-bairros")).data}async getTopZonas(){return(await this.api.get("/dashboard/top-zonas")).data}async listCoordenadores(){return{rows:((await this.listUsuarios()).rows||[]).filter(e=>"COORDENADOR"===String(e.Funcao||e.funcao).toUpperCase().trim()||"ADMINISTRADOR"===String(e.Funcao||e.funcao).toUpperCase().trim())}}async listSupervisores(e){return{rows:((await this.listUsuarios()).rows||[]).filter(t=>"SUPERVISOR"===String(t.Funcao||t.funcao).toUpperCase().trim()&&String(t.Coordenador||t.coordenador).trim()===String(e).trim())}}async getTenantsSchema(){try{return(await this.api.get("/tenants/schema")).data}catch(e){try{return(await this.api.get("/tenants/schema",{baseURL:"http://localhost:8001/api"})).data}catch(t){const e="undefined"!=typeof window?window.location.origin:"",a=e?`${e}/api`:"http://localhost:8001/api";return(await this.api.get("/tenants/schema",{baseURL:a})).data}}}async listTenants(){try{return(await this.api.get("/tenants")).data}catch(e){try{return(await this.api.get("/tenants",{baseURL:"http://localhost:8001/api"})).data}catch(t){const e="undefined"!=typeof window?window.location.origin:"",a=e?`${e}/api`:"http://localhost:8001/api";return(await this.api.get("/tenants",{baseURL:a})).data}}}async createTenant(e){try{return(await this.api.post("/tenants",e)).data}catch(t){try{return(await this.api.post("/tenants",e,{baseURL:"http://localhost:8001/api"})).data}catch(a){const t="undefined"!=typeof window?window.location.origin:"",r=t?`${t}/api`:"http://localhost:8001/api";return(await this.api.post("/tenants",e,{baseURL:r})).data}}}async updateTenant(e,t){try{return(await this.api.put(`/tenants/${e}`,t)).data}catch(a){try{return(await this.api.put(`/tenants/${e}`,t,{baseURL:"http://localhost:8001/api"})).data}catch(r){const a="undefined"!=typeof window?window.location.origin:"",n=a?`${a}/api`:"http://localhost:8001/api";return(await this.api.put(`/tenants/${e}`,t,{baseURL:n})).data}}}async deleteTenant(e){try{return(await this.api.delete(`/tenants/${e}`)).data}catch(t){try{return(await this.api.delete(`/tenants/${e}`,{baseURL:"http://localhost:8001/api"})).data}catch(a){const t="undefined"!=typeof window?window.location.origin:"",r=t?`${t}/api`:"http://localhost:8001/api";return(await this.api.delete(`/tenants/${e}`,{baseURL:r})).data}}}async deleteTenantAndDb(e){try{return(await this.api.delete("/tenants/delete_all",{data:{slug:e}})).data}catch(t){const r=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}});return(await r.delete("/tenants/delete_all",{data:{slug:e}})).data}}async provisionTenant(e){try{return(await this.api.post("/tenants/provision",e)).data}catch(t){const r=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}});return(await r.post("/tenants/provision",e)).data}}async recreateTenantDb(e){try{return(await this.api.post(`/tenants/${e}/recreate_db`)).data}catch(t){try{return(await this.api.post(`/tenants/${e}/recreate_db`,void 0,{baseURL:"http://localhost:8001/api"})).data}catch(a){const t="undefined"!=typeof window?window.location.origin:"",r=t?`${t}/api`:"http://localhost:8001/api";return(await this.api.post(`/tenants/${e}/recreate_db`,void 0,{baseURL:r})).data}}}async setTenantDsn(e,t){try{return(await this.api.post(`/tenants/${e}/set_dsn`,{dsn:t})).data}catch(r){const n=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}});return(await n.post(`/tenants/${e}/set_dsn`,{dsn:t})).data}}async migrateAllTenants(){try{return(await this.api.post("/admin/migrate_all_tenants")).data}catch(e){const t=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}});return(await t.post("/admin/migrate_all_tenants")).data}}async migrateTenantData(e){try{return(await this.api.post("/tenants/migrate_data",{slug:e})).data}catch(t){const r=a.create({baseURL:"http://localhost:8001/api",headers:{"Content-Type":"application/json"}});return(await r.post("/tenants/migrate_data",{slug:e})).data}}async testarIntegracao(e){return(await this.api.post("/integracoes/testar",e)).data}async salvarIntegracaoConfig(e){return(await this.api.post("/integracoes/config",e)).data}async obterIntegracaoConfig(){return(await this.api.get("/integracoes/config")).data}async listarMunicipios(e){return(await this.api.get(`/integracoes/municipios/${e}`)).data}async listarRecursosCkan(e,t){return(await this.api.post("/integracoes/ckan/resources",{dataset:e,uf:t})).data}async previewRecursoCkan(e,t=15){return(await this.api.post("/integracoes/ckan/preview",{resource_url:e,limit:t})).data}async getEvolutionApiKeyMasked(){return(await this.api.get("/integracoes/evolution/key")).data}async testEvolutionApi(){return(await this.api.get("/integracoes/evolution/test")).data}async getConfiguracoes(e){return(await this.api.get("/configuracoes",{params:{categoria:e}})).data}async updateConfiguracao(e,t){return(await this.api.put(`/configuracoes/${e}`,{valor:t})).data}async sendWhatsAppMessage(e,t,a,r){return(await this.api.post("/integrations/whatsapp/send",{phone:e,message:t,media_url:a,text_position:r})).data}},Te=f.createContext(Ae);function Ee({children:e}){const t=f.useMemo(()=>{const e=new Map,t=(e,t)=>`${("undefined"!=typeof window?localStorage.getItem("tenantSlug"):null)||"captar"}:${("undefined"!=typeof window?localStorage.getItem("viewTenantSlug"):null)||""}:${e}:${JSON.stringify(t)}`,a=Ae,r={listTenants:a.listTenants.bind(Ae),listUsuarios:a.listUsuarios.bind(Ae),listPerfil:a.listPerfil.bind(Ae),listFuncoes:a.listFuncoes.bind(Ae),createUsuario:a.createUsuario.bind(Ae),updateUsuario:a.updateUsuario.bind(Ae),deleteUsuario:a.deleteUsuario.bind(Ae),uploadUsuarioFoto:a.uploadUsuarioFoto.bind(Ae)};return a.listTenants=async()=>{const a=t("listTenants",[]);if(e.has(a))return e.get(a);const n=await r.listTenants();return e.set(a,n),n},a.listUsuarios=async()=>{const a=t("listUsuarios",[]);if(e.has(a))return e.get(a);const n=await r.listUsuarios();return e.set(a,n),n},a.listPerfil=async()=>{const a=t("listPerfil",[]);if(e.has(a))return e.get(a);const n=await r.listPerfil();return e.set(a,n),n},a.listFuncoes=async()=>{const a=t("listFuncoes",[]);if(e.has(a))return e.get(a);const n=await r.listFuncoes();return e.set(a,n),n},a.createUsuario=async t=>{const a=await r.createUsuario(t);return e.clear(),a},a.updateUsuario=async(t,a)=>{const n=await r.updateUsuario(t,a);return e.clear(),n},a.deleteUsuario=async t=>{const a=await r.deleteUsuario(t);return e.clear(),a},a.uploadUsuarioFoto=async(t,a)=>{const n=await r.uploadUsuarioFoto(t,a);return e.clear(),n},Ae},[]);return r.jsx(Te.Provider,{value:t,children:e})}function Ne(){return f.useContext(Te)}var ke,De={},Ue={exports:{}};function Oe(){return ke||(ke=1,(e=Ue).exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports),Ue.exports;var e}var Re,Me={};var Le,Pe={},Fe={},_e={},$e={exports:{}},Ve={exports:{}},ze={exports:{}},Be={exports:{}};function He(){return Le||(Le=1,function(e){function t(a){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(a)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(Be)),Be.exports}var Ye,qe,We,Je,Xe={exports:{}};function Ke(){return qe||(qe=1,e=ze,t=He().default,a=function(){return Ye||(Ye=1,e=Xe,t=He().default,e.exports=function(e,a){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,a||"default");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports),Xe.exports;var e,t}(),e.exports=function(e){var r=a(e,"string");return"symbol"==t(r)?r:r+""},e.exports.__esModule=!0,e.exports.default=e.exports),ze.exports;var e,t,a}function Ge(){return Je||(Je=1,function(e){var t=function(){return We||(We=1,e=Ve,t=Ke(),e.exports=function(e,a,r){return(a=t(a))in e?Object.defineProperty(e,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[a]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports),Ve.exports;var e,t}();function a(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}e.exports=function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?a(Object(n),!0).forEach(function(a){t(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports}($e)),$e.exports}var Ze,Qe,et={};function tt(){if(Qe)return _e;Qe=1;var e=Oe().default;Object.defineProperty(_e,"__esModule",{value:!0}),_e.default=void 0;var t=e(Ge()),a=(Ze||(Ze=1,Object.defineProperty(et,"__esModule",{value:!0}),et.commonLocale=void 0,et.commonLocale={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0}),et),r=(0,t.default)((0,t.default)({},a.commonLocale),{},{locale:"pt_BR",today:"Hoje",now:"Agora",backToToday:"Voltar para hoje",ok:"OK",clear:"Limpar",week:"Semana",month:"Mês",year:"Ano",timeSelect:"Selecionar hora",dateSelect:"Selecionar data",monthSelect:"Escolher mês",yearSelect:"Escolher ano",decadeSelect:"Escolher década",dateFormat:"D/M/YYYY",dateTimeFormat:"D/M/YYYY HH:mm:ss",monthBeforeYear:!1,previousMonth:"Mês anterior (PageUp)",nextMonth:"Próximo mês (PageDown)",previousYear:"Ano anterior (Control + esquerda)",nextYear:"Próximo ano (Control + direita)",previousDecade:"Década anterior",nextDecade:"Próxima década",previousCentury:"Século anterior",nextCentury:"Próximo século",shortWeekDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]});return _e.default=r,_e}var at,rt,nt,ot,st,it,lt={};function ct(){if(at)return lt;at=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.default=void 0;return lt.default={placeholder:"Hora",rangePlaceholder:["Hora de início","Hora de término"]},lt}function dt(){if(rt)return Fe;rt=1;var e=Oe().default;Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.default=void 0;var t=e(tt()),a=e(ct());const r={lang:Object.assign({placeholder:"Selecionar data",rangePlaceholder:["Data inicial","Data final"]},t.default),timePickerLocale:Object.assign({},a.default)};return Fe.default=r,Fe}function ut(){if(nt)return Pe;nt=1;var e=Oe().default;Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.default=void 0;var t=e(dt());return Pe.default=t.default,Pe}function mt(){if(ot)return De;ot=1;var e=Oe().default;Object.defineProperty(De,"__esModule",{value:!0}),De.default=void 0;var t=e((Re||(Re=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.default=void 0,Me.default={items_per_page:"/ página",jump_to:"Vá até",jump_to_confirm:"confirme",page:"Página",prev_page:"Página anterior",next_page:"Próxima página",prev_5:"5 páginas anteriores",next_5:"5 próximas páginas",prev_3:"3 páginas anteriores",next_3:"3 próximas páginas",page_size:"tamanho da página"}),Me)),a=e(ut()),r=e(dt()),n=e(ct());const o="${label} não é um ${type} válido",s={locale:"pt-br",Pagination:t.default,DatePicker:r.default,TimePicker:n.default,Calendar:a.default,global:{placeholder:"Por favor escolha",close:"Fechar"},Table:{filterTitle:"Menu de Filtro",filterConfirm:"OK",filterReset:"Resetar",filterEmptyText:"Sem filtros",filterCheckAll:"Selecionar todos os itens",filterSearchPlaceholder:"Pesquisar nos filtros",emptyText:"Sem conteúdo",selectAll:"Selecionar página atual",selectInvert:"Inverter seleção",selectNone:"Apagar todo o conteúdo",selectionAll:"Selecionar todo o conteúdo",sortTitle:"Ordenar título",expand:"Expandir linha",collapse:"Colapsar linha",triggerDesc:"Clique organiza por descendente",triggerAsc:"Clique organiza por ascendente",cancelSort:"Clique para cancelar organização"},Tour:{Next:"Próximo",Previous:"Anterior",Finish:"Finalizar"},Modal:{okText:"OK",cancelText:"Cancelar",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancelar"},Transfer:{titles:["",""],searchPlaceholder:"Procurar",itemUnit:"item",itemsUnit:"items",remove:"Remover",selectCurrent:"Selecionar página atual",removeCurrent:"Remover página atual",selectAll:"Selecionar todos",removeAll:"Remover todos",selectInvert:"Inverter seleção atual"},Upload:{uploading:"Enviando...",removeFile:"Remover arquivo",uploadError:"Erro no envio",previewFile:"Visualizar arquivo",downloadFile:"Baixar arquivo"},Empty:{description:"Não há dados"},Icon:{icon:"ícone"},Text:{edit:"editar",copy:"copiar",copied:"copiado",expand:"expandir"},Form:{optional:"(opcional)",defaultValidateMessages:{default:"Erro ${label} na validação de campo",required:"Por favor, insira ${label}",enum:"${label} deve ser um dos seguinte: [${enum}]",whitespace:"${label} não pode ser um carácter vazio",date:{format:" O formato de data ${label} é inválido",parse:"${label} não pode ser convertido para uma data",invalid:"${label} é uma data inválida"},types:{string:o,method:o,array:o,object:o,number:o,date:o,boolean:o,integer:o,float:o,regexp:o,email:o,url:o,hex:o},string:{len:"${label} deve possuir ${len} caracteres",min:"${label} deve possuir ao menos ${min} caracteres",max:"${label} deve possuir no máximo ${max} caracteres",range:"${label} deve possuir entre ${min} e ${max} caracteres"},number:{len:"${label} deve ser igual à ${len}",min:"O valor mínimo de ${label} é ${min}",max:"O valor máximo de ${label} é ${max}",range:"${label} deve estar entre ${min} e ${max}"},array:{len:"Deve ser ${len} ${label}",min:"No mínimo ${min} ${label}",max:"No máximo ${max} ${label}",range:"A quantidade de ${label} deve estar entre ${min} e ${max}"},pattern:{mismatch:"${label} não se encaixa no padrão ${pattern}"}}},Image:{preview:"Pré-visualização"}};return De.default=s,De}function pt(){return it?st:(it=1,st=mt())}const ht=g(pt()),gt={},ft=function(e,t,a){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),n=a?.nonce||a?.getAttribute("nonce");r=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in gt)return;gt[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,n&&r.setAttribute("nonce",n),document.head.appendChild(r),t?new Promise((t,a)=>{r.addEventListener("load",t),r.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&n(e.reason);return e().catch(n)})},yt=localStorage.getItem("user");let xt=null;if(yt)try{const e=JSON.parse(yt);if(e&&e.login_time){const t=n(e.login_time);if(o(t))xt=e;else{const t=new Date(e.login_time);o(t)?e.login_time=t.toISOString():e.login_time=(new Date).toISOString(),localStorage.setItem("user",JSON.stringify(e)),xt=e}}else xt=e}catch{xt=null,localStorage.removeItem("user")}const vt=s(e=>({user:xt,token:localStorage.getItem("token"),isLoading:!1,isAuthenticated:!!localStorage.getItem("token"),setUser:t=>{t?localStorage.setItem("user",JSON.stringify(t)):localStorage.removeItem("user"),e({user:t})},setToken:t=>{t?localStorage.setItem("token",t):localStorage.removeItem("token"),e({token:t,isAuthenticated:!!t})},setIsLoading:t=>e({isLoading:t}),logout:()=>{localStorage.removeItem("user"),localStorage.removeItem("token"),e({user:null,token:null,isAuthenticated:!1})},login:(t,a)=>{localStorage.setItem("user",JSON.stringify(t)),localStorage.setItem("token",a),e({user:t,token:a,isAuthenticated:!0})}})),bt="/assets/CAPTAR%20LOGO%20OFICIAL-DwGQlJkk.jpg",jt={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 mês",other:"cerca de {{count}} meses"},xMonths:{one:"1 mês",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},wt={date:i({formats:{full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},defaultWidth:"full"}),time:i({formats:{full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},defaultWidth:"full"}),dateTime:i({formats:{full:"{{date}} 'às' {{time}}",long:"{{date}} 'às' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},St={lastWeek:e=>{const t=e.getDay();return"'"+(0===t||6===t?"último":"última")+"' eeee 'às' p"},yesterday:"'ontem às' p",today:"'hoje às' p",tomorrow:"'amanhã às' p",nextWeek:"eeee 'às' p",other:"P"},Ct={code:"pt-BR",formatDistance:(e,t,a)=>{let r;const n=jt[e];return r="string"==typeof n?n:1===t?n.one:n.other.replace("{{count}}",String(t)),a?.addSuffix?a.comparison&&a.comparison>0?"em "+r:"há "+r:r},formatLong:wt,formatRelative:(e,t,a,r)=>{const n=St[e];return"function"==typeof n?n(t):n},localize:{ordinalNumber:(e,t)=>{const a=Number(e);return"week"===t?.unit?a+"ª":a+"º"},era:l({values:{narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},defaultWidth:"wide"}),quarter:l({values:{narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:l({values:{narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},defaultWidth:"wide"}),day:l({values:{narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","terça","quarta","quinta","sexta","sábado"],wide:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"]},defaultWidth:"wide"}),dayPeriod:l({values:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:d({matchPattern:/^(\d+)[ºªo]?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:c({matchPatterns:{narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},defaultParseWidth:"any"}),quarter:c({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:c({matchPatterns:{narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|março|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},defaultParseWidth:"any"}),day:c({matchPatterns:{narrow:/^(dom|[23456]ª?|s[aá]b)/i,short:/^(dom|[23456]ª?|s[aá]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[aá]b)/i,wide:/^(domingo|(segunda|ter[cç]a|quarta|quinta|sexta)([- ]feira)?|s[aá]bado)/i},defaultMatchWidth:"wide",parsePatterns:{short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[aá]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[aá]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[aá]b/i]},defaultParseWidth:"any"}),dayPeriod:c({matchPatterns:{narrow:/^(a|p|mn|md|(da) (manhã|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manhã|tarde|noite))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manhã/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},{Header:It}=I;const At=y.memo(function(){const e=x(),t=v(),{user:a,logout:s}=vt(),i=Ne(),l=("undefined"!=typeof window?localStorage.getItem("tenantSlug"):null)||"captar",[c,d]=f.useState(localStorage.getItem("tenantName")||"");if(f.useEffect(()=>{const e=localStorage.getItem("tenantSlug")||"captar";(async()=>{try{const t=await i.listTenants(),a=(t.rows||[]).find(t=>String(t.Slug??t.slug).toUpperCase()===String(e).toUpperCase()),r=a?String(a.Nome??a.nome):e;d(r);try{localStorage.setItem("tenantName",r)}catch{}}catch{d(e)}})()},[i]),!a)return null;const p=f.useMemo(()=>{const e=a?.login_time;if(!e)return null;const t=n(e);if(o(t))return t;const r=new Date(e);return isNaN(r.getTime())?null:r},[a?.login_time]),h=p?u(p,"dd/MM/yyyy HH:mm",{locale:Ct}):"",[g,y]=f.useState("");f.useEffect(()=>{const e=()=>{if(!p)return void y("");const e=Date.now()-p.getTime(),t=Math.floor(e/36e5),a=Math.floor(e%36e5/6e4),r=Math.floor(e%6e4/1e3),n=String(t).padStart(2,"0"),o=String(a).padStart(2,"0"),s=String(r).padStart(2,"0");y(`${n}:${o}:${s}`)};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[p]);const b=[{key:"logout",label:"LOGOUT",icon:r.jsx(F,{}),onClick:()=>{s(),e("/login")}}],j=[{key:"/",icon:r.jsx(A,{}),label:"DASHBOARD",onClick:()=>e("/")},{key:"cadastros",icon:r.jsx(T,{}),label:"CADASTROS",children:[{key:"/eleitores",icon:r.jsx(T,{}),label:"ELEITORES",onClick:()=>e("/eleitores")},{key:"/ativistas",icon:r.jsx(E,{}),label:"ATIVISTAS",onClick:()=>e("/ativistas")}]},{key:"/estatisticas",icon:r.jsx(N,{}),label:"ESTATÍSTICAS",onClick:()=>e("/estatisticas")},{key:"/consultas",icon:r.jsx(N,{}),label:"CONSULTAS",onClick:()=>e("/consultas")},{key:"sistema",icon:r.jsx(D,{}),label:"SISTEMA",children:[{key:"/usuarios",icon:r.jsx(N,{}),label:"USUÁRIOS",onClick:()=>e("/usuarios")},{key:"/perfil",icon:r.jsx(T,{}),label:"PERFIL",onClick:()=>e("/perfil")},{key:"/funcoes",icon:r.jsx(T,{}),label:"FUNÇÕES",onClick:()=>e("/funcoes")},{key:"/permissoes",icon:r.jsx(N,{}),label:"PERMISSÕES",onClick:()=>e("/permissoes")},{key:"/integracoes",icon:r.jsx(k,{}),label:"INTEGRAÇÕES",onClick:()=>e("/integracoes")}]},{key:"automacao",icon:r.jsx(U,{}),label:"AUTOMAÇÃO",children:[{key:"/automacao/campanha",icon:r.jsx(N,{}),label:"CAMPANHA",onClick:()=>e("/automacao/campanha")},{key:"/automacao/disparos",icon:r.jsx(k,{}),label:"DISPAROS",onClick:()=>e("/automacao/disparos")}]},{key:"parametros",icon:r.jsx(N,{}),label:"PARÂMETROS",children:(()=>{const t=[{key:"/parametros/metas",icon:r.jsx(N,{}),label:"METAS",onClick:()=>e("/parametros/metas")},{key:"/parametros/tenants",icon:r.jsx(N,{}),label:"TENANTS",onClick:()=>e("/parametros/tenants")},{key:"/parametros/eleicoes",icon:r.jsx(N,{}),label:"ELEIÇÕES",onClick:()=>e("/parametros/eleicoes")},{key:"/parametros/candidatos",icon:r.jsx(N,{}),label:"CANDIDATOS",onClick:()=>e("/parametros/candidatos")}];return"captar"!==String(l).toLowerCase()?t.filter(e=>"/parametros/tenants"!==e.key):t})()}];return r.jsx(It,{className:"navbar",children:r.jsxs("div",{className:"navbar-container",children:[r.jsxs("div",{className:"navbar-logo",style:{height:"100%",display:"flex",alignItems:"center"},children:[r.jsx("img",{src:bt,alt:"CAPTAR",style:{height:110,backgroundColor:"#ffffff",borderRadius:8,padding:6}}),r.jsxs("span",{style:{marginLeft:12,fontSize:12,color:"#666",letterSpacing:".3px"},children:["TENANT: ",r.jsx("strong",{style:{color:"#333"},children:String(c||l).toUpperCase()})]})]}),r.jsx(m.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},transition:{duration:.4},style:{flex:1,minWidth:0,display:"flex",justifyContent:"center"},children:r.jsx(O,{mode:"horizontal",selectedKeys:[t.pathname],items:j,className:"navbar-menu"})}),r.jsxs("div",{className:"navbar-content",children:[r.jsx("div",{className:"navbar-user-info",children:r.jsxs("div",{className:"user-details",children:[r.jsx("p",{className:"user-name",children:a.nome}),r.jsxs("p",{className:"user-meta",children:["Função: ",r.jsx("strong",{children:a.funcao})," | Perfil: ",r.jsx("strong",{children:a.perfil})]}),r.jsxs("p",{className:"user-login-time",children:["LOGIN: ",h," | TEMPO CONECTADO: ",g]})]})}),r.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:r.jsx(R,{menu:{items:b},trigger:["click"],children:r.jsxs(M,{type:"text",className:"user-menu-button",children:[r.jsx(L,{icon:r.jsx(T,{}),size:"large"}),r.jsx(P,{})]})})})]})]})})});const Tt=Array(12).fill(0),Et=({visible:e,className:t})=>y.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},y.createElement("div",{className:"sonner-spinner"},Tt.map((e,t)=>y.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${t}`})))),Nt=y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},y.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),kt=y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},y.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Dt=y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},y.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Ut=y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},y.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Ot=y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},y.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),y.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}));let Rt=1;const Mt=new class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;const{message:a,...r}=e,n="number"==typeof(null==e?void 0:e.id)||(null==(t=e.id)?void 0:t.length)>0?e.id:Rt++,o=this.toasts.find(e=>e.id===n),s=void 0===e.dismissible||e.dismissible;return this.dismissedToasts.has(n)&&this.dismissedToasts.delete(n),o?this.toasts=this.toasts.map(t=>t.id===n?(this.publish({...t,...e,id:n,title:a}),{...t,...e,id:n,dismissible:s,title:a}):t):this.addToast({title:a,...r,dismissible:s,id:n}),n},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(t=>t({id:e,dismiss:!0})))):this.toasts.forEach(e=>{this.subscribers.forEach(t=>t({id:e.id,dismiss:!0}))}),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let a;void 0!==t.loading&&(a=this.create({...t,promise:e,type:"loading",message:t.loading,description:"function"!=typeof t.description?t.description:void 0}));const r=Promise.resolve(e instanceof Function?e():e);let n,o=void 0!==a;const s=r.then(async e=>{n=["resolve",e];if(y.isValidElement(e))o=!1,this.create({id:a,type:"default",message:e});else if(Lt(e)&&!e.ok){o=!1;const r="function"==typeof t.error?await t.error(`HTTP error! status: ${e.status}`):t.error,n="function"==typeof t.description?await t.description(`HTTP error! status: ${e.status}`):t.description,s="object"==typeof r&&!y.isValidElement(r)?r:{message:r};this.create({id:a,type:"error",description:n,...s})}else if(e instanceof Error){o=!1;const r="function"==typeof t.error?await t.error(e):t.error,n="function"==typeof t.description?await t.description(e):t.description,s="object"==typeof r&&!y.isValidElement(r)?r:{message:r};this.create({id:a,type:"error",description:n,...s})}else if(void 0!==t.success){o=!1;const r="function"==typeof t.success?await t.success(e):t.success,n="function"==typeof t.description?await t.description(e):t.description,s="object"==typeof r&&!y.isValidElement(r)?r:{message:r};this.create({id:a,type:"success",description:n,...s})}}).catch(async e=>{if(n=["reject",e],void 0!==t.error){o=!1;const r="function"==typeof t.error?await t.error(e):t.error,n="function"==typeof t.description?await t.description(e):t.description,s="object"==typeof r&&!y.isValidElement(r)?r:{message:r};this.create({id:a,type:"error",description:n,...s})}}).finally(()=>{o&&(this.dismiss(a),a=void 0),null==t.finally||t.finally.call(t)}),i=()=>new Promise((e,t)=>s.then(()=>"reject"===n[0]?t(n[1]):e(n[1])).catch(t));return"string"!=typeof a&&"number"!=typeof a?{unwrap:i}:Object.assign(a,{unwrap:i})},this.custom=(e,t)=>{const a=(null==t?void 0:t.id)||Rt++;return this.create({jsx:e(a),id:a,...t}),a},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Lt=e=>e&&"object"==typeof e&&"ok"in e&&"boolean"==typeof e.ok&&"status"in e&&"number"==typeof e.status,Pt=(e,t)=>{const a=(null==t?void 0:t.id)||Rt++;return Mt.addToast({title:e,...t,id:a}),a},Ft=Object.assign(Pt,{success:Mt.success,info:Mt.info,warning:Mt.warning,error:Mt.error,custom:Mt.custom,message:Mt.message,promise:Mt.promise,dismiss:Mt.dismiss,loading:Mt.loading},{getHistory:()=>Mt.toasts,getToasts:()=>Mt.getActiveToasts()});function _t(e){return void 0!==e.label}!function(e){if("undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",t.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");const $t=3,Vt=14;function zt(...e){return e.filter(Boolean).join(" ")}const Bt=e=>{var t,a,r,n,o,s,i,l,c;const{invert:d,toast:u,unstyled:m,interacting:p,setHeights:h,visibleToasts:g,heights:f,index:x,toasts:v,expanded:b,removeToast:j,defaultRichColors:w,closeButton:S,style:C,cancelButtonStyle:I,actionButtonStyle:A,className:T="",descriptionClassName:E="",duration:N,position:k,gap:D,expandByDefault:U,classNames:O,icons:R,closeButtonAriaLabel:M="Close toast"}=e,[L,P]=y.useState(null),[F,_]=y.useState(null),[$,V]=y.useState(!1),[z,B]=y.useState(!1),[H,Y]=y.useState(!1),[q,W]=y.useState(!1),[J,X]=y.useState(!1),[K,G]=y.useState(0),[Z,Q]=y.useState(0),ee=y.useRef(u.duration||N||4e3),te=y.useRef(null),ae=y.useRef(null),re=0===x,ne=x+1<=g,oe=u.type,se=!1!==u.dismissible,ie=u.className||"",le=u.descriptionClassName||"",ce=y.useMemo(()=>f.findIndex(e=>e.toastId===u.id)||0,[f,u.id]),de=y.useMemo(()=>{var e;return null!=(e=u.closeButton)?e:S},[u.closeButton,S]),ue=y.useMemo(()=>u.duration||N||4e3,[u.duration,N]),me=y.useRef(0),pe=y.useRef(0),he=y.useRef(0),ge=y.useRef(null),[fe,ye]=k.split("-"),xe=y.useMemo(()=>f.reduce((e,t,a)=>a>=ce?e:e+t.height,0),[f,ce]),ve=(()=>{const[e,t]=y.useState(document.hidden);return y.useEffect(()=>{const e=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",e),()=>window.removeEventListener("visibilitychange",e)},[]),e})(),be=u.invert||d,je="loading"===oe;pe.current=y.useMemo(()=>ce*D+xe,[ce,xe]),y.useEffect(()=>{ee.current=ue},[ue]),y.useEffect(()=>{V(!0)},[]),y.useEffect(()=>{const e=ae.current;if(e){const t=e.getBoundingClientRect().height;return Q(t),h(e=>[{toastId:u.id,height:t,position:u.position},...e]),()=>h(e=>e.filter(e=>e.toastId!==u.id))}},[h,u.id]),y.useLayoutEffect(()=>{if(!$)return;const e=ae.current,t=e.style.height;e.style.height="auto";const a=e.getBoundingClientRect().height;e.style.height=t,Q(a),h(e=>e.find(e=>e.toastId===u.id)?e.map(e=>e.toastId===u.id?{...e,height:a}:e):[{toastId:u.id,height:a,position:u.position},...e])},[$,u.title,u.description,h,u.id,u.jsx,u.action,u.cancel]);const we=y.useCallback(()=>{B(!0),G(pe.current),h(e=>e.filter(e=>e.toastId!==u.id)),setTimeout(()=>{j(u)},200)},[u,j,h,pe]);y.useEffect(()=>{if(u.promise&&"loading"===oe||u.duration===1/0||"loading"===u.type)return;let e;return b||p||ve?(()=>{if(he.current<me.current){const e=(new Date).getTime()-me.current;ee.current=ee.current-e}he.current=(new Date).getTime()})():ee.current!==1/0&&(me.current=(new Date).getTime(),e=setTimeout(()=>{null==u.onAutoClose||u.onAutoClose.call(u,u),we()},ee.current)),()=>clearTimeout(e)},[b,p,u,oe,ve,we]),y.useEffect(()=>{u.delete&&(we(),null==u.onDismiss||u.onDismiss.call(u,u))},[we,u.delete]);const Se=u.icon||(null==R?void 0:R[oe])||(e=>{switch(e){case"success":return Nt;case"info":return Dt;case"warning":return kt;case"error":return Ut;default:return null}})(oe);var Ce,Ie,Ae,Te;return y.createElement("li",{tabIndex:0,ref:ae,className:zt(T,ie,null==O?void 0:O.toast,null==u||null==(t=u.classNames)?void 0:t.toast,null==O?void 0:O.default,null==O?void 0:O[oe],null==u||null==(a=u.classNames)?void 0:a[oe]),"data-sonner-toast":"","data-rich-colors":null!=(Ce=u.richColors)?Ce:w,"data-styled":!Boolean(u.jsx||u.unstyled||m),"data-mounted":$,"data-promise":Boolean(u.promise),"data-swiped":J,"data-removed":z,"data-visible":ne,"data-y-position":fe,"data-x-position":ye,"data-index":x,"data-front":re,"data-swiping":H,"data-dismissible":se,"data-type":oe,"data-invert":be,"data-swipe-out":q,"data-swipe-direction":F,"data-expanded":Boolean(b||U&&$),"data-testid":u.testId,style:{"--index":x,"--toasts-before":x,"--z-index":v.length-x,"--offset":`${z?K:pe.current}px`,"--initial-height":U?"auto":`${Z}px`,...C,...u.style},onDragEnd:()=>{Y(!1),P(null),ge.current=null},onPointerDown:e=>{2!==e.button&&!je&&se&&(te.current=new Date,G(pe.current),e.target.setPointerCapture(e.pointerId),"BUTTON"!==e.target.tagName&&(Y(!0),ge.current={x:e.clientX,y:e.clientY}))},onPointerUp:()=>{var e,t,a;if(q||!se)return;ge.current=null;const r=Number((null==(e=ae.current)?void 0:e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),n=Number((null==(t=ae.current)?void 0:t.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),o=(new Date).getTime()-(null==(a=te.current)?void 0:a.getTime()),s="x"===L?r:n,i=Math.abs(s)/o;if(Math.abs(s)>=45||i>.11)return G(pe.current),null==u.onDismiss||u.onDismiss.call(u,u),_("x"===L?r>0?"right":"left":n>0?"down":"up"),we(),void W(!0);var l,c;null==(l=ae.current)||l.style.setProperty("--swipe-amount-x","0px"),null==(c=ae.current)||c.style.setProperty("--swipe-amount-y","0px"),X(!1),Y(!1),P(null)},onPointerMove:t=>{var a,r,n;if(!ge.current||!se)return;if((null==(a=window.getSelection())?void 0:a.toString().length)>0)return;const o=t.clientY-ge.current.y,s=t.clientX-ge.current.x;var i;const l=null!=(i=e.swipeDirections)?i:function(e){const[t,a]=e.split("-"),r=[];return t&&r.push(t),a&&r.push(a),r}(k);!L&&(Math.abs(s)>1||Math.abs(o)>1)&&P(Math.abs(s)>Math.abs(o)?"x":"y");let c={x:0,y:0};const d=e=>1/(1.5+Math.abs(e)/20);if("y"===L){if(l.includes("top")||l.includes("bottom"))if(l.includes("top")&&o<0||l.includes("bottom")&&o>0)c.y=o;else{const e=o*d(o);c.y=Math.abs(e)<Math.abs(o)?e:o}}else if("x"===L&&(l.includes("left")||l.includes("right")))if(l.includes("left")&&s<0||l.includes("right")&&s>0)c.x=s;else{const e=s*d(s);c.x=Math.abs(e)<Math.abs(s)?e:s}(Math.abs(c.x)>0||Math.abs(c.y)>0)&&X(!0),null==(r=ae.current)||r.style.setProperty("--swipe-amount-x",`${c.x}px`),null==(n=ae.current)||n.style.setProperty("--swipe-amount-y",`${c.y}px`)}},de&&!u.jsx&&"loading"!==oe?y.createElement("button",{"aria-label":M,"data-disabled":je,"data-close-button":!0,onClick:je||!se?()=>{}:()=>{we(),null==u.onDismiss||u.onDismiss.call(u,u)},className:zt(null==O?void 0:O.closeButton,null==u||null==(r=u.classNames)?void 0:r.closeButton)},null!=(Ie=null==R?void 0:R.close)?Ie:Ot):null,(oe||u.icon||u.promise)&&null!==u.icon&&(null!==(null==R?void 0:R[oe])||u.icon)?y.createElement("div",{"data-icon":"",className:zt(null==O?void 0:O.icon,null==u||null==(n=u.classNames)?void 0:n.icon)},u.promise||"loading"===u.type&&!u.icon?u.icon||((null==R?void 0:R.loading)?y.createElement("div",{className:zt(null==O?void 0:O.loader,null==u||null==(Te=u.classNames)?void 0:Te.loader,"sonner-loader"),"data-visible":"loading"===oe},R.loading):y.createElement(Et,{className:zt(null==O?void 0:O.loader,null==u||null==(Ae=u.classNames)?void 0:Ae.loader),visible:"loading"===oe})):null,"loading"!==u.type?Se:null):null,y.createElement("div",{"data-content":"",className:zt(null==O?void 0:O.content,null==u||null==(o=u.classNames)?void 0:o.content)},y.createElement("div",{"data-title":"",className:zt(null==O?void 0:O.title,null==u||null==(s=u.classNames)?void 0:s.title)},u.jsx?u.jsx:"function"==typeof u.title?u.title():u.title),u.description?y.createElement("div",{"data-description":"",className:zt(E,le,null==O?void 0:O.description,null==u||null==(i=u.classNames)?void 0:i.description)},"function"==typeof u.description?u.description():u.description):null),y.isValidElement(u.cancel)?u.cancel:u.cancel&&_t(u.cancel)?y.createElement("button",{"data-button":!0,"data-cancel":!0,style:u.cancelButtonStyle||I,onClick:e=>{_t(u.cancel)&&se&&(null==u.cancel.onClick||u.cancel.onClick.call(u.cancel,e),we())},className:zt(null==O?void 0:O.cancelButton,null==u||null==(l=u.classNames)?void 0:l.cancelButton)},u.cancel.label):null,y.isValidElement(u.action)?u.action:u.action&&_t(u.action)?y.createElement("button",{"data-button":!0,"data-action":!0,style:u.actionButtonStyle||A,onClick:e=>{_t(u.action)&&(null==u.action.onClick||u.action.onClick.call(u.action,e),e.defaultPrevented||we())},className:zt(null==O?void 0:O.actionButton,null==u||null==(c=u.classNames)?void 0:c.actionButton)},u.action.label):null)};function Ht(){if("undefined"==typeof window)return"ltr";if("undefined"==typeof document)return"ltr";const e=document.documentElement.getAttribute("dir");return"auto"!==e&&e?e:window.getComputedStyle(document.documentElement).direction}function Yt(e,t){const a={};return[e,t].forEach((e,t)=>{const r=1===t,n=r?"--mobile-offset":"--offset",o=r?"16px":"24px";function s(e){["top","right","bottom","left"].forEach(t=>{a[`${n}-${t}`]="number"==typeof e?`${e}px`:e})}"number"==typeof e||"string"==typeof e?s(e):"object"==typeof e?["top","right","bottom","left"].forEach(t=>{void 0===e[t]?a[`${n}-${t}`]=o:a[`${n}-${t}`]="number"==typeof e[t]?`${e[t]}px`:e[t]}):s(o)}),a}const qt=y.forwardRef(function(e,t){const{id:a,invert:r,position:n="bottom-right",hotkey:o=["altKey","KeyT"],expand:s,closeButton:i,className:l,offset:c,mobileOffset:d,theme:u="light",richColors:m,duration:p,style:h,visibleToasts:g=$t,toastOptions:f,dir:x=Ht(),gap:v=Vt,icons:j,containerAriaLabel:w="Notifications"}=e,[S,C]=y.useState([]),I=y.useMemo(()=>a?S.filter(e=>e.toasterId===a):S.filter(e=>!e.toasterId),[S,a]),A=y.useMemo(()=>Array.from(new Set([n].concat(I.filter(e=>e.position).map(e=>e.position)))),[I,n]),[T,E]=y.useState([]),[N,k]=y.useState(!1),[D,U]=y.useState(!1),[O,R]=y.useState("system"!==u?u:"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),M=y.useRef(null),L=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),P=y.useRef(null),F=y.useRef(!1),_=y.useCallback(e=>{C(t=>{var a;return(null==(a=t.find(t=>t.id===e.id))?void 0:a.delete)||Mt.dismiss(e.id),t.filter(({id:t})=>t!==e.id)})},[]);return y.useEffect(()=>Mt.subscribe(e=>{e.dismiss?requestAnimationFrame(()=>{C(t=>t.map(t=>t.id===e.id?{...t,delete:!0}:t))}):setTimeout(()=>{b.flushSync(()=>{C(t=>{const a=t.findIndex(t=>t.id===e.id);return-1!==a?[...t.slice(0,a),{...t[a],...e},...t.slice(a+1)]:[e,...t]})})})}),[S]),y.useEffect(()=>{if("system"!==u)return void R(u);if("system"===u&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?R("dark"):R("light")),"undefined"==typeof window)return;const e=window.matchMedia("(prefers-color-scheme: dark)");try{e.addEventListener("change",({matches:e})=>{R(e?"dark":"light")})}catch(t){e.addListener(({matches:e})=>{try{R(e?"dark":"light")}catch(t){console.error(t)}})}},[u]),y.useEffect(()=>{S.length<=1&&k(!1)},[S]),y.useEffect(()=>{const e=e=>{var t;var a;o.every(t=>e[t]||e.code===t)&&(k(!0),null==(a=M.current)||a.focus());"Escape"!==e.code||document.activeElement!==M.current&&!(null==(t=M.current)?void 0:t.contains(document.activeElement))||k(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[o]),y.useEffect(()=>{if(M.current)return()=>{P.current&&(P.current.focus({preventScroll:!0}),P.current=null,F.current=!1)}},[M.current]),y.createElement("section",{ref:t,"aria-label":`${w} ${L}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},A.map((t,a)=>{var n;const[o,u]=t.split("-");return I.length?y.createElement("ol",{key:t,dir:"auto"===x?Ht():x,tabIndex:-1,ref:M,className:l,"data-sonner-toaster":!0,"data-sonner-theme":O,"data-y-position":o,"data-x-position":u,style:{"--front-toast-height":`${(null==(n=T[0])?void 0:n.height)||0}px`,"--width":"356px","--gap":`${v}px`,...h,...Yt(c,d)},onBlur:e=>{F.current&&!e.currentTarget.contains(e.relatedTarget)&&(F.current=!1,P.current&&(P.current.focus({preventScroll:!0}),P.current=null))},onFocus:e=>{e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible||F.current||(F.current=!0,P.current=e.relatedTarget)},onMouseEnter:()=>k(!0),onMouseMove:()=>k(!0),onMouseLeave:()=>{D||k(!1)},onDragEnd:()=>k(!1),onPointerDown:e=>{e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible||U(!0)},onPointerUp:()=>U(!1)},I.filter(e=>!e.position&&0===a||e.position===t).map((a,n)=>{var o,l;return y.createElement(Bt,{key:a.id,icons:j,index:n,toast:a,defaultRichColors:m,duration:null!=(o=null==f?void 0:f.duration)?o:p,className:null==f?void 0:f.className,descriptionClassName:null==f?void 0:f.descriptionClassName,invert:r,visibleToasts:g,closeButton:null!=(l=null==f?void 0:f.closeButton)?l:i,interacting:D,position:t,style:null==f?void 0:f.style,unstyled:null==f?void 0:f.unstyled,classNames:null==f?void 0:f.classNames,cancelButtonStyle:null==f?void 0:f.cancelButtonStyle,actionButtonStyle:null==f?void 0:f.actionButtonStyle,closeButtonAriaLabel:null==f?void 0:f.closeButtonAriaLabel,removeToast:_,toasts:I.filter(e=>e.position==a.position),heights:T.filter(e=>e.position==a.position),setHeights:E,expandByDefault:s,gap:v,expanded:N,swipeDirections:e.swipeDirections})})):null}))}),Wt="/assets/CAPTAR%20LOGIN-My8ZjooI.png";function Jt(){const e=x(),{login:t}=vt(),[a,n]=f.useState(!1),[o,s]=f.useState(null),[i]=_.useForm(),l=Ne(),[c,d]=f.useState(null),u=async a=>{n(!0);try{if(a.acesso_direto){try{localStorage.setItem("tenantSlug","captar")}catch{}const a={id:9999,nome:"USUÁRIO TEMPORÁRIO",funcao:"ADMINISTRADOR",usuario:"admin",email:"admin@example.com",cpf:"000.000.000-00",perfil:"ADMINISTRADOR",login_time:(new Date).toISOString()};return t(a,"temp-token-dev"),q.success("Acesso direto ativado!"),void e("/")}const r=await l.login({usuario:a.usuario,senha:a.senha}),n={...r.user,login_time:(new Date).toISOString()};t(n,r.token),Ft.success("Login realizado com sucesso!"),e("/")}catch(r){Ft.error(r.response?.data?.detail||"Usuário ou senha inválidos")}finally{n(!1)}};return f.useEffect(()=>{const e=Wt,t=new Image;t.crossOrigin="anonymous",t.onload=()=>{const a=t.naturalWidth||512,r=t.naturalHeight||512,n=document.createElement("canvas");n.width=a,n.height=r;const o=n.getContext("2d");if(!o)return void d(e);o.drawImage(t,0,0,a,r);const s=o.getImageData(0,0,a,r),i=s.data;for(let e=0;e<i.length;e+=4){const t=i[e],a=i[e+1],r=i[e+2],n=Math.max(t,a,r),o=Math.min(t,a,r);n>230&&o>210&&(i[e+3]=0)}o.putImageData(s,0,0),d(n.toDataURL("image/png"))},t.src=e},[]),r.jsx("div",{style:{minHeight:"100vh"},children:r.jsx($,{open:!0,centered:!0,footer:null,closable:!1,maskClosable:!1,width:520,destroyOnHidden:!0,className:"login-modal",children:r.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:16},children:[r.jsx("style",{children:".login-modal .ant-modal-content{ border-radius:0 !important; box-shadow:none !important; border:none !important; } .login-modal .ant-modal-header{ border-bottom:none !important; }"}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("img",{src:c||Wt,alt:"CAPTAR",style:{width:400,height:"auto",maxWidth:"90%"}})}),r.jsxs(_,{form:i,onFinish:u,layout:"vertical",className:"login-form",style:{width:"100%"},children:[r.jsx(_.Item,{name:"usuario",getValueFromEvent:e=>(e?.target?.value||"").toUpperCase(),rules:[{required:!0,message:"Por favor, insira seu usuário"},{min:3,message:"Usuário deve ter pelo menos 3 caracteres"}],children:r.jsx(V,{prefix:r.jsx(T,{}),placeholder:"Usuário",size:"large",autoComplete:"username",style:{textTransform:"uppercase"}})}),r.jsx(_.Item,{name:"senha",rules:[{required:!0,message:"Por favor, insira sua senha"},{min:3,message:"Senha deve ter pelo menos 3 caracteres"}],children:r.jsx(V.Password,{prefix:r.jsx(z,{}),placeholder:"Senha",size:"large",autoComplete:"current-password"})}),r.jsx(_.Item,{children:r.jsx(M,{type:"primary",htmlType:"submit",size:"large",block:!0,loading:a,className:"login-button",children:"ENTRAR"})})]}),r.jsxs(B,{style:{width:"100%",justifyContent:"space-between",marginTop:8},children:[r.jsxs("div",{children:[r.jsx("span",{children:"Status BD: "}),null===o&&r.jsx(H,{children:"?"}),!0===o&&r.jsx(H,{color:"green",children:"OK"}),!1===o&&r.jsx(H,{color:"red",children:"FALHA"})]}),r.jsx(M,{size:"small",onClick:async()=>{try{const e=await l.healthDb();s(!!e?.ok),e?.ok&&q.success("Conexão com banco OK")}catch(e){s(!1),q.error(e?.response?.data?.detail||"Falha ao conectar no banco")}},children:"Testar conexão"})]}),r.jsx(Y,{children:"OU"}),r.jsx(M,{type:"dashed",size:"large",block:!0,loading:a,className:"dev-button",onClick:()=>{u({usuario:"",senha:"",acesso_direto:!0})},children:"🔧 Acesso Direto (Desenvolvedor)"}),r.jsxs("div",{className:"login-footer",children:[r.jsx("p",{children:"CAPTAR © 2025 - Sistema de Captação Eleitoral"}),r.jsx("p",{className:"version",children:"v2.0 - React + TypeScript + Vite"})]})]})})})}function Xt({open:e,initial:t,onCancel:a,onSaved:s}){const[i]=_.useForm(),[l,c]=f.useState(!1),[d,m]=f.useState([]),p=Ne(),{user:h}=vt(),{message:g}=W.useApp(),y=f.useMemo(()=>{const e=h?.login_time;if(!e)return null;const t=n(e);if(o(t))return t;const a=new Date(e);return isNaN(a.getTime())?null:a},[h]),[x,v]=f.useState(""),b=y?u(y,"dd/MM/yyyy HH:mm",{locale:Ct}):"",j=String(localStorage.getItem("tenantSlug")||"captar"),w=String(localStorage.getItem("tenantName")||"CAPTAR");f.useEffect(()=>{const e=()=>{if(!y)return void v("");const e=Date.now()-y.getTime(),t=Math.floor(e/36e5),a=Math.floor(e%36e5/6e4),r=Math.floor(e%6e4/1e3),n=String(t).padStart(2,"0"),o=String(a).padStart(2,"0"),s=String(r).padStart(2,"0");v(`${n}:${o}:${s}`)};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[y]),f.useEffect(()=>{if(e)if((async()=>{try{const e=((await p.listTenants()).rows||[]).map(e=>({label:e.Nome??e.nome,value:String(e.Nome??e.nome),slug:e.Slug??e.slug}));if(m(e),!t){const t=localStorage.getItem("tenantSlug")||"captar",a=e.find(e=>(e.slug||"").toLowerCase()===t.toLowerCase());a&&i.setFieldValue("TenantLayer",a.value)}}catch{}})(),t){const e={...t};if(e.DataNascimento||e.data_nascimento){const t=e.DataNascimento||e.data_nascimento;e.data_nascimento=J(t)}e.Nome&&(e.nome=e.Nome),e.CPF&&(e.cpf=e.CPF),e.Celular&&(e.celular=e.Celular),e.Bairro&&(e.bairro=e.Bairro),e.ZonaEleitoral&&(e.zona_eleitoral=e.ZonaEleitoral),i.setFieldsValue(e)}else i.resetFields()},[e,t,i,p]);const S=async()=>{try{const e=await i.validateFields();if(c(!0),e.data_nascimento&&(e.data_nascimento=e.data_nascimento.format("YYYY-MM-DD")),"string"==typeof e.celular){const t=String(e.celular);e.celular=t.length>15?t.slice(0,15):t}const a=String(localStorage.getItem("tenantName")||"CAPTAR"),r=String(e.TenantLayer||a);try{const t=(await p.listTenants()).rows||[],a=String(e.TenantLayer||r);(t.find(e=>String(e.Nome??e.nome).toUpperCase()===a.toUpperCase())||t.find(e=>String(e.Slug??e.slug).toUpperCase()===String(localStorage.getItem("tenantSlug")||"captar").toUpperCase()))&&delete e.IdTenant}catch{}if(Object.keys(e).forEach(t=>void 0===e[t]&&delete e[t]),t?.id||t?.IdEleitor){const a=t.id||t.IdEleitor;await p.updateEleitor(a,e),g.success("Eleitor atualizado com sucesso!")}else await p.createEleitor(e),g.success("Eleitor criado com sucesso!");s()}catch(e){const t=e?.response?.data?.detail||e?.message||"Erro ao salvar eleitor";g.error(t)}finally{c(!1)}},C=e=>{const t=e?.target?.value;return"string"==typeof t?t.toUpperCase():t};return r.jsxs($,{open:e,title:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{className:"navbar-logo",style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("img",{src:bt,alt:"CAPTAR",style:{height:110,backgroundColor:"#ffffff",borderRadius:8,padding:6}}),r.jsxs("div",{style:{fontSize:12},children:["TENANT: ",r.jsx("strong",{style:{color:"#333"},children:String(w||j).toUpperCase()})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsxs("div",{style:{textAlign:"right"},children:[r.jsx("div",{style:{fontWeight:700},children:h?.usuario?String(h?.usuario).toUpperCase():String(h?.nome||"").toUpperCase()||"USUÁRIO"}),r.jsx("div",{style:{fontSize:12},children:`FUNÇÃO: ${String(h?.funcao||"").toUpperCase()} | PERFIL: ${String(h?.perfil||"").toUpperCase()}`}),r.jsx("div",{style:{fontSize:12},children:`LOGIN: ${b||"--"} | TEMPO CONECTADO: ${x||"--:--:--"}`})]}),r.jsx(L,{size:"large"})]})]}),onOk:S,onCancel:a,confirmLoading:l,width:980,centered:!0,footer:null,className:"eleitores-modal",destroyOnHidden:!0,closable:!1,maskClosable:!1,children:[r.jsx("style",{children:".eleitores-modal .ant-modal-header{ border-bottom: 1px solid #e8e8e8; } .eleitores-modal .ant-modal-content{ border-radius: 0 !important; } .eleitores-modal .ant-form-item{ margin-bottom:6px; }"}),r.jsxs(_,{form:i,layout:"vertical",children:[r.jsxs("div",{style:{display:"grid",gap:16},children:[r.jsxs(X,{title:"Dados do Eleitor",size:"small",children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[r.jsx(_.Item,{name:"nome",label:"Nome",rules:[{required:!0,message:"Nome é obrigatório"}],getValueFromEvent:C,children:r.jsx(V,{prefix:r.jsx(T,{}),placeholder:"Nome completo",style:{borderRadius:8}})}),r.jsx(_.Item,{name:"cpf",label:"CPF",children:r.jsx(V,{prefix:r.jsx(K,{}),placeholder:"000.000.000-00",maxLength:14,style:{borderRadius:8},onChange:e=>{const t=(e=>{const t=(e||"").replace(/\D/g,"").slice(0,11),a=t.slice(0,3),r=t.slice(3,6),n=t.slice(6,9),o=t.slice(9,11);let s=a;return r&&(s+=`.${r}`),n&&(s+=`.${n}`),o&&(s+=`-${o}`),s})(e.target.value);i.setFieldsValue({cpf:t})}})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[r.jsx(_.Item,{name:"celular",label:"Celular",children:r.jsx(V,{prefix:r.jsx(G,{}),placeholder:"(00) 00000-0000",maxLength:15,style:{borderRadius:8},onChange:e=>{const t=(e=>{const t=(e||"").replace(/\D/g,"").slice(0,11);if(t.length<=2)return`(${t}`;const a=t.slice(0,2),r=t.slice(2),n="9"===r[0]?r:"9"+r,o=n.slice(0,5),s=n.slice(5,9);return o?s?`(${a}) ${o}-${s}`:`(${a}) ${o}`:`(${a})`})(e.target.value);i.setFieldsValue({celular:t})}})}),r.jsx(_.Item,{name:"data_nascimento",label:"Data de Nascimento",children:r.jsx(Z,{format:"DD/MM/YYYY",style:{width:"100%",borderRadius:8}})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[r.jsx(_.Item,{name:"bairro",label:"Bairro",getValueFromEvent:C,children:r.jsx(V,{prefix:r.jsx(Q,{}),placeholder:"Bairro",style:{borderRadius:8}})}),r.jsx(_.Item,{name:"zona_eleitoral",label:"Zona Eleitoral",getValueFromEvent:C,children:r.jsx(V,{prefix:r.jsx(ee,{}),placeholder:"Zona",style:{borderRadius:8}})})]})]}),r.jsx(X,{title:"Vinculação",size:"small",children:r.jsx(_.Item,{name:"TenantLayer",label:"Tenant Layer",rules:[{required:!0}],children:r.jsx(te,{options:d,optionFilterProp:"label",showSearch:!0,style:{borderRadius:8},disabled:!!t})})})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx(M,{onClick:a,icon:r.jsx(T,{rotate:180}),children:"Cancelar"}),r.jsx(M,{type:"primary",onClick:S,loading:l,icon:r.jsx(T,{}),children:"Salvar"})]})]})]})}function Kt(){const[e,t]=f.useState([]),[a,n]=f.useState(!1),[o,s]=f.useState(!1),[i,l]=f.useState(null),[c,d]=f.useState([]),[u,p]=f.useState({}),[h,g]=f.useState([]),y=Ne(),{user:x}=vt(),v=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z",fill:"currentColor"}),r.jsx("path",{d:"M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z",fill:"currentColor"})]}),b=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M6 7h12M9 7v10m6-10v10M4 7h16l-1 14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2L4 7z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),j=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M3 4h6v16H3V4zm12 0h6v16h-6V4z",fill:"currentColor"})}),w=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("circle",{cx:"12",cy:"8",r:"4",stroke:"currentColor",strokeWidth:"2"}),r.jsx("path",{d:"M4 20c0-3.866 3.582-7 8-7s8 3.134 8 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),r.jsx("path",{d:"M18 6h3M19.5 4.5v3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),S=async()=>{try{n(!0);const e=await y.getEleitoresSchema(),a=["id","nome","cpf","celular","bairro","zona_eleitoral","TenantLayer","DataCadastro"],r={};for(const t of e.columns||[])r[t.name]=t;const o=a.filter(e=>r[e]).map(e=>r[e]),s=(e.columns||[]).filter(e=>!a.includes(e.name));d([...o,...s]);const i=(await y.getEleitores()).rows||[];t(i);const l={};for(const t of a)r[t]&&(l[t]=!0);for(const t of s)l[t.name]=!1;const c=`eleitores.columns.visible.${x?.usuario||"default"}`,u=localStorage.getItem(c);p(u?JSON.parse(u):l);const m=`eleitores.columns.order.${x?.usuario||"default"}`,h=localStorage.getItem(m);g(h?JSON.parse(h):a.filter(e=>r[e]))}catch(e){q.error(e?.response?.data?.detail||"Erro ao carregar eleitores")}finally{n(!1)}};f.useEffect(()=>{S()},[]);const C=c.map(t=>{const a=t.name,r=Array.from(new Set((e||[]).map(e=>e[a]).filter(e=>null!=e))).slice(0,20).map(e=>({text:Array.isArray(e)?String(e.join(", ")).toUpperCase():String(e).toUpperCase(),value:Array.isArray(e)?String(e.join(", ")).toUpperCase():String(e).toUpperCase()})),n=(t.type||"").toLowerCase(),o=new Set(["id","TenantLayer","DataCadastro","DataUpdate"]),s={title:{id:"ID",nome:"NOME",cpf:"CPF",celular:"CELULAR",bairro:"BAIRRO",zona_eleitoral:"ZONA ELEITORAL",data_nascimento:"DATA NASCIMENTO",email:"EMAIL",genero:"GÊNERO",cidade:"CIDADE",uf:"UF",TenantLayer:"TENANT LAYER",DataCadastro:"DATA CADASTRO",DataUpdate:"DATA ATUALIZAÇÃO"}[a]||a.toUpperCase(),dataIndex:a,align:o.has(a)?"center":"left",filters:r,onFilter:(e,t)=>String(t[a]).toUpperCase()===String(e).toUpperCase(),sorter:(e,t)=>{const r=e[a],o=t[a];if(null==r)return-1;if(null==o)return 1;if(Array.isArray(r)||Array.isArray(o)){const e=Array.isArray(r)?r.join(", "):String(r),t=Array.isArray(o)?o.join(", "):String(o);return e.toUpperCase().localeCompare(t.toUpperCase())}return n.includes("int")||n.includes("numeric")?Number(r)-Number(o):n.includes("date")||n.includes("timestamp")?new Date(r).getTime()-new Date(o).getTime():String(r).toUpperCase().localeCompare(String(o).toUpperCase())},sortDirections:["ascend","descend"],render:e=>{if("boolean"==typeof e)return e?"SIM":"NÃO";if(null==e)return"";if(Array.isArray(e))return e.map(e=>String(e).toUpperCase()).join(" | ");const t=new Set(["DataUpdate"]);if(n.includes("date")||n.includes("timestamp")){const r=new Date(e);if(!isNaN(r.getTime())){if("DataCadastro"===a)return r.toLocaleString("pt-BR",{hour12:!1});if(t.has(a))return r.toLocaleTimeString("pt-BR",{hour12:!1});if("data_nascimento"===a)return r.toLocaleDateString("pt-BR")}}return"email"===a?String(e).toLowerCase():String(e).toUpperCase()},onHeaderCell:()=>({draggable:!0,onDragStart:e=>{e.dataTransfer.setData("text/plain",a)},onDragOver:e=>{e.preventDefault()},onDrop:e=>{const t=e.dataTransfer.getData("text/plain"),r=a;t&&t!==r&&g(e=>{const a=e.filter(e=>e!==t),n=a.indexOf(r);if(-1===n)return e;a.splice(n,0,t);const o=`eleitores.columns.order.${x?.usuario||"default"}`;return localStorage.setItem(o,JSON.stringify(a)),a})}})};return"id"===a&&(s.defaultSortOrder="ascend"),s}),I={title:"AÇÕES",dataIndex:"__actions__",render:(e,t)=>r.jsxs(B,{children:[r.jsx(M,{type:"text",icon:r.jsx(v,{}),title:"EDITAR",onClick:()=>{l(t),s(!0)}}),r.jsx(M,{type:"text",danger:!0,icon:r.jsx(b,{}),title:"DELETAR",onClick:async()=>{try{if(!t.id)return void q.info("REGISTRO SEM ID");await y.deleteEleitor(t.id),q.success("ELEITOR DELETADO"),await S()}catch(e){q.error(e?.response?.data?.detail||"ERRO AO DELETAR ELEITOR")}}})]})},A=(h.length?h:C.map(e=>e.dataIndex)).map(e=>C.find(t=>t.dataIndex===e)).filter(Boolean).filter(e=>u[e.dataIndex]).concat([I]),T=r.jsx("div",{style:{padding:12},children:c.map(e=>r.jsx("div",{style:{marginBottom:6},children:r.jsx(ae,{checked:!!u[e.name],onChange:t=>{const a={...u,[e.name]:t.target.checked};p(a);const r=`eleitores.columns.visible.${x?.usuario||"default"}`;localStorage.setItem(r,JSON.stringify(a))},children:(e.name||"").toUpperCase()})},e.name))});return r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:r.jsxs(B,{children:[r.jsx(R,{placement:"bottomRight",trigger:["click"],menu:{items:[]},popupRender:()=>T,children:r.jsx(M,{shape:"circle",icon:r.jsx(j,{}),style:{background:"#FFD700",borderColor:"#FFD700",color:"#000"},title:"VISUALIZAÇÃO DE COLUNAS"})}),r.jsx(M,{shape:"circle",icon:r.jsx(w,{}),style:{background:"#FFD700",borderColor:"#FFD700",color:"#000"},onClick:()=>{l(null),s(!0)},title:"NOVO ELEITOR"})]})}),r.jsx("style",{children:"\n        .eleitores-table .ant-table-thead > tr > th{ background:#FFD700; color:#000; font-family: 'Arimo', Arial, sans-serif; }\n        .eleitores-table .ant-table-thead > tr > th .ant-table-column-title{ display:flex; justify-content:center; align-items:center; text-align:center; }\n        .eleitores-table .ant-table-tbody > tr > td{ font-family: 'Roboto Condensed', Arial, sans-serif; padding:2px 6px; line-height:0.95; height:22px; }\n      "}),r.jsx(re,{loading:a,dataSource:e,columns:A,rowKey:e=>e.id??JSON.stringify(e),bordered:!0,size:"small",className:"ant-table-striped eleitores-table"}),r.jsx(Xt,{open:o,initial:i||void 0,onCancel:()=>s(!1),onSaved:async()=>{s(!1),await S()}})]})}function Gt({open:e,initial:t,onCancel:a,onSaved:s}){const[i]=_.useForm(),[l,c]=f.useState(!1),[d,m]=f.useState([]),p=Ne(),{user:h}=vt(),{message:g}=W.useApp(),y=f.useMemo(()=>{const e=h?.login_time;if(!e)return null;const t=n(e);if(o(t))return t;const a=new Date(e);return isNaN(a.getTime())?null:a},[h]),[x,v]=f.useState(""),b=y?u(y,"dd/MM/yyyy HH:mm",{locale:Ct}):"",j=String(localStorage.getItem("tenantSlug")||"captar"),w=String(localStorage.getItem("tenantName")||"CAPTAR");f.useEffect(()=>{const e=()=>{if(!y)return void v("");const e=Date.now()-y.getTime(),t=Math.floor(e/36e5),a=Math.floor(e%36e5/6e4),r=Math.floor(e%6e4/1e3),n=String(t).padStart(2,"0"),o=String(a).padStart(2,"0"),s=String(r).padStart(2,"0");v(`${n}:${o}:${s}`)};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[y]),f.useEffect(()=>{if(e)if((async()=>{try{const e=((await p.listTenants()).rows||[]).map(e=>({label:e.Nome??e.nome,value:String(e.Nome??e.nome),slug:e.Slug??e.slug}));if(m(e),!t){const t=localStorage.getItem("tenantSlug")||"captar",a=e.find(e=>(e.slug||"").toLowerCase()===t.toLowerCase());a&&i.setFieldValue("TenantLayer",a.value)}}catch{}})(),t){const e={...t};e.Nome&&(e.nome=e.Nome),e.TipoApoio&&(e.tipo_apoio=e.TipoApoio),e.AreaAtuacao&&(e.area_atuacao=e.AreaAtuacao),i.setFieldsValue(e)}else i.resetFields()},[e,t,i,p]);const S=async()=>{try{const e=await i.validateFields();c(!0);const a=String(localStorage.getItem("tenantName")||"CAPTAR"),r=String(e.TenantLayer||a);try{const t=(await p.listTenants()).rows||[],a=String(e.TenantLayer||r);(t.find(e=>String(e.Nome??e.nome).toUpperCase()===a.toUpperCase())||t.find(e=>String(e.Slug??e.slug).toUpperCase()===String(localStorage.getItem("tenantSlug")||"captar").toUpperCase()))&&delete e.IdTenant}catch{}if(Object.keys(e).forEach(t=>void 0===e[t]&&delete e[t]),t?.id||t?.IdAtivista){const a=t.id||t.IdAtivista;await p.updateAtivista(a,e),g.success("Ativista atualizado com sucesso!")}else await p.createAtivista(e),g.success("Ativista criado com sucesso!");s()}catch(e){const t=e?.response?.data?.detail||e?.message||"Erro ao salvar ativista";g.error(t)}finally{c(!1)}},C=e=>{const t=e?.target?.value;return"string"==typeof t?t.toUpperCase():t};return r.jsxs($,{open:e,title:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{className:"navbar-logo",style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("img",{src:bt,alt:"CAPTAR",style:{height:110,backgroundColor:"#ffffff",borderRadius:8,padding:6}}),r.jsxs("div",{style:{fontSize:12},children:["TENANT: ",r.jsx("strong",{style:{color:"#333"},children:String(w||j).toUpperCase()})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsxs("div",{style:{textAlign:"right"},children:[r.jsx("div",{style:{fontWeight:700},children:h?.usuario?String(h?.usuario).toUpperCase():String(h?.nome||"").toUpperCase()||"USUÁRIO"}),r.jsx("div",{style:{fontSize:12},children:`FUNÇÃO: ${String(h?.funcao||"").toUpperCase()} | PERFIL: ${String(h?.perfil||"").toUpperCase()}`}),r.jsx("div",{style:{fontSize:12},children:`LOGIN: ${b||"--"} | TEMPO CONECTADO: ${x||"--:--:--"}`})]}),r.jsx(L,{size:"large"})]})]}),onOk:S,onCancel:a,confirmLoading:l,width:980,centered:!0,footer:null,className:"ativistas-modal",destroyOnHidden:!0,closable:!1,maskClosable:!1,children:[r.jsx("style",{children:".ativistas-modal .ant-modal-header{ border-bottom: 1px solid #e8e8e8; } .ativistas-modal .ant-modal-content{ border-radius: 0 !important; } .ativistas-modal .ant-form-item{ margin-bottom:6px; }"}),r.jsxs(_,{form:i,layout:"vertical",children:[r.jsxs("div",{style:{display:"grid",gap:16},children:[r.jsxs(X,{title:"Dados do Ativista",size:"small",children:[r.jsx(_.Item,{name:"nome",label:"Nome",rules:[{required:!0,message:"Nome é obrigatório"}],getValueFromEvent:C,children:r.jsx(V,{prefix:r.jsx(T,{}),placeholder:"Nome completo",style:{borderRadius:8}})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[r.jsx(_.Item,{name:"tipo_apoio",label:"Tipo de Apoio",children:r.jsxs(te,{placeholder:"Selecione",style:{borderRadius:8},children:[r.jsx(te.Option,{value:"VOLUNTARIO",children:"Voluntário"}),r.jsx(te.Option,{value:"APOIADOR",children:"Apoiador"}),r.jsx(te.Option,{value:"LIDERANCA",children:"Liderança"}),r.jsx(te.Option,{value:"COORDENADOR",children:"Coordenador"})]})}),r.jsx(_.Item,{name:"area_atuacao",label:"Área de Atuação",getValueFromEvent:C,children:r.jsx(V,{prefix:r.jsx(E,{}),placeholder:"Ex: Saúde, Educação",style:{borderRadius:8}})})]})]}),r.jsx(X,{title:"Vinculação",size:"small",children:r.jsx(_.Item,{name:"TenantLayer",label:"Tenant Layer",rules:[{required:!0}],children:r.jsx(te,{options:d,optionFilterProp:"label",showSearch:!0,style:{borderRadius:8},disabled:!!t})})})]}),r.jsxs(B,{style:{marginTop:16,display:"flex",justifyContent:"flex-end",width:"100%"},children:[r.jsx(M,{onClick:a,icon:r.jsx(ne,{}),children:"CANCELAR"}),r.jsx(M,{type:"primary",onClick:S,loading:l,icon:r.jsx(oe,{}),children:"SALVAR"})]})]})]})}function Zt(){const[e,t]=f.useState([]),[a,n]=f.useState(!1),[o,s]=f.useState(!1),[i,l]=f.useState(null),[c,d]=f.useState([]),[u,p]=f.useState({}),[h,g]=f.useState([]),y=Ne(),{user:x}=vt(),v=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z",fill:"currentColor"}),r.jsx("path",{d:"M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z",fill:"currentColor"})]}),b=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M6 7h12M9 7v10m6-10v10M4 7h16l-1 14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2L4 7z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),j=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M3 4h6v16H3V4zm12 0h6v16h-6V4z",fill:"currentColor"})}),w=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("circle",{cx:"12",cy:"8",r:"4",stroke:"currentColor",strokeWidth:"2"}),r.jsx("path",{d:"M4 20c0-3.866 3.582-7 8-7s8 3.134 8 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),r.jsx("path",{d:"M18 6h3M19.5 4.5v3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),S=async()=>{try{n(!0);const e=await y.getAtivistasSchema(),a=["id","nome","tipo_apoio","area_atuacao","TenantLayer","DataCadastro"],r={};for(const t of e.columns||[])r[t.name]=t;const o=a.filter(e=>r[e]).map(e=>r[e]),s=(e.columns||[]).filter(e=>!a.includes(e.name));d([...o,...s]);const i=(await y.getAtivistas()).rows||[];t(i);const l={};for(const t of a)r[t]&&(l[t]=!0);for(const t of s)l[t.name]=!1;const c=`ativistas.columns.visible.${x?.usuario||"default"}`,u=localStorage.getItem(c);p(u?JSON.parse(u):l);const m=`ativistas.columns.order.${x?.usuario||"default"}`,h=localStorage.getItem(m);g(h?JSON.parse(h):a.filter(e=>r[e]))}catch(e){q.error(e?.response?.data?.detail||"Erro ao carregar ativistas")}finally{n(!1)}};f.useEffect(()=>{S()},[]);const C=c.map(t=>{const a=t.name,r=Array.from(new Set((e||[]).map(e=>e[a]).filter(e=>null!=e))).slice(0,20).map(e=>({text:Array.isArray(e)?String(e.join(", ")).toUpperCase():String(e).toUpperCase(),value:Array.isArray(e)?String(e.join(", ")).toUpperCase():String(e).toUpperCase()})),n=(t.type||"").toLowerCase(),o=new Set(["id","TenantLayer","DataCadastro","DataUpdate"]),s={title:{id:"ID",nome:"NOME",tipo_apoio:"TIPO DE APOIO",area_atuacao:"ÁREA DE ATUAÇÃO",TenantLayer:"TENANT LAYER",DataCadastro:"DATA CADASTRO",DataUpdate:"DATA ATUALIZAÇÃO"}[a]||a.toUpperCase(),dataIndex:a,align:o.has(a)?"center":"left",filters:r,onFilter:(e,t)=>String(t[a]).toUpperCase()===String(e).toUpperCase(),sorter:(e,t)=>{const r=e[a],o=t[a];if(null==r)return-1;if(null==o)return 1;if(Array.isArray(r)||Array.isArray(o)){const e=Array.isArray(r)?r.join(", "):String(r),t=Array.isArray(o)?o.join(", "):String(o);return e.toUpperCase().localeCompare(t.toUpperCase())}return n.includes("int")||n.includes("numeric")?Number(r)-Number(o):n.includes("date")||n.includes("timestamp")?new Date(r).getTime()-new Date(o).getTime():String(r).toUpperCase().localeCompare(String(o).toUpperCase())},sortDirections:["ascend","descend"],render:e=>{if("boolean"==typeof e)return e?"SIM":"NÃO";if(null==e)return"";if(Array.isArray(e))return e.map(e=>String(e).toUpperCase()).join(" | ");const t=new Set(["DataUpdate"]);if(n.includes("date")||n.includes("timestamp")){const r=new Date(e);if(!isNaN(r.getTime())){if("DataCadastro"===a)return r.toLocaleString("pt-BR",{hour12:!1});if(t.has(a))return r.toLocaleTimeString("pt-BR",{hour12:!1})}}return String(e).toUpperCase()},onHeaderCell:()=>({draggable:!0,onDragStart:e=>{e.dataTransfer.setData("text/plain",a)},onDragOver:e=>{e.preventDefault()},onDrop:e=>{const t=e.dataTransfer.getData("text/plain"),r=a;t&&t!==r&&g(e=>{const a=e.filter(e=>e!==t),n=a.indexOf(r);if(-1===n)return e;a.splice(n,0,t);const o=`ativistas.columns.order.${x?.usuario||"default"}`;return localStorage.setItem(o,JSON.stringify(a)),a})}})};return"id"===a&&(s.defaultSortOrder="ascend"),s}),I={title:"AÇÕES",dataIndex:"__actions__",render:(e,t)=>r.jsxs(B,{children:[r.jsx(M,{type:"text",icon:r.jsx(v,{}),title:"EDITAR",onClick:()=>{l(t),s(!0)}}),r.jsx(M,{type:"text",danger:!0,icon:r.jsx(b,{}),title:"DELETAR",onClick:async()=>{try{if(!t.id)return void q.info("REGISTRO SEM ID");await y.deleteAtivista(t.id),q.success("ATIVISTA DELETADO"),await S()}catch(e){q.error(e?.response?.data?.detail||"ERRO AO DELETAR ATIVISTA")}}})]})},A=(h.length?h:C.map(e=>e.dataIndex)).map(e=>C.find(t=>t.dataIndex===e)).filter(Boolean).filter(e=>u[e.dataIndex]).concat([I]),T=r.jsx("div",{style:{padding:12},children:c.map(e=>r.jsx("div",{style:{marginBottom:6},children:r.jsx(ae,{checked:!!u[e.name],onChange:t=>{const a={...u,[e.name]:t.target.checked};p(a);const r=`ativistas.columns.visible.${x?.usuario||"default"}`;localStorage.setItem(r,JSON.stringify(a))},children:(e.name||"").toUpperCase()})},e.name))});return r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:r.jsxs(B,{children:[r.jsx(R,{placement:"bottomRight",trigger:["click"],menu:{items:[]},popupRender:()=>T,children:r.jsx(M,{shape:"circle",icon:r.jsx(j,{}),style:{background:"#FFD700",borderColor:"#FFD700",color:"#000"},title:"VISUALIZAÇÃO DE COLUNAS"})}),r.jsx(M,{shape:"circle",icon:r.jsx(w,{}),style:{background:"#FFD700",borderColor:"#FFD700",color:"#000"},onClick:()=>{l(null),s(!0)},title:"NOVO ATIVISTA"})]})}),r.jsx("style",{children:"\n        .ativistas-table .ant-table-thead > tr > th{ background:#FFD700; color:#000; font-family: 'Arimo', Arial, sans-serif; }\n        .ativistas-table .ant-table-thead > tr > th .ant-table-column-title{ display:flex; justify-content:center; align-items:center; text-align:center; }\n        .ativistas-table .ant-table-tbody > tr > td{ font-family: 'Roboto Condensed', Arial, sans-serif; padding:2px 6px; line-height:0.95; height:22px; }\n      "}),r.jsx(re,{loading:a,dataSource:e,columns:A,rowKey:e=>e.id??JSON.stringify(e),bordered:!0,size:"small",className:"ant-table-striped ativistas-table"}),r.jsx(Gt,{open:o,initial:i||void 0,onCancel:()=>s(!1),onSaved:async()=>{s(!1),await S()}})]})}function Qt({open:e,initial:t,onCancel:a,onSaved:s}){const[i]=_.useForm(),[l,c]=f.useState([]),[d,m]=f.useState([]),[p,h]=f.useState([]),[g,y]=f.useState([]),[x,v]=f.useState([]),[b,j]=f.useState([]),[w,S]=f.useState({}),[C,I]=f.useState({}),[A,E]=f.useState([]),N=Ne(),{message:k}=W.useApp(),D=f.useRef(null),[U,O]=f.useState(null),[R,P]=f.useState(void 0),{user:F}=vt(),H=f.useMemo(()=>{const e=F?.login_time;if(!e)return null;const t=n(e);if(o(t))return t;const a=new Date(e);return isNaN(a.getTime())?null:a},[F]),[Y,q]=f.useState(""),J=H?u(H,"dd/MM/yyyy HH:mm",{locale:Ct}):"",Q=String(localStorage.getItem("tenantSlug")||"captar"),ee=String(localStorage.getItem("tenantName")||"CAPTAR");f.useEffect(()=>{const e=()=>{if(!H)return void q("");const e=Date.now()-H.getTime(),t=Math.floor(e/36e5),a=Math.floor(e%36e5/6e4),r=Math.floor(e%6e4/1e3),n=String(t).padStart(2,"0"),o=String(a).padStart(2,"0"),s=String(r).padStart(2,"0");q(`${n}:${o}:${s}`)};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[H]);const re=e=>{const t=e?.target?.value;return"string"==typeof t?t.toUpperCase():t},me=e=>{const t=e?.target?.value;return"string"==typeof t?t.toLowerCase():t};f.useEffect(()=>{if(e){(async()=>{try{const e=(await N.getUsuariosSchema()).columns||[],t=new Set(e.map(e=>e.name)),a=["Coordenador","Supervisor","Ativista"].filter(e=>!t.has(e)).map(e=>({name:e,type:"varchar",nullable:!0}));c([...e,...a]),m(e.map(e=>e.name))}catch{}})(),(async()=>{try{const e=((await N.listPerfil()).rows||[]).map(e=>({label:e.Perfil??e.perfil,value:String(e.Perfil??e.perfil)}));h(e)}catch{}})(),(async()=>{try{const e=((await N.listFuncoes()).rows||[]).map(e=>({label:e.Funcao??e.Descricao??"",value:String(e.Funcao??e.Descricao??"")}));y(e)}catch{}})(),(async()=>{try{const e=(await N.listCoordenadores()).rows||[];v(e.map(e=>({label:e.Nome??e.nome,value:String(e.Nome??e.nome)})));const t={};for(const a of e){const e=a.Nome??a.nome,r=String(a.TenantLayer??a.NomeTenant??a.nomeTenant??"CAPTAR");void 0!==e&&(t[String(e)]=r)}S(t)}catch{}})(),(async()=>{try{const e=((await N.listTenants()).rows||[]).map(e=>({label:e.Nome??e.nome,value:String(e.Nome??e.nome),slug:e.Slug??e.slug}));E(e);const a=localStorage.getItem("tenantSlug")||"captar",r=e.find(e=>(e.slug||"").toLowerCase()===a.toLowerCase());r&&!t&&i.setFieldValue("TenantLayer",r.value)}catch{}})(),t?i.setFieldsValue(t):i.resetFields();try{const e=i.getFieldValue("ImagemUploadDataUrl");P(e||t?.Imagem)}catch{}}},[e,t]);const pe=_.useWatch("Funcao",i),he=_.useWatch("Coordenador",i),ge=_.useWatch("TenantLayer",i);f.useEffect(()=>{const e=String(pe||"").toUpperCase().trim();"ADMINISTRADOR"===e||"COORDENADOR"===e?(i.setFieldValue("Coordenador",i.getFieldValue("Nome")),i.setFieldValue("Supervisor","NAO SE APLICA"),i.setFieldValue("Ativista","NAO SE APLICA")):"SUPERVISOR"===e&&(i.setFieldValue("Supervisor",i.getFieldValue("Nome")),i.setFieldValue("Ativista","NAO SE APLICA"))},[pe]),f.useEffect(()=>{const e=String(pe||"").toUpperCase().trim();"SUPERVISOR"!==e&&"ATIVISTA"!==e||!he?j([]):(async()=>{try{const e=(await N.listSupervisores(String(he))).rows||[];j(e.map(e=>({label:e.Nome??e.nome,value:String(e.Nome??e.nome)})));const t={};for(const a of e){const e=a.Nome??a.nome,r=String(a.TenantLayer??a.NomeTenant??a.nomeTenant??"CAPTAR");void 0!==e&&(t[String(e)]=r)}I(t)}catch{}})()},[he,pe]);const fe=e=>{const a=new Set(["DataCadastro","Cadastrante","DataUpdate","TipoUpdate","CadastranteUpdate","UltimoAcesso","TokenRecuperacao","TokenExpiracao","Candidato","UsuarioUpdate","IdTenant"]);if("IdUsuario"===e.name)return null;if("IdPerfil"===e.name)return null;if("IdTenant"===e.name)return null;if(a.has(e.name))return null;const n=!e.nullable,o=e.type.toLowerCase();if("Perfil"===e.name)return r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:n}],children:r.jsx(te,{options:p,optionFilterProp:"label",showSearch:!0,style:{borderRadius:8},suffixIcon:r.jsx(ie,{})})},e.name);if("TenantLayer"===e.name){const a=!!!t?.IdUsuario;return r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:!0}],children:r.jsx(te,{options:A,optionFilterProp:"label",showSearch:!0,style:{borderRadius:8},disabled:a})},e.name)}if("Funcao"===e.name)return r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:n}],children:r.jsx(te,{options:g,optionFilterProp:"label",showSearch:!0,style:{borderRadius:8},suffixIcon:r.jsx(le,{})})},e.name);if("Coordenador"===e.name){const t=String(pe||"").toUpperCase().trim(),a="ADMINISTRADOR"===t||"COORDENADOR"===t,n=String(ge||"").trim(),o=n&&"CAPTAR"!==n.toUpperCase()?x.filter(e=>String(w[e.value]||"").toUpperCase()===n.toUpperCase()):x;return r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:"ADMINISTRADOR"!==t&&"COORDENADOR"!==t}],children:r.jsx(te,{options:o,optionFilterProp:"label",showSearch:!0,style:{borderRadius:8},disabled:a})},e.name)}if("Supervisor"===e.name){const t=String(pe||"").toUpperCase().trim(),a="ADMINISTRADOR"===t||"COORDENADOR"===t,n="ATIVISTA"===t,o=String(ge||"").trim(),s=o&&"CAPTAR"!==o.toUpperCase()?b.filter(e=>String(C[e.value]||"").toUpperCase()===o.toUpperCase()):b;return r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:n}],children:r.jsx(te,{options:s,optionFilterProp:"label",showSearch:!0,style:{borderRadius:8},disabled:a})},e.name)}if("Ativista"===e.name)return r.jsx(_.Item,{name:e.name,label:e.name,children:r.jsx(V,{style:{borderRadius:8},disabled:!0})},e.name);if("Senha"===e.name)return r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:n}],children:r.jsx(V.Password,{style:{borderRadius:8},prefix:r.jsx(z,{})})},e.name);if(o.includes("boolean"))return r.jsx(_.Item,{name:e.name,valuePropName:"checked",label:e.name,children:r.jsx(ae,{})},e.name);if(o.includes("date")){const t=o.includes("timestamp");return r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:n}],children:r.jsx(Z,{style:{width:"100%",borderRadius:8},showTime:t})},e.name)}return o.includes("int")||o.includes("numeric")?r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:n}],children:r.jsx(ce,{style:{width:"100%",borderRadius:8}})},e.name):"Celular"===e.name?r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:n}],children:r.jsx(V,{style:{borderRadius:8},prefix:r.jsx(G,{}),maxLength:15,onChange:t=>{const a=(e=>{const t=(e||"").replace(/\D/g,"").slice(0,11);if(t.length<=2)return`(${t}`;const a=t.slice(0,2),r=t.slice(2),n="9"===r[0]?r:"9"+r,o=n.slice(0,5),s=n.slice(5,9);return o?s?`(${a}) ${o}-${s}`:`(${a}) ${o}`:`(${a})`})(t.target.value);i.setFieldsValue({[e.name]:a})}})},e.name):"Nome"===e.name?r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:n}],getValueFromEvent:re,children:r.jsx(V,{style:{borderRadius:8},prefix:r.jsx(T,{}),maxLength:"number"==typeof e.maxLength?e.maxLength:void 0})},e.name):"CPF"===e.name?r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:n}],children:r.jsx(V,{style:{borderRadius:8},prefix:r.jsx(K,{}),maxLength:"number"==typeof e.maxLength?e.maxLength:14,onChange:t=>{const a=(e=>{const t=(e||"").replace(/\D/g,"").slice(0,11),a=t.slice(0,3),r=t.slice(3,6),n=t.slice(6,9),o=t.slice(9,11);let s=a;return r&&(s+=`.${r}`),n&&(s+=`.${n}`),o&&(s+=`-${o}`),s})(t.target.value);i.setFieldsValue({[e.name]:a})}})},e.name):"Email"===e.name?r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:n}],getValueFromEvent:me,children:r.jsx(V,{style:{borderRadius:8},prefix:r.jsx(de,{}),maxLength:"number"==typeof e.maxLength?e.maxLength:void 0})},e.name):"Usuario"===e.name?r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:n}],getValueFromEvent:re,children:r.jsx(V,{style:{borderRadius:8},prefix:r.jsx(ue,{}),maxLength:"number"==typeof e.maxLength?e.maxLength:void 0})},e.name):"Imagem"===e.name?null:r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:n}],getValueFromEvent:re,children:r.jsx(V,{style:{borderRadius:8},maxLength:"number"==typeof e.maxLength?e.maxLength:void 0})},e.name)};return r.jsxs($,{open:e,title:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{className:"navbar-logo",style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("img",{src:bt,alt:"CAPTAR",style:{height:110,backgroundColor:"#ffffff",borderRadius:8,padding:6}}),r.jsxs("div",{style:{fontSize:12},children:["TENANT: ",r.jsx("strong",{style:{color:"#333"},children:String(ee||Q).toUpperCase()})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsxs("div",{style:{textAlign:"right"},children:[r.jsx("div",{style:{fontWeight:700},children:F?.usuario?String(F?.usuario).toUpperCase():String(F?.nome||"").toUpperCase()||"USUÁRIO"}),r.jsx("div",{style:{fontSize:12},children:`FUNÇÃO: ${String(F?.funcao||"").toUpperCase()} | PERFIL: ${String(F?.perfil||"").toUpperCase()}`}),r.jsx("div",{style:{fontSize:12},children:`LOGIN: ${J||"--"} | TEMPO CONECTADO: ${Y||"--:--:--"}`})]}),r.jsx(L,{size:"large"})]})]}),onCancel:a,footer:null,destroyOnHidden:!0,width:980,closable:!1,maskClosable:!1,className:"usuarios-modal",children:[r.jsx("style",{children:".usuarios-modal .ant-modal-header{ border-bottom: 1px solid #e8e8e8; } .usuarios-modal .ant-modal-content{ border-radius: 0 !important; } .usuarios-modal .ant-form-item{ margin-bottom:6px; }"}),r.jsxs(_,{form:i,layout:"vertical",children:[r.jsx("div",{style:{display:"grid",gap:16},children:(()=>{const e={};for(const a of l)e[a.name]=a;const t=["Funcao","Perfil","Usuario","Senha","Coordenador","Supervisor","Ativista"].filter(t=>e[t]);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:16},children:[r.jsx(X,{title:"Identificação",size:"small",children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 160px",gap:6,alignItems:"end"},children:[e.CPF&&r.jsx("div",{style:{width:"50%"},children:fe(e.CPF)}),e.Ativo&&r.jsx(_.Item,{name:"Ativo",label:"Ativo",valuePropName:"checked",style:{marginBottom:0},children:r.jsx(se,{})}),e.Nome&&r.jsx("div",{style:{gridColumn:"1 / span 2"},children:fe(e.Nome)}),e.Celular&&r.jsx("div",{style:{width:"50%"},children:fe(e.Celular)}),e.Email&&r.jsx("div",{style:{gridColumn:"1 / span 2"},children:fe(e.Email)})]})}),r.jsx(X,{title:"Foto",size:"small",children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx(M,{onClick:async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:!0});O(e),D.current&&(D.current.srcObject=e,await D.current.play())}catch{}},children:"Usar Webcam"}),r.jsx(M,{onClick:()=>{const e=D.current;if(e){const t=document.createElement("canvas");t.width=e.videoWidth||640,t.height=e.videoHeight||480;const a=t.getContext("2d");if(a){a.drawImage(e,0,0,t.width,t.height);const r=t.toDataURL("image/jpeg",.92);i.setFieldsValue({ImagemUploadDataUrl:r}),P(r)}}},children:"Capturar"}),r.jsx(M,{onClick:()=>{U&&U.getTracks().forEach(e=>e.stop()),O(null)},children:"Encerrar"})]}),r.jsx("div",{children:r.jsx("input",{type:"file",accept:"image/*,.webp",onChange:e=>{const t=e.target.files?.[0];if(t){i.setFieldsValue({ImagemUploadFile:t});const e=new FileReader;e.onload=()=>{const t=e.result;i.setFieldsValue({ImagemUploadDataUrl:t}),P(t)},e.readAsDataURL(t)}}})}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:U?r.jsx("video",{ref:D,style:{width:"100%",maxWidth:360,borderRadius:8}}):R?r.jsx("img",{src:R,alt:"Preview",style:{width:"100%",maxWidth:360,borderRadius:8,background:"#f5f5f5"}}):r.jsx("div",{style:{width:360,height:240,background:"#fafafa",border:"1px dashed #ddd",borderRadius:8}})})]})})]}),r.jsx(X,{title:"Acesso",size:"small",children:r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:t.map(t=>fe(e[t]))})})]})})()}),r.jsxs(B,{style:{marginTop:16,display:"flex",justifyContent:"flex-end",width:"100%"},children:[r.jsx(M,{onClick:a,icon:r.jsx(ne,{}),children:"CANCELAR"}),r.jsx(M,{type:"primary",onClick:async()=>{try{const n=await i.validateFields();if(n.Funcao){const e=String(n.Funcao);n.Funcao=e}const o=String(n.Nome||"").trim(),l=String(n.Funcao||"").toUpperCase().trim();if("ADMINISTRADOR"===l||"COORDENADOR"===l)n.Coordenador=o,n.Supervisor="NAO SE APLICA",n.Ativista="NAO SE APLICA";else if("SUPERVISOR"===l){if(!String(n.Coordenador||"").trim())throw new Error("Coordenador é obrigatório");n.Supervisor=o,n.Ativista="NAO SE APLICA"}else if("ATIVISTA"===l){if(!String(n.Coordenador||"").trim())throw new Error("Coordenador é obrigatório");if(!String(n.Supervisor||"").trim())throw new Error("Supervisor é obrigatório");n.Ativista=o}if("string"==typeof n.Celular){const e=String(n.Celular);n.Celular=e.length>15?e.slice(0,15):e}const c=async()=>{const e=new Set([...d]);e.delete("IdTenant");const a={};for(const t of Object.keys(n))e.has(t)&&(a[t]=n[t]);if(t?.IdUsuario){const e=await N.updateUsuario(t.IdUsuario,a);return k.success("Usuário atualizado"),e.id}{const e=await N.createUsuario(a);return k.success("Usuário criado"),e.id}},u=String(localStorage.getItem("tenantName")||"CAPTAR"),m=String(n.TenantLayer||u);if("CAPTAR"===String(u).toUpperCase()){const e=String(n.Coordenador||"").trim(),t=String(n.Supervisor||"").trim();if(e){const t=String(w[e]||m);if(t&&m&&t.toUpperCase()!==m.toUpperCase())return void k.error("Não é possível vincular: Tenants diferentes")}if(t){const e=String(C[t]||m);if(e&&m&&e.toUpperCase()!==m.toUpperCase())return void k.error("Não é possível vincular: Tenants diferentes")}}try{const e=(await N.listTenants()).rows||[],t=String(n.TenantLayer||m);(e.find(e=>String(e.Nome??e.nome).toUpperCase()===t.toUpperCase())||e.find(e=>String(e.Slug??e.slug).toUpperCase()===String(localStorage.getItem("tenantSlug")||"captar").toUpperCase()))&&delete n.IdTenant}catch{}try{const t=await c();if(i.getFieldValue("ImagemUploadFile")||i.getFieldValue("ImagemUploadDataUrl")){const r=i.getFieldValue("ImagemUploadFile"),n=i.getFieldValue("ImagemUploadDataUrl");try{await N.uploadUsuarioFoto(t,{file:r,data_url:n}),n&&P(n)}catch{try{if(r&&"image/webp"===r.type||n&&String(n).startsWith("data:image/webp")){const o=n||(r?await(a=r,new Promise((e,t)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=e=>t(e),r.readAsDataURL(a)})):void 0);if(o){const a=await(e=o,new Promise((t,a)=>{const r=new Image;r.onload=()=>{const a=document.createElement("canvas");a.width=r.width||640,a.height=r.height||480;const n=a.getContext("2d");if(n){n.drawImage(r,0,0);try{const e=a.toDataURL("image/jpeg",.92);t(e)}catch(o){t(e)}}else t(e)},r.onerror=e=>a(e),r.src=e}));await N.uploadUsuarioFoto(t,{data_url:a}),P(a)}}}catch{}}}}catch(r){const e=r?.response?.data?.detail||"";if(!n.Celular||"string"!=typeof n.Celular||!e.includes("character varying(15)")){const e=r?.response?.data?.detail||r?.message||"Falha ao salvar usuário";throw k.error(e),r}n.Celular=n.Celular.replace(" ",""),await c(),k.warning("Celular ajustado para caber no limite atual do banco")}s()}catch{}var e,a},icon:r.jsx(oe,{}),children:"SALVAR"})]})]})]})}function ea(){const[e,t]=f.useState([]),[a,n]=f.useState(!1),[o,s]=f.useState(!1),[i,l]=f.useState(null),[c,d]=f.useState([]),[u,p]=f.useState({}),[h,g]=f.useState([]),y=Ne(),{user:x}=vt(),v=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z",fill:"currentColor"}),r.jsx("path",{d:"M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z",fill:"currentColor"})]}),b=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M6 7h12M9 7v10m6-10v10M4 7h16l-1 14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2L4 7z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),j=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M3 4h6v16H3V4zm12 0h6v16h-6V4z",fill:"currentColor"})}),w=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("circle",{cx:"12",cy:"8",r:"4",stroke:"currentColor",strokeWidth:"2"}),r.jsx("path",{d:"M4 20c0-3.866 3.582-7 8-7s8 3.134 8 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),r.jsx("path",{d:"M18 6h3M19.5 4.5v3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),S=async()=>{try{n(!0);const e=await y.getUsuariosSchema(),a=["IdUsuario","Nome","CPF","Usuario","Funcao","Perfil","Email","DataCadastro","Cadastrante","TenantLayer","Ativo"],r={};for(const t of e.columns||[])r[t.name]=t;const o=a.filter(e=>r[e]).map(e=>r[e]),s=(e.columns||[]).filter(e=>!a.includes(e.name));d([...o,...s]);let i=(await y.listUsuarios()).rows||[];try{const e=(await y.listPerfil()).rows||[],t=e=>e.IdPerfil??e.id??e.Id??e.ID,a=e=>e.Perfil??e.perfil,r=new Map;for(const s of e){const e=t(s),n=a(s);void 0!==e&&void 0!==n&&r.set(Number(e),String(n))}const n=(await y.listFuncoes()).rows||[],o=new Map;for(const s of n){const e=s.IdFuncao??s.id??s.Id??s.ID,t=s.Funcao??s.Descricao;void 0!==e&&void 0!==t&&o.set(Number(e),String(t))}i=i.map(e=>{const t=e.IdPerfil??e.idPerfil??e.id_perfil,a=void 0!==t?r.get(Number(t)):e.Perfil??e.perfil,n=e.IdFuncao??e.idFuncao??e.id_funcao;let s=void 0!==n?o.get(Number(n)):void 0;if(!s){const t=e.Funcao,a=Number(t);s=!isNaN(a)&&String(a)===String(t)?o.get(a):t}return{...e,Perfil:a??e.Perfil,Funcao:s??e.Funcao}})}catch{}t(i);const l={};for(const t of a)r[t]&&(l[t]=!0);for(const t of s)l[t.name]=!1;r.IdPerfil&&(l.IdPerfil=!1);const c=`usuarios.columns.visible.${x?.usuario||"default"}`,u=localStorage.getItem(c);p(u?JSON.parse(u):l);const m=`usuarios.columns.order.${x?.usuario||"default"}`,h=localStorage.getItem(m);g(h?JSON.parse(h):a.filter(e=>r[e]))}catch(e){q.error(e?.response?.data?.detail||"Erro ao carregar usuários")}finally{n(!1)}};f.useEffect(()=>{S()},[]);const C=c.map(t=>{const a=t.name,n=Array.from(new Set((e||[]).map(e=>e[a]).filter(e=>null!=e))).slice(0,20).map(e=>({text:Array.isArray(e)?String(e.join(", ")).toUpperCase():String(e).toUpperCase(),value:Array.isArray(e)?String(e.join(", ")).toUpperCase():String(e).toUpperCase()})),o=(t.type||"").toLowerCase(),s=new Set(["IdUsuario","Ativo","CPF","Funcao","Perfil","DataCadastro","TenantLayer","DataUpdate","UltimoAcesso","TokenExpiracao"]),i={title:{IdUsuario:"ID",Nome:"NOME",CPF:"CPF",Usuario:"USUÁRIO",Funcao:"FUNÇÃO",Perfil:"PERFIL",Email:"EMAIL",DataCadastro:"DATA E HORA DE CADASTRO",Cadastrante:"CADASTRANTE",TenantLayer:"TENANT LAYER",Ativo:"ATIVO"}[a]||a.toUpperCase(),dataIndex:a,align:s.has(a)?"center":"left",filters:n,onFilter:(e,t)=>String(t[a]).toUpperCase()===String(e).toUpperCase(),sorter:(e,t)=>{const r=e[a],n=t[a];if(null==r)return-1;if(null==n)return 1;if(Array.isArray(r)||Array.isArray(n)){const e=Array.isArray(r)?r.join(", "):String(r),t=Array.isArray(n)?n.join(", "):String(n);return e.toUpperCase().localeCompare(t.toUpperCase())}return o.includes("int")||o.includes("numeric")?Number(r)-Number(n):o.includes("date")||o.includes("timestamp")?new Date(r).getTime()-new Date(n).getTime():String(r).toUpperCase().localeCompare(String(n).toUpperCase())},sortDirections:["ascend","descend"],render:e=>{if("boolean"==typeof e)return e?"SIM":"NÃO";if(null==e)return"";if(Array.isArray(e))return e.map(e=>String(e).toUpperCase()).join(" | ");const t=new Set(["DataUpdate","UltimoAcesso","TokenExpiracao"]);if(o.includes("date")||o.includes("timestamp")){const r=new Date(e);if(!isNaN(r.getTime())){if("DataCadastro"===a)return r.toLocaleString("pt-BR",{hour12:!1});if(t.has(a))return r.toLocaleTimeString("pt-BR",{hour12:!1})}}if("Ativo"===a){const t="true"===String(e).toLowerCase()||1===e||"SIM"===String(e).toUpperCase();return r.jsx(H,{color:t?"green":"red",children:t?"SIM":"NÃO"})}return"Email"===a?String(e).toLowerCase():String(e).toUpperCase()},onHeaderCell:()=>({draggable:!0,onDragStart:e=>{e.dataTransfer.setData("text/plain",a)},onDragOver:e=>{e.preventDefault()},onDrop:e=>{const t=e.dataTransfer.getData("text/plain"),r=a;t&&t!==r&&g(e=>{const a=e.filter(e=>e!==t),n=a.indexOf(r);if(-1===n)return e;a.splice(n,0,t);const o=`usuarios.columns.order.${x?.usuario||"default"}`;return localStorage.setItem(o,JSON.stringify(a)),a})}})};return"IdUsuario"===a&&(i.defaultSortOrder="ascend"),i}),I={title:"AÇÕES",dataIndex:"__actions__",render:(e,t)=>r.jsxs(B,{children:[r.jsx(M,{type:"text",icon:r.jsx(v,{}),title:"EDITAR",onClick:()=>{l(t),s(!0)}}),r.jsx(M,{type:"text",danger:!0,icon:r.jsx(b,{}),title:"DELETAR",onClick:async()=>{try{if(!t.IdUsuario)return void q.info("REGISTRO SEM ID");await y.deleteUsuario(t.IdUsuario),q.success("USUÁRIO DELETADO"),await S()}catch(e){q.error(e?.response?.data?.detail||"ERRO AO DELETAR USUÁRIO")}}})]})},A=(h.length?h:C.map(e=>e.dataIndex)).map(e=>C.find(t=>t.dataIndex===e)).filter(Boolean).filter(e=>u[e.dataIndex]).concat([I]),T=r.jsx("div",{style:{padding:12},children:c.map(e=>r.jsx("div",{style:{marginBottom:6},children:r.jsx(ae,{checked:!!u[e.name],onChange:t=>{const a={...u,[e.name]:t.target.checked};p(a);const r=`usuarios.columns.visible.${x?.usuario||"default"}`;localStorage.setItem(r,JSON.stringify(a))},children:e.name.toUpperCase()})},e.name))});return r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:r.jsxs(B,{children:[r.jsx(R,{placement:"bottomRight",trigger:["click"],menu:{items:[]},popupRender:()=>T,children:r.jsx(M,{shape:"circle",icon:r.jsx(j,{}),style:{background:"#FFD700",borderColor:"#FFD700",color:"#000"},title:"VISUALIZAÇÃO DE COLUNAS"})}),r.jsx(M,{shape:"circle",icon:r.jsx(w,{}),style:{background:"#FFD700",borderColor:"#FFD700",color:"#000"},onClick:()=>{l(null),s(!0)},title:"NOVO USUÁRIO"})]})}),r.jsx("style",{children:"\n        .usuarios-table .ant-table-thead > tr > th{ background:#FFD700; color:#000; font-family: 'Arimo', Arial, sans-serif; }\n        .usuarios-table .ant-table-thead > tr > th .ant-table-column-title{ display:flex; justify-content:center; align-items:center; text-align:center; }\n        .usuarios-table .ant-table-tbody > tr > td{ font-family: 'Roboto Condensed', Arial, sans-serif; padding:2px 6px; line-height:0.95; height:22px; }\n      "}),r.jsx(re,{loading:a,dataSource:e,columns:A,rowKey:e=>e.IdUsuario??e.id??e.ID??e.id_usuario??JSON.stringify(e),bordered:!0,size:"small",className:"ant-table-striped usuarios-table"}),r.jsx(Qt,{open:o,initial:i||void 0,onCancel:()=>s(!1),onSaved:async()=>{s(!1),await S()}})]})}function ta(){const[e,t]=f.useState([]),[a,n]=f.useState(!1),[o,s]=f.useState(!1),[i,l]=f.useState(null),[c]=_.useForm(),d=Ne();f.useEffect(()=>{u()},[]);const u=async()=>{try{n(!0);const e=await d.getPermissoes();t(e)}catch(e){q.error("Erro ao carregar permissões")}finally{n(!1)}},m=[{title:"PERFIL",dataIndex:"perfil",key:"perfil",sorter:(e,t)=>String(e.perfil).toUpperCase().localeCompare(String(t.perfil).toUpperCase()),sortDirections:["ascend","descend"]},{title:"DESCRIÇÃO",dataIndex:"descricao",key:"descricao",sorter:(e,t)=>String(e.descricao).toUpperCase().localeCompare(String(t.descricao).toUpperCase()),sortDirections:["ascend","descend"]},{title:"AÇÕES",key:"actions",render:(e,t)=>r.jsx(B,{children:r.jsx(M,{type:"text",onClick:()=>(e=>{l(e.id),c.setFieldsValue(e),s(!0)})(t),children:"✎"})})}];return r.jsxs("div",{style:{padding:"24px"},children:[r.jsx(re,{columns:m,dataSource:e,loading:a,rowKey:"id",pagination:{pageSize:10}}),r.jsx($,{title:i?"Editar Permissão":"Nova Permissão",open:o,onOk:()=>c.submit(),onCancel:()=>s(!1),width:800,children:r.jsxs(_,{form:c,layout:"vertical",onFinish:async e=>{try{i&&(await d.updatePermissao(e.perfil,e),q.success("Permissão atualizada com sucesso")),s(!1),u()}catch(t){q.error("Erro ao salvar permissão")}},children:[r.jsx(_.Item,{name:"perfil",label:"Perfil",rules:[{required:!0}],children:r.jsx("input",{disabled:!0})}),r.jsx(_.Item,{name:"descricao",label:"Descrição",children:r.jsx("input",{})}),r.jsxs(me,{gutter:16,children:[r.jsx(pe,{span:12,children:r.jsxs(X,{title:"Eleitores",children:[r.jsxs(_.Item,{name:"pode_criar_eleitor",valuePropName:"checked",children:[r.jsx(se,{})," Criar"]}),r.jsxs(_.Item,{name:"pode_editar_eleitor",valuePropName:"checked",children:[r.jsx(se,{})," Editar"]}),r.jsxs(_.Item,{name:"pode_deletar_eleitor",valuePropName:"checked",children:[r.jsx(se,{})," Deletar"]})]})}),r.jsx(pe,{span:12,children:r.jsxs(X,{title:"Ativistas",children:[r.jsxs(_.Item,{name:"pode_criar_ativista",valuePropName:"checked",children:[r.jsx(se,{})," Criar"]}),r.jsxs(_.Item,{name:"pode_editar_ativista",valuePropName:"checked",children:[r.jsx(se,{})," Editar"]}),r.jsxs(_.Item,{name:"pode_deletar_ativista",valuePropName:"checked",children:[r.jsx(se,{})," Deletar"]})]})})]}),r.jsxs(me,{gutter:16,children:[r.jsx(pe,{span:12,children:r.jsxs(X,{title:"Usuários",children:[r.jsxs(_.Item,{name:"pode_criar_usuario",valuePropName:"checked",children:[r.jsx(se,{})," Criar"]}),r.jsxs(_.Item,{name:"pode_editar_usuario",valuePropName:"checked",children:[r.jsx(se,{})," Editar"]}),r.jsxs(_.Item,{name:"pode_deletar_usuario",valuePropName:"checked",children:[r.jsx(se,{})," Deletar"]})]})}),r.jsx(pe,{span:12,children:r.jsxs(X,{title:"Sistema",children:[r.jsxs(_.Item,{name:"pode_enviar_disparos",valuePropName:"checked",children:[r.jsx(se,{})," Disparos"]}),r.jsxs(_.Item,{name:"pode_ver_relatorios",valuePropName:"checked",children:[r.jsx(se,{})," Relatórios"]}),r.jsxs(_.Item,{name:"pode_exportar_dados",valuePropName:"checked",children:[r.jsx(se,{})," Exportar"]}),r.jsxs(_.Item,{name:"pode_importar_dados",valuePropName:"checked",children:[r.jsx(se,{})," Importar"]})]})})]})]})})]})}const aa=()=>{const[e]=_.useForm(),[t,a]=f.useState(!1),[n,o]=f.useState([]),[s,i]=f.useState({current:1,pageSize:10,total:0}),l=[{title:"ID",dataIndex:"id",key:"id",width:80,sorter:(e,t)=>String(e.id).localeCompare(String(t.id)),sortDirections:["ascend","descend"]},{title:"NOME",dataIndex:"nome",key:"nome",width:150,sorter:(e,t)=>String(e.nome).toUpperCase().localeCompare(String(t.nome).toUpperCase()),sortDirections:["ascend","descend"]},{title:"TIPO",dataIndex:"tipo",key:"tipo",width:120,sorter:(e,t)=>String(e.tipo).toUpperCase().localeCompare(String(t.tipo).toUpperCase()),sortDirections:["ascend","descend"]},{title:"DATA",dataIndex:"data",key:"data",width:120,sorter:(e,t)=>new Date(e.data).getTime()-new Date(t.data).getTime(),sortDirections:["ascend","descend"]},{title:"STATUS",dataIndex:"status",key:"status",width:100,sorter:(e,t)=>String(e.status).toUpperCase().localeCompare(String(t.status).toUpperCase()),sortDirections:["ascend","descend"],render:e=>r.jsx("span",{style:{color:{ativo:"green",inativo:"red",pendente:"orange"}[e]||"black"},children:String(e).toUpperCase()})},{title:"RESULTADO",dataIndex:"resultado",key:"resultado",width:200,sorter:(e,t)=>String(e.resultado).toUpperCase().localeCompare(String(t.resultado).toUpperCase()),sortDirections:["ascend","descend"]}];return r.jsx("div",{className:"consultas-container",children:r.jsxs(X,{title:"Consultas Avançadas",className:"consultas-card",children:[r.jsxs(_,{form:e,layout:"vertical",onFinish:async()=>{a(!0);try{const e=[{id:"1",nome:"Eleitor 1",tipo:"Eleitor",data:"2025-01-15",status:"ativo",resultado:"Encontrado"},{id:"2",nome:"Ativista 2",tipo:"Ativista",data:"2025-01-14",status:"ativo",resultado:"Encontrado"}];o(e),i({...s,total:e.length})}catch(e){console.error("Erro ao buscar:",e)}finally{a(!1)}},className:"consultas-form",children:[r.jsxs(me,{gutter:16,children:[r.jsx(pe,{xs:24,sm:12,md:8,children:r.jsx(_.Item,{label:"Buscar por",name:"searchType",initialValue:"nome",children:r.jsx(te,{options:[{label:"Nome",value:"nome"},{label:"CPF",value:"cpf"},{label:"Email",value:"email"},{label:"Telefone",value:"telefone"}]})})}),r.jsx(pe,{xs:24,sm:12,md:8,children:r.jsx(_.Item,{label:"Valor",name:"searchValue",rules:[{required:!0,message:"Digite um valor"}],children:r.jsx(V,{placeholder:"Digite o valor para buscar"})})}),r.jsx(pe,{xs:24,sm:12,md:8,children:r.jsx(_.Item,{label:"Tipo",name:"tipo",initialValue:"todos",children:r.jsx(te,{options:[{label:"Todos",value:"todos"},{label:"Eleitor",value:"eleitor"},{label:"Ativista",value:"ativista"},{label:"Usuário",value:"usuario"}]})})})]}),r.jsxs(me,{gutter:16,children:[r.jsx(pe,{xs:24,sm:12,md:8,children:r.jsx(_.Item,{label:"Data Inicial",name:"dataInicial",children:r.jsx(Z,{style:{width:"100%"}})})}),r.jsx(pe,{xs:24,sm:12,md:8,children:r.jsx(_.Item,{label:"Data Final",name:"dataFinal",children:r.jsx(Z,{style:{width:"100%"}})})}),r.jsx(pe,{xs:24,sm:12,md:8,children:r.jsx(_.Item,{label:"Status",name:"status",initialValue:"todos",children:r.jsx(te,{options:[{label:"Todos",value:"todos"},{label:"Ativo",value:"ativo"},{label:"Inativo",value:"inativo"},{label:"Pendente",value:"pendente"}]})})})]}),r.jsx(_.Item,{children:r.jsxs(B,{children:[r.jsx(M,{type:"primary",htmlType:"submit",icon:r.jsx(he,{}),loading:t,children:"Buscar"}),r.jsx(M,{icon:r.jsx(ge,{}),onClick:()=>{e.resetFields(),o([])},children:"Limpar"}),r.jsx(M,{icon:r.jsx(fe,{}),onClick:()=>{console.log("Exportando resultados...")},disabled:0===n.length,children:"Exportar"})]})})]}),r.jsx(re,{columns:l,dataSource:n,loading:t,pagination:s,rowKey:"id",size:"middle",bordered:!0,className:"ant-table-striped"})]})})};function ra({open:e,initial:t,onCancel:a,onSaved:n}){const[o]=_.useForm(),[s,i]=f.useState([]),l=Ne();f.useEffect(()=>{e&&((async()=>{try{const e=await l.getPerfilSchema();i(e.columns||[])}catch{}})(),t?o.setFieldsValue(t):o.resetFields())},[e,t]);return r.jsx($,{open:e,title:t?.id?"Editar Perfil":"Novo Perfil",onCancel:a,footer:null,destroyOnHidden:!0,children:r.jsxs(_,{form:o,layout:"vertical",children:[s.map(e=>{if("IdPerfil"===e.name)return null;const t=!e.nullable,a=e.type.toLowerCase();if(a.includes("boolean"))return r.jsx(_.Item,{name:e.name,valuePropName:"checked",label:e.name,children:r.jsx(ae,{})},e.name);if(a.includes("date")){const n=a.includes("timestamp");return r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:t}],children:r.jsx(Z,{style:{width:"100%"},showTime:n})},e.name)}return a.includes("int")||a.includes("numeric")?r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:t}],children:r.jsx(ce,{style:{width:"100%"}})},e.name):r.jsx(_.Item,{name:e.name,label:e.name,rules:[{required:t}],children:r.jsx(V,{})},e.name)}),r.jsxs(B,{style:{marginTop:16},children:[r.jsx(M,{onClick:a,children:"Cancelar"}),r.jsx(M,{type:"primary",onClick:async()=>{try{const e=await o.validateFields();t?.IdPerfil?(await l.updatePerfil(t.IdPerfil,e),q.success("Perfil atualizado")):(await l.createPerfil(e),q.success("Perfil criado")),n()}catch{}},children:"Salvar"})]})]})})}function na(){const[e,t]=f.useState([]),[a,n]=f.useState(!1),[o,s]=f.useState(!1),[i,l]=f.useState(null),[c,d]=f.useState([]),[u,p]=f.useState({}),h=Ne(),g=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z",fill:"currentColor"}),r.jsx("path",{d:"M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z",fill:"currentColor"})]}),y=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M6 7h12M9 7v10m6-10v10M4 7h16l-1 14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2L4 7z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),x=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M3 4h6v16H3V4zm12 0h6v16h-6V4z",fill:"currentColor"})}),v=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),b=async()=>{try{n(!0);const e=await h.getPerfilSchema();d(e.columns||[]);const a=await h.listPerfil();t(a.rows||[]);const r={};for(const t of e.columns||[])r[t.name]=!0;p(r)}catch(e){q.error(e?.response?.data?.detail||"Erro ao carregar perfil")}finally{n(!1)}};f.useEffect(()=>{b()},[]);const j={title:"AÇÕES",dataIndex:"__actions__",render:(e,t)=>r.jsxs(B,{children:[r.jsx(M,{type:"text",icon:r.jsx(g,{}),onClick:()=>{l(t),s(!0)}}),r.jsx(M,{type:"text",danger:!0,icon:r.jsx(y,{}),onClick:async()=>{try{if(!t.IdPerfil)return void q.info("REGISTRO SEM ID");await h.deletePerfil(t.IdPerfil),q.success("PERFIL DELETADO"),await b()}catch(e){q.error(e?.response?.data?.detail||"ERRO AO DELETAR PERFIL")}}})]})},w=c.map(t=>{const a=t.name,r=Array.from(new Set((e||[]).map(e=>e[a]).filter(e=>null!=e))).slice(0,20).map(e=>({text:String(e).toUpperCase(),value:String(e).toUpperCase()})),n=(t.type||"").toLowerCase();return{title:a.toUpperCase(),dataIndex:a,filters:r,onFilter:(e,t)=>String(t[a]).toUpperCase()===String(e).toUpperCase(),sorter:(e,t)=>{const r=e[a],o=t[a];return null==r?-1:null==o?1:n.includes("int")||n.includes("numeric")?Number(r)-Number(o):n.includes("date")||n.includes("timestamp")?new Date(r).getTime()-new Date(o).getTime():String(r).toUpperCase().localeCompare(String(o).toUpperCase())},sortDirections:["ascend","descend"],render:e=>"boolean"==typeof e?e?"SIM":"NÃO":null==e?"":String(e).toUpperCase()}}).filter(e=>u[e.dataIndex]).concat([j]),S=r.jsx("div",{style:{padding:12},children:c.map(e=>r.jsx("div",{style:{marginBottom:6},children:r.jsx(ae,{checked:!!u[e.name],onChange:t=>p({...u,[e.name]:t.target.checked}),children:e.name})},e.name))});return r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:r.jsxs(B,{children:[r.jsx(R,{placement:"bottomRight",trigger:["click"],menu:{items:[]},popupRender:()=>S,children:r.jsx(M,{icon:r.jsx(x,{}),children:"COLUNAS"})}),r.jsx(M,{type:"primary",icon:r.jsx(v,{}),onClick:()=>{l(null),s(!0)},children:"NOVO PERFIL"})]})}),r.jsx(re,{loading:a,dataSource:e,columns:w,rowKey:e=>e.IdPerfil||JSON.stringify(e),bordered:!0,size:"middle",className:"ant-table-striped"}),r.jsx(ra,{open:o,initial:i||void 0,onCancel:()=>s(!1),onSaved:async()=>{s(!1),await b()}})]})}function oa({open:e,initial:t,onCancel:a,onSaved:n}){const[o]=_.useForm(),s=Ne(),[i,l]=f.useState([]),{message:c}=W.useApp();f.useEffect(()=>{e&&((async()=>{try{const e=await s.listPerfil();l(e.rows||[])}catch{}})(),t?o.setFieldsValue(t):o.resetFields())},[e,t]);return r.jsx($,{open:e,title:t?.IdFuncao?"Editar Função":"Nova Função",onCancel:a,footer:null,destroyOnHidden:!0,children:r.jsxs(_,{form:o,layout:"vertical",children:[r.jsx(_.Item,{name:"Funcao",label:"Funcao",rules:[{required:!0}],children:r.jsx(V,{})}),r.jsx(_.Item,{name:"Perfil",label:"Perfil",rules:[{required:!0}],children:r.jsx(te,{placeholder:"Selecione um perfil",showSearch:!0,options:(i||[]).map(e=>({label:e.Perfil??e.Nome??e.Descricao??String(e.IdPerfil??""),value:e.Perfil??String(e.IdPerfil??"")})),filterOption:(e,t)=>t?.label?.toLowerCase().includes(e.toLowerCase())})}),r.jsx(_.Item,{name:"Cadastrante",label:"Cadastrante",children:r.jsx(V,{})}),r.jsx(_.Item,{name:"Candidato",label:"Candidato",children:r.jsx(V,{})}),r.jsx(_.Item,{name:"TenantLayer",label:"TenantLayer",children:r.jsx(V,{})}),r.jsx(_.Item,{name:"Ativo",label:"Ativo",valuePropName:"checked",children:r.jsx(se,{})}),r.jsxs(B,{style:{marginTop:16},children:[r.jsx(M,{onClick:a,children:"Cancelar"}),r.jsx(M,{type:"primary",onClick:async()=>{try{const e=await o.validateFields();t?.IdFuncao?(await s.updateFuncao(t.IdFuncao,e),c.success("Função atualizada")):(await s.createFuncao(e),c.success("Função criada")),n()}catch{}},children:"Salvar"})]})]})})}function sa(){const[e,t]=f.useState([]),[a,n]=f.useState(!1),[o,s]=f.useState(!1),[i,l]=f.useState(null),[c,d]=f.useState([]),[u,p]=f.useState({}),h=Ne(),g=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z",fill:"currentColor"}),r.jsx("path",{d:"M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z",fill:"currentColor"})]}),y=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M6 7h12M9 7v10m6-10v10M4 7h16l-1 14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2L4 7z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),x=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M3 4h6v16H3V4zm12 0h6v16h-6V4z",fill:"currentColor"})}),v=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),b=(c||[]).map(e=>({title:e.name,dataIndex:e.name})),j=async()=>{try{n(!0);const e=await h.getFuncoesSchema();d(e.columns||[]);const a=await h.listFuncoes();t(a.rows||[]);const r={};for(const t of e.columns||[])r[t.name]=!0;p(r)}catch(e){q.error(e?.response?.data?.detail||"Erro ao carregar funções")}finally{n(!1)}};f.useEffect(()=>{j()},[]);const w={title:"Ações",key:"actions",render:(e,t)=>r.jsxs(B,{children:[r.jsx(M,{type:"text",icon:r.jsx(g,{}),onClick:()=>{l(t),s(!0)}}),r.jsx(M,{type:"text",danger:!0,icon:r.jsx(y,{}),onClick:async()=>{try{if(!t.IdFuncao)return void q.info("REGISTRO SEM ID");await h.deleteFuncao(t.IdFuncao),q.success("Função deletada"),await j()}catch(e){q.error(e?.response?.data?.detail||"Erro ao deletar função")}}})]})},S=b.filter(e=>u[e.dataIndex]).concat([w]),C=r.jsx("div",{style:{padding:12},children:b.map(e=>r.jsx("div",{style:{marginBottom:6},children:r.jsx(ae,{checked:!!u[e.dataIndex],onChange:t=>p({...u,[e.dataIndex]:t.target.checked}),children:e.title})},e.dataIndex))});return r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:r.jsxs(B,{children:[r.jsx(R,{placement:"bottomRight",trigger:["click"],menu:{items:[]},popupRender:()=>C,children:r.jsx(M,{icon:r.jsx(x,{}),children:"COLUNAS"})}),r.jsx(M,{type:"primary",icon:r.jsx(v,{}),onClick:()=>{l(null),s(!0)},children:"NOVA FUNÇÃO"})]})}),r.jsx(re,{bordered:!0,size:"small",loading:a,columns:S,dataSource:e,rowKey:e=>e.IdFuncao}),r.jsx(oa,{open:o,initial:i,onCancel:()=>s(!1),onSaved:async()=>{s(!1),await j()}})]})}function ia(){const[e]=_.useForm(),[t]=_.useForm(),[n]=_.useForm(),[o,s]=f.useState("DESCONECTADO"),[i,l]=f.useState([]),[c,d]=f.useState([]),[u,p]=f.useState([]),[h,g]=f.useState([]),[y,x]=f.useState(0),[v,b]=f.useState(""),[j,w]=f.useState("DESCONECTADO"),S=Ne(),C=async()=>{try{const{dataset:t,uf:a}=e.getFieldsValue(),r=await S.listarRecursosCkan(t,a);d(r.resources||[]),x(0)}catch(t){try{const{dataset:t,uf:r}=e.getFieldsValue(),n=`https://dadosabertos.tse.jus.br/api/3/action/package_search?q=${encodeURIComponent(t)}`,o=await a.get(n),s=[];for(const e of o.data?.result?.results||[])for(const t of e.resources||[])s.push({id:t.id,name:t.name,format:t.format,url:t.url||t.download_url});let i="AM"===r?s.filter(e=>(e.name||"").toUpperCase().includes("AMAZONAS")||(e.name||"").toUpperCase().endsWith("AM")):s;if(!i.length){const e=["resultados","prestacao","eleicoes","candidatos"];for(const t of e){const e=`https://dadosabertos.tse.jus.br/api/3/action/package_search?q=${encodeURIComponent(t)}`,r=await a.get(e);for(const t of r.data?.result?.results||[])for(const e of t.resources||[]){const t={id:e.id,name:e.name,format:e.format,url:e.url||e.download_url};i.find(e=>e.id===t.id)||i.push(t)}if(i.length)break}"AM"===r&&(i=i.filter(e=>(e.name||"").toUpperCase().includes("AMAZONAS")||(e.name||"").toUpperCase().endsWith("AM")))}d(i),x(0)}catch{}}},I=async()=>{try{const e=c[y]||c[0];if(!e?.url)return void q.info("Nenhum recurso disponível para prévia");const t=await S.previewRecursoCkan(e.url,15);p(t.columns),g(t.rows)}catch(e){try{const e=c[y]||c[0],t=await a.get(e.url),r="string"==typeof t.data?t.data:t.request?.responseText;if(!r)throw new Error("Sem dados");const n=r.split(/\r?\n/).filter(e=>e.trim().length>0);if(n.length<2)throw new Error("CSV vazio");const o=n[0].includes(";")?";":",",s=n[0].split(o).map(e=>e.trim()),i=n.slice(1,Math.min(n.length,16)).map(e=>{const t=e.split(o),a={};return s.forEach((e,r)=>{a[e]=(t[r]??"").trim()}),a});p(s),g(i)}catch(t){q.error(t?.message||"Erro ao carregar prévia")}}};f.useEffect(()=>{(async()=>{await(async()=>{try{const e=localStorage.getItem("municipios_AM");if(e){const t=JSON.parse(e);Array.isArray(t)&&t.length&&l(t)}const t=await S.listarMunicipios("AM");l(t.municipios),localStorage.setItem("municipios_AM",JSON.stringify(t.municipios))}catch(e){try{const e=((await a.get("https://servicodados.ibge.gov.br/api/v1/localidades/estados/13/municipios")).data||[]).map(e=>({id:e.id,nome:e.nome}));l(e),localStorage.setItem("municipios_AM",JSON.stringify(e))}catch{}}})(),await C(),await I();try{const e=await S.getEvolutionApiKeyMasked();b(e.keyMasked||"")}catch{}})()},[]);return r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsx("h1",{className:"page-title",children:"INTEGRAÇÕES"}),r.jsxs(me,{gutter:[16,16],children:[r.jsx(pe,{xs:24,xl:16,children:r.jsx(X,{title:"APIS TSE",extra:r.jsx(H,{color:"blue",children:"AMAZONAS"}),children:r.jsxs(_,{form:e,layout:"vertical",initialValues:{baseUrl:"https://dadosabertos.tse.jus.br",uf:"AM",dataset:"eleitorado_municipio"},children:[r.jsxs(me,{gutter:16,children:[r.jsx(pe,{xs:24,md:12,children:r.jsx(_.Item,{name:"baseUrl",label:"Base URL",children:r.jsx(V,{placeholder:"https://dadosabertos.tse.jus.br"})})}),r.jsx(pe,{xs:24,md:12,children:r.jsx(_.Item,{name:"uf",label:"UF",children:r.jsx(te,{options:[{label:"Amazonas",value:"AM"}]})})})]}),r.jsxs(me,{gutter:16,children:[r.jsx(pe,{xs:24,md:12,children:r.jsx(_.Item,{name:"dataset",label:"Dataset",children:r.jsx(te,{onChange:async()=>{await C(),await I()},options:[{label:"Eleitorado por município",value:"eleitorado_municipio"},{label:"Resultados por município",value:"resultados_municipio"},{label:"Zonas eleitorais",value:"zonas_eleitorais"},{label:"Candidatos",value:"candidatos"}]})})}),r.jsx(pe,{xs:24,md:12,children:r.jsx(_.Item,{name:"municipio",label:"Município (opcional)",children:r.jsx(te,{showSearch:!0,placeholder:"Selecione um município",options:i.map(e=>({label:e.nome,value:e.nome}))})})})]}),r.jsxs(B,{children:[r.jsx(M,{type:"primary",onClick:async()=>{try{s("TESTANDO");const{baseUrl:t,uf:r,dataset:n,municipio:o}=e.getFieldsValue();try{const e=await S.testarIntegracao({base_url:t,uf:r,dataset:n,municipio:o});e.connected?(s("CONECTADO"),q.success("Conexão realizada com sucesso")):(s("DESCONECTADO"),q.error(`Falha na conexão (HTTP ${e.status_code})`))}catch{const e=await a.get(t),r=e.status>=200&&e.status<300;s(r?"CONECTADO":"DESCONECTADO"),q[r?"success":"error"](r?"Conexão realizada com sucesso":`Falha na conexão (HTTP ${e.status})`)}}catch(t){s("DESCONECTADO"),q.error(t?.response?.data?.detail||"Erro ao testar conexão")}},children:"Testar Conexão"}),r.jsx(M,{onClick:async()=>{try{const{baseUrl:a,uf:r,dataset:o,municipio:s}=e.getFieldsValue(),{webhookUrl:i,webhookSecret:l}=t.getFieldsValue(),{tseToken:c,externalApiToken:d}=n.getFieldsValue(),u={base_url:a,uf:r,dataset:o,municipio:s,webhook_url:i,webhook_secret:l,tse_token:c,external_api_token:d,active_webhook:!1};(await S.salvarIntegracaoConfig(u)).saved&&q.success("Configuração salva")}catch(a){try{const{baseUrl:a,uf:r,dataset:o,municipio:s}=e.getFieldsValue(),{webhookUrl:i,webhookSecret:l}=t.getFieldsValue(),{tseToken:c,externalApiToken:d}=n.getFieldsValue(),u={base_url:a,uf:r,dataset:o,municipio:s,webhook_url:i,webhook_secret:l,tse_token:c,external_api_token:d,active_webhook:!1};localStorage.setItem("integracao_cfg",JSON.stringify(u)),q.success("Configuração salva localmente")}catch{q.error(a?.response?.data?.detail||"Erro ao salvar configuração")}}},children:"Salvar Configuração"}),r.jsxs(H,{color:"CONECTADO"===o?"green":"TESTANDO"===o?"blue":"default",children:["STATUS: ",o]}),r.jsx(M,{onClick:async()=>{await C(),await I()},children:"Prévia Dataset (AM)"}),r.jsx(te,{style:{minWidth:240},placeholder:"Selecione recurso",value:c.length?y:void 0,onChange:e=>x(e),options:c.map((e,t)=>({label:e.name||e.url,value:t}))})]})]})})}),r.jsxs(pe,{xs:24,xl:8,children:[r.jsx(X,{title:"Webhooks",children:r.jsxs(_,{form:t,layout:"vertical",children:[r.jsx(_.Item,{name:"webhookUrl",label:"URL",children:r.jsx(V,{placeholder:"https://seu-sistema.com/webhook"})}),r.jsx(_.Item,{name:"webhookSecret",label:"Segredo",children:r.jsx(V,{placeholder:"segredo-opcional"})}),r.jsxs(B,{children:[r.jsx(M,{type:"primary",children:"Salvar"}),r.jsx(se,{checkedChildren:"Ativo",unCheckedChildren:"Inativo"})]})]})}),r.jsx(Y,{}),r.jsx(X,{title:"Tokens / Credenciais",children:r.jsxs(_,{form:n,layout:"vertical",children:[r.jsx(_.Item,{name:"tseToken",label:"Token TSE (se aplicável)",children:r.jsx(V,{placeholder:"insira seu token, se necessário"})}),r.jsx(_.Item,{name:"externalApiToken",label:"Token API Externa",children:r.jsx(V,{placeholder:"token de outros serviços"})}),r.jsx(M,{type:"primary",children:"Salvar"})]})}),r.jsx(Y,{}),r.jsx(X,{title:"Evolution API",children:r.jsxs(_,{layout:"vertical",children:[r.jsx(_.Item,{label:"Chave de Autenticação (mascarada)",children:r.jsx(V,{value:v,readOnly:!0})}),r.jsxs(B,{children:[r.jsx(M,{type:"primary",onClick:async()=>{try{w("TESTANDO");const e=await S.testEvolutionApi(),t=!!e.ok;w(t?"CONECTADO":"DESCONECTADO"),q[t?"success":"error"](t?"Evolution API conectada"+(e.version?` (v${e.version})`:""):`Falha na Evolution API (HTTP ${e.status_code})`)}catch(e){w("DESCONECTADO"),q.error(e?.response?.data?.detail||"Erro ao testar Evolution API")}},children:"Testar Evolution API"}),r.jsxs(H,{color:"CONECTADO"===j?"green":"TESTANDO"===j?"blue":"default",children:["EVOLUTION: ",j]})]})]})}),r.jsx(Y,{}),r.jsx(X,{title:"Prévia do Dataset Selecionado (primeiras linhas)",children:r.jsx(re,{size:"small",bordered:!0,pagination:!1,columns:u.map(e=>({title:e,dataIndex:e})),dataSource:h,rowKey:e=>JSON.stringify(e)})})]})]})]})}function la({open:e,initial:t,onCancel:a,onSaved:n}){const[o]=_.useForm(),s=Ne(),{message:i}=W.useApp(),[l,c]=f.useState([]),[d,u]=f.useState([]);f.useEffect(()=>{t?o.setFieldsValue(t):o.resetFields()},[t,e]),f.useEffect(()=>{(async()=>{try{const e=await s.listCandidatos();c(e.rows||[])}catch{}try{const e=await s.listEleicoes();u(e.rows||[])}catch{}})()},[e]);return r.jsx($,{title:t?"Editar Meta":"Nova Meta",open:e,onCancel:a,onOk:async()=>{try{const e=await o.validateFields(),a=e.DataInicio,r=e.DataFim;if(a&&r&&a.isAfter(r))return void i.error("Data Início deve ser menor ou igual à Data Fim");const l={IdCandidato:e.IdCandidato,Numero:e.Numero,Partido:e.Partido,Cargo:e.Cargo,IdEleicao:e.IdEleicao,DataInicio:e.DataInicio?.format("YYYY-MM-DD HH:mm:ss"),DataFim:e.DataFim?.format("YYYY-MM-DD HH:mm:ss"),MetaVotos:e.MetaVotos,MetaDisparos:e.MetaDisparos,MetaAprovacao:e.MetaAprovacao,MetaRejeicao:e.MetaRejeicao,Ativo:!0};t&&t.IdMeta?await s.updateMeta(Number(t.IdMeta),l):await s.createMeta(l),i.success("Meta salva"),n()}catch(e){i.error(e?.response?.data?.detail||"Erro ao salvar meta")}},okText:"Salvar",children:r.jsxs(_,{layout:"vertical",form:o,children:[r.jsx(B,{style:{marginBottom:8},children:r.jsx(M,{onClick:()=>o.resetFields(),children:"Limpar"})}),r.jsx(_.Item,{name:"IdCandidato",label:"Candidato",rules:[{required:!0}],children:r.jsx(te,{placeholder:"Selecione",options:(l||[]).map(e=>({label:String(e.Nome||e.nome),value:Number(e.IdCandidato||e.idCandidato),extra:e})),onChange:(e,t)=>{const a=t?.extra||{};o.setFieldsValue({Numero:a.Numero||a.numero||void 0,Partido:a.Partido||a.partido||void 0,Cargo:a.Cargo||a.cargo||void 0})}})}),r.jsx(_.Item,{name:"IdEleicao",label:"Eleição",rules:[{required:!0}],children:r.jsx(te,{placeholder:"Selecione",options:(d||[]).map(e=>({label:String(e.Nome||e.nome),value:Number(e.IdEleicao||e.idEleicao)}))})}),r.jsx(_.Item,{name:"Numero",label:"Número",children:r.jsx(ce,{style:{width:"100%"},min:0})}),r.jsx(_.Item,{name:"Partido",label:"Partido",children:r.jsx(V,{})}),r.jsx(_.Item,{name:"Cargo",label:"Cargo",children:r.jsx(V,{})}),r.jsx(_.Item,{name:"DataInicio",label:"Data Início",children:r.jsx(Z,{showTime:!0,style:{width:"100%"}})}),r.jsx(_.Item,{name:"DataFim",label:"Data Fim",rules:[{validator:(e,t)=>{const a=o.getFieldValue("DataInicio");return a&&t&&a.isAfter(t)?Promise.reject(new Error("Data Início deve ser menor ou igual à Data Fim")):Promise.resolve()}}],children:r.jsx(Z,{showTime:!0,style:{width:"100%"}})}),r.jsx(_.Item,{name:"MetaVotos",label:"Meta Votos",children:r.jsx(ce,{style:{width:"100%"},min:0})}),r.jsx(_.Item,{name:"MetaDisparos",label:"Disparos",children:r.jsx(ce,{style:{width:"100%"},min:0})}),r.jsx(_.Item,{name:"MetaAprovacao",label:"Aprovação",children:r.jsx(ce,{style:{width:"100%"},min:0})}),r.jsx(_.Item,{name:"MetaRejeicao",label:"Rejeição",children:r.jsx(ce,{style:{width:"100%"},min:0})}),r.jsx(_.Item,{label:"Imagem (opcional)",children:r.jsx(ye,{beforeUpload:async e=>String(e.type||"").startsWith("image/")?e.size>2097152&&(i.error("Imagem acima de 2MB"),ye.LIST_IGNORE):(i.error("Apenas imagens são permitidas"),ye.LIST_IGNORE),maxCount:1,accept:"image/*",children:r.jsx(M,{icon:r.jsx(xe,{}),children:"Selecionar imagem"})})})]})})}function ca(){const e=Ne(),{user:t}=vt(),{message:a}=W.useApp(),[n,o]=f.useState([]),[s,i]=f.useState(!1),[l,c]=f.useState(!1),[d,u]=f.useState(null),[p,h]=f.useState([]),[g,y]=f.useState({}),[x,v]=f.useState([]),b=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M3 4h6v16H3V4zm12 0h6v16h-6V4z",fill:"currentColor"})}),j=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),w=async()=>{try{i(!0);const a=(await e.listMetas()).rows||[];let r=[],n=[];try{r=(await e.listCandidatos()).rows||[]}catch{}try{n=(await e.listEleicoes()).rows||[]}catch{}const s=new Map;for(const e of r){const t=Number(e.IdCandidato??e.idCandidato??e.Id??e.ID),a=String(e.Nome??e.nome??"");isNaN(t)||s.set(t,a)}const l=new Map;for(const e of n){const t=Number(e.IdEleicao??e.idEleicao??e.Id??e.ID),a=String(e.Nome??e.nome??"");isNaN(t)||l.set(t,a)}const c=a.map(e=>{const t=Number(e.IdCandidato??e.idCandidato),a=Number(e.IdEleicao??e.idEleicao),r=s.get(t)||(e.CandidatoNome??""),n=l.get(a)||(e.EleicaoNome??""),o=Number(e.VotosAtual??e.votosAtual??0),i=Number(e.MetaVotos??0),c=i>0?Math.min(100,Math.round(o/i*100)):0;return{...e,Candidato:r,Eleicao:n,ProgressoVotos:c}});o(c);const d=["IdMeta","Candidato","Numero","Partido","Cargo","Eleicao","DataInicio","DataFim","MetaVotos","ProgressoVotos","MetaDisparos","MetaAprovacao","MetaRejeicao","TenantLayer"],u=e=>{const t=c.find(t=>void 0!==t[e]&&null!==t[e]),a=typeof(t?t[e]:"");return"number"===a?"int":"boolean"===a?"bool":String(e).toLowerCase().includes("data")?"timestamp":"text"},m=Array.from(new Set(c.flatMap(e=>Object.keys(e)))),p={};for(const e of m)p[e]={name:e,type:u(e),nullable:!0};const g=d.filter(e=>p[e]).map(e=>p[e]),f=m.filter(e=>!d.includes(e)).map(e=>p[e]);h([...g,...f]);const x={};for(const e of d)p[e]&&(x[e]=!0);for(const e of f)x[e.name]=!1;const b=`metas.columns.visible.${t?.usuario||"default"}`,j=localStorage.getItem(b);y(j?JSON.parse(j):x);const w=`metas.columns.order.${t?.usuario||"default"}`,S=localStorage.getItem(w);v(S?JSON.parse(S):d.filter(e=>p[e]))}catch(r){a.error(r?.response?.data?.detail||"Erro ao carregar metas")}finally{i(!1)}};f.useEffect(()=>{w()},[]);const S=p.map(e=>{const a=e.name,r=Array.from(new Set((n||[]).map(e=>e[a]).filter(e=>null!=e))).slice(0,20).map(e=>({text:Array.isArray(e)?String(e.join(", ")).toUpperCase():String(e).toUpperCase(),value:Array.isArray(e)?String(e.join(", ")).toUpperCase():String(e).toUpperCase()})),o=(e.type||"").toLowerCase(),s=new Set(["IdMeta","Numero","MetaVotos","ProgressoVotos","MetaDisparos","MetaAprovacao","MetaRejeicao","DataInicio","DataFim","TenantLayer"]),i={title:{IdMeta:"ID",Candidato:"CANDIDATO",Numero:"NÚMERO",Partido:"PARTIDO",Cargo:"CARGO",Eleicao:"ELEIÇÃO",DataInicio:"DATA INÍCIO",DataFim:"DATA FIM",MetaVotos:"META VOTOS",ProgressoVotos:"PROGRESSO (%)",MetaDisparos:"DISPAROS",MetaAprovacao:"APROVAÇÃO",MetaRejeicao:"REJEIÇÃO",TenantLayer:"TENANT LAYER"}[a]||a.toUpperCase(),dataIndex:a,align:s.has(a)?"center":"left",filters:r,onFilter:(e,t)=>String(t[a]).toUpperCase()===String(e).toUpperCase(),sorter:(e,t)=>{const r=e[a],n=t[a];if(null==r)return-1;if(null==n)return 1;if(Array.isArray(r)||Array.isArray(n)){const e=Array.isArray(r)?r.join(", "):String(r),t=Array.isArray(n)?n.join(", "):String(n);return e.toUpperCase().localeCompare(t.toUpperCase())}return o.includes("int")||o.includes("numeric")?Number(r)-Number(n):o.includes("date")||o.includes("timestamp")?new Date(r).getTime()-new Date(n).getTime():String(r).toUpperCase().localeCompare(String(n).toUpperCase())},sortDirections:["ascend","descend"],render:e=>{if("boolean"==typeof e)return e?"SIM":"NÃO";if(null==e)return"";if(Array.isArray(e))return e.map(e=>String(e).toUpperCase()).join(" | ");if(o.includes("date")||o.includes("timestamp")){const t=new Date(e);if(!isNaN(t.getTime()))return t.toLocaleString("pt-BR",{hour12:!1})}return"ProgressoVotos"===a?`${Number(e||0)}%`:String(e).toUpperCase()},onHeaderCell:()=>({draggable:!0,onDragStart:e=>{e.dataTransfer.setData("text/plain",a)},onDragOver:e=>{e.preventDefault()},onDrop:e=>{const r=e.dataTransfer.getData("text/plain"),n=a;r&&r!==n&&v(e=>{const a=e.filter(e=>e!==r),o=a.indexOf(n);if(-1===o)return e;a.splice(o,0,r);const s=`metas.columns.order.${t?.usuario||"default"}`;return localStorage.setItem(s,JSON.stringify(a)),a})}})};return"IdMeta"===a&&(i.defaultSortOrder="ascend"),i}),C={title:"AÇÕES",dataIndex:"__actions__",render:(t,n)=>r.jsxs(B,{children:[r.jsx(M,{type:"text",title:"EDITAR",onClick:()=>{u(n),c(!0)},children:"EDITAR"}),r.jsx(M,{type:"text",danger:!0,title:"DELETAR",onClick:async()=>{try{if(!n.IdMeta)return void a.info("REGISTRO SEM ID");await e.deleteMeta(n.IdMeta),a.success("META DELETADA"),await w()}catch(t){a.error(t?.response?.data?.detail||"ERRO AO DELETAR META")}}})]})},I=(x.length?x:S.map(e=>e.dataIndex)).map(e=>S.find(t=>t.dataIndex===e)).filter(Boolean).filter(e=>g[e.dataIndex]).concat([C]),A=r.jsx("div",{style:{padding:12},children:p.map(e=>r.jsx("div",{style:{marginBottom:6},children:r.jsx(ae,{checked:!!g[e.name],onChange:a=>{const r={...g,[e.name]:a.target.checked};y(r);const n=`metas.columns.visible.${t?.usuario||"default"}`;localStorage.setItem(n,JSON.stringify(r))},children:e.name.toUpperCase()})},e.name))});return r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:r.jsxs(B,{children:[r.jsx(R,{placement:"bottomRight",trigger:["click"],menu:{items:[]},popupRender:()=>A,children:r.jsx(M,{shape:"circle",icon:r.jsx(b,{}),style:{background:"#FFD700",borderColor:"#FFD700",color:"#000"},title:"VISUALIZAÇÃO DE COLUNAS"})}),r.jsx(M,{shape:"circle",icon:r.jsx(j,{}),style:{background:"#FFD700",borderColor:"#FFD700",color:"#000"},onClick:()=>{u(null),c(!0)},title:"NOVA META"})]})}),r.jsx("style",{children:"\n        .metas-table .ant-table-thead > tr > th{ background:#FFD700; color:#000; font-family: 'Arimo', Arial, sans-serif; }\n        .metas-table .ant-table-thead > tr > th .ant-table-column-title{ display:flex; justify-content:center; align-items:center; text-align:center; }\n        .metas-table .ant-table-tbody > tr > td{ font-family: 'Roboto Condensed', Arial, sans-serif; padding:2px 6px; line-height:0.95; height:22px; }\n      "}),r.jsx(re,{loading:s,dataSource:n,columns:I,rowKey:e=>e.IdMeta??e.id??JSON.stringify(e),bordered:!0,size:"small",className:"ant-table-striped metas-table",scroll:{y:520},locale:{emptyText:"Nenhuma meta cadastrada"}}),r.jsx(la,{open:l,initial:d||void 0,onCancel:()=>c(!1),onSaved:async()=>{c(!1),await w()}})]})}function da(){const e=Ne(),{message:t}=W.useApp(),[a,n]=f.useState(!1),[o,s]=f.useState([]),[i,l]=f.useState(!1),[c]=_.useForm(),d=async()=>{try{n(!0);const t=await e.listEleicoes();s(t.rows||[])}catch{t.error("Erro ao carregar eleições")}finally{n(!1)}};f.useEffect(()=>{d()},[]);return r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[r.jsx("h3",{style:{margin:0},children:"ELEIÇÕES"}),r.jsx(B,{children:r.jsx(M,{type:"primary",onClick:()=>l(!0),children:"NOVA ELEIÇÃO"})})]}),r.jsx(X,{children:r.jsx(re,{loading:a,dataSource:o,columns:[{title:"Id",dataIndex:"IdEleicao",key:"IdEleicao",width:80},{title:"Nome",dataIndex:"Nome",key:"Nome"},{title:"Ano",dataIndex:"Ano",key:"Ano",width:100},{title:"Turno",dataIndex:"Turno",key:"Turno",width:100},{title:"Cargo",dataIndex:"Cargo",key:"Cargo",width:160},{title:"Início",dataIndex:"DataInicio",key:"DataInicio",width:160},{title:"Fim",dataIndex:"DataFim",key:"DataFim",width:160},{title:"Ativo",dataIndex:"Ativo",key:"Ativo",width:100}],rowKey:e=>e.IdEleicao??JSON.stringify(e),pagination:{pageSize:10},scroll:{y:480},locale:{emptyText:"Nenhuma eleição"}})}),r.jsx($,{title:"Nova Eleição",open:i,onCancel:()=>l(!1),onOk:async()=>{try{const a=await c.validateFields(),r={...a,Ativo:!!a.Ativo},n=await e.createEleicao(r);n&&n.id&&(t.success("Eleição criada"),l(!1),c.resetFields(),d())}catch{}},okText:"Salvar",children:r.jsxs(_,{layout:"vertical",form:c,children:[r.jsx(_.Item,{name:"Nome",label:"Nome",rules:[{required:!0}],children:r.jsx(V,{})}),r.jsx(_.Item,{name:"Ano",label:"Ano",children:r.jsx(V,{type:"number"})}),r.jsx(_.Item,{name:"Turno",label:"Turno",children:r.jsx(V,{type:"number"})}),r.jsx(_.Item,{name:"Cargo",label:"Cargo",children:r.jsx(V,{})}),r.jsx(_.Item,{name:"DataInicio",label:"Data Início",children:r.jsx(V,{placeholder:"YYYY-MM-DD HH:mm:ss"})}),r.jsx(_.Item,{name:"DataFim",label:"Data Fim",children:r.jsx(V,{placeholder:"YYYY-MM-DD HH:mm:ss"})}),r.jsx(_.Item,{name:"Ativo",label:"Ativo",valuePropName:"checked",children:r.jsx(se,{})})]})})]})}function ua(){const e=Ne(),{message:t}=W.useApp(),[a,n]=f.useState(!1),[o,s]=f.useState([]),[i,l]=f.useState(!1),[c]=_.useForm(),[d,u]=f.useState(""),p=async()=>{try{n(!0);const t=await e.listCandidatos();s(t.rows||[])}catch{t.error("Erro ao carregar candidatos")}finally{n(!1)}};f.useEffect(()=>{p()},[]);const h=[{title:"Id",dataIndex:"IdCandidato",key:"IdCandidato",width:80},{title:"Nome",dataIndex:"Nome",key:"Nome"},{title:"Numero",dataIndex:"Numero",key:"Numero",width:120},{title:"Partido",dataIndex:"Partido",key:"Partido",width:160},{title:"Cargo",dataIndex:"Cargo",key:"Cargo",width:160},{title:"Foto",dataIndex:"Foto",key:"Foto",render:e=>e?r.jsx(ve,{src:e,width:48,fallback:""}):r.jsx("span",{style:{color:"#999"},children:"Sem foto"}),width:120}];return r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[r.jsx("h3",{style:{margin:0},children:"CANDIDATOS"}),r.jsx(B,{children:r.jsx(M,{type:"primary",onClick:()=>l(!0),children:"NOVO CANDIDATO"})})]}),r.jsx(X,{children:r.jsx(re,{loading:a,dataSource:o,columns:h,rowKey:e=>e.IdCandidato??JSON.stringify(e),pagination:{pageSize:10},scroll:{y:480},locale:{emptyText:"Nenhum candidato"}})}),r.jsx($,{title:"Novo Candidato",open:i,onCancel:()=>l(!1),onOk:async()=>{try{const a={...await c.validateFields(),Foto:d},r=await e.createCandidato(a);r&&r.id&&(t.success("Candidato criado"),l(!1),c.resetFields(),u(""),p())}catch{}},okText:"Salvar",children:r.jsxs(_,{layout:"vertical",form:c,children:[r.jsx(_.Item,{name:"Nome",label:"Nome",rules:[{required:!0}],children:r.jsx(V,{})}),r.jsx(_.Item,{name:"Numero",label:"Número",children:r.jsx(V,{type:"number"})}),r.jsx(_.Item,{name:"Partido",label:"Partido",children:r.jsx(V,{})}),r.jsx(_.Item,{name:"Cargo",label:"Cargo",children:r.jsx(V,{})}),r.jsxs(_.Item,{label:"Foto",children:[r.jsx(ye,{beforeUpload:async e=>{if(!String(e.type||"").startsWith("image/"))return t.error("Apenas imagens são permitidas"),ye.LIST_IGNORE;if(e.size>2097152)return t.error("Imagem acima de 2MB"),ye.LIST_IGNORE;const a=new FileReader;return a.onload=()=>{const e=String(a.result||"");u(e)},a.readAsDataURL(e),!1},maxCount:1,accept:"image/*",children:r.jsx(M,{icon:r.jsx(xe,{}),children:"Selecionar imagem"})}),d&&r.jsx("div",{style:{marginTop:8},children:r.jsx(ve,{src:d,width:96})})]})]})})]})}const ma=f.lazy(()=>ft(()=>import("./Disparos-BY_e1a6j.js"),__vite__mapDeps([0,1,2,3]))),pa=f.lazy(()=>ft(()=>import("./Campanha-2pxynhbc.js"),__vite__mapDeps([4,1,2,3]))),ha=f.lazy(()=>ft(()=>import("./Dashboard-CocegMTM.js"),__vite__mapDeps([5,1,2,3]))),ga=f.lazy(()=>ft(()=>import("./Estatisticas-9DkqdTPw.js"),__vite__mapDeps([6,1,2,3]))),fa=f.lazy(()=>ft(()=>import("./Tenants-esovPh8J.js"),__vite__mapDeps([7,1,2,3]))),{Content:ya}=I;function xa(){const{isAuthenticated:e}=vt(),t=v(),a=("undefined"!=typeof window?localStorage.getItem("rootTenantSlug"):null)||"captar",n="1"===("undefined"!=typeof window?localStorage.getItem("adminContext"):null)||"captar"===String(a).toLowerCase();return r.jsx(p,{mode:"wait",children:r.jsx(m.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.25},children:r.jsxs(w,{location:t,children:[r.jsx(S,{path:"/login",element:r.jsx(Jt,{})}),r.jsx(S,{path:"/",element:e?r.jsx(f.Suspense,{fallback:r.jsx("div",{style:{padding:24},children:"Carregando..."}),children:r.jsx(ha,{})}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"/eleitores",element:e?r.jsx(Kt,{}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"/ativistas",element:e?r.jsx(Zt,{}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"/usuarios",element:e?r.jsx(ea,{}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"/perfil",element:e?r.jsx(na,{}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"/funcoes",element:e?r.jsx(sa,{}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"/permissoes",element:e?r.jsx(ta,{}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"/estatisticas",element:e?r.jsx(f.Suspense,{fallback:r.jsx("div",{style:{padding:24},children:"Carregando..."}),children:r.jsx(ga,{})}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"/consultas",element:e?r.jsx(aa,{}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"/automacao/disparos",element:e?r.jsx(f.Suspense,{fallback:r.jsx("div",{style:{padding:24},children:"Carregando..."}),children:r.jsx(ma,{})}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"/automacao/campanha",element:e?r.jsx(f.Suspense,{fallback:r.jsx("div",{style:{padding:24},children:"Carregando..."}),children:r.jsx(pa,{})}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"/integracoes",element:e?r.jsx(ia,{}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"/parametros/metas",element:e?r.jsx(ca,{}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"/parametros/tenants",element:e&&n?r.jsx(f.Suspense,{fallback:r.jsx("div",{style:{padding:24},children:"Carregando..."}),children:r.jsx(fa,{})}):r.jsx(C,{to:"/"})}),r.jsx(S,{path:"/parametros/eleicoes",element:e?r.jsx(f.Suspense,{fallback:r.jsx("div",{style:{padding:24},children:"Carregando..."}),children:r.jsx(da,{})}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"/parametros/candidatos",element:e?r.jsx(f.Suspense,{fallback:r.jsx("div",{style:{padding:24},children:"Carregando..."}),children:r.jsx(ua,{})}):r.jsx(C,{to:"/login"})}),r.jsx(S,{path:"*",element:r.jsx(C,{to:"/"})})]})},t.pathname)})}function va(){const{isAuthenticated:e}=vt();return r.jsxs(j,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[e&&r.jsx(At,{}),r.jsx(qt,{richColors:!0}),r.jsx(W,{children:r.jsx(I,{children:r.jsx(ya,{className:"app-content",children:r.jsx(xa,{})})})})]})}Ce.createRoot(document.getElementById("root")).render(r.jsx(y.StrictMode,{children:r.jsx(be,{locale:ht,theme:{algorithm:je.defaultAlgorithm,token:{colorPrimary:"#667eea",borderRadius:10,fontSize:15,colorBgContainer:"#ffffff"},components:{Table:{headerBg:"#f5f7fa",headerColor:"#1f1f1f",borderRadius:8,rowHoverBg:"#e6f4ff"},Card:{borderRadiusLG:14},Button:{borderRadius:10}}},children:r.jsx(W,{children:r.jsx(Ee,{children:r.jsx(va,{})})})})}));export{bt as L,vt as a,Ae as b,Ct as p,Ft as t,Ne as u};
