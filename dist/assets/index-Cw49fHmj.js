const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-D61JVGhE.js","assets/utils-CdldNp8C.js","assets/react-vendor-qiAl16-a.js","assets/ui-vendor-CnmmTMy8.js","assets/Estatisticas-ZH3CH1il.js","assets/Tenants-vbvpcdq3.js","assets/TenantParametros-C4cJGTSr.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,a,r)=>((t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r)(t,"symbol"!=typeof a?a+"":a,r);import{a,j as r,p as s,i as n,c as i,b as o,d as l,e as c,f as d,g as u,m,A as p}from"./utils-CdldNp8C.js";import{f as h,g,r as f,R as x,u as y,h as j,B as v,i as S,j as b,N as w}from"./react-vendor-qiAl16-a.js";import{L as C,R as I,a as A,b as T,c as P,d as k,e as U,M as E,D as N,B as O,A as F,f as D,g as R,F as L,h as M,I as _,i as $,S as z,T as V,j as q,s as B,k as W,l as H,m as Y,P as J,n as K,o as X,C as G,p as Q,q as Z,r as ee,t as te,u as ae,v as re,w as se,x as ne,y as ie,z as oe,E as le,G as ce,H as de,J as ue,K as me,N as pe,O as he,Q as ge,U as fe,V as xe}from"./ui-vendor-CnmmTMy8.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var ye,je={};const ve=g(function(){if(ye)return je;ye=1;var e=h();return je.createRoot=e.createRoot,je.hydrateRoot=e.hydrateRoot,je}()),Se="/api";const be=new class{constructor(){t(this,"api"),this.api=a.create({baseURL:Se,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(e=>{const t=localStorage.getItem("token");t&&(e.headers.Authorization=`Bearer ${t}`);const a=String(e.url||"").includes("/auth/login"),r=!(!e.headers||!e.headers["X-Tenant"]);if(a)!r&&e.headers&&delete e.headers["X-Tenant"];else{const t=localStorage.getItem("tenantSlug")||"captar";e.headers["X-Tenant"]=t}return e}),this.api.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)))}async login(e){const t=async t=>{const a=t??"captar",r=a?{headers:{"X-Tenant":a}}:{},s=(await this.api.post("/auth/login",e,r)).data,n=String((s?.tenantSlug??s?.tenant??s?.slug??s?.TenantSlug??s?.Tenant)||a);localStorage.setItem("tenantSlug",n);try{const e=await this.listTenants(),t=(e.rows||[]).find(e=>String(e.Slug??e.slug).toUpperCase()===n.toUpperCase()),a=t?String(t.Nome??t.nome):n;localStorage.setItem("tenantName",a)}catch{}if(s&&s.token&&!s.user){const e={id:s.id,nome:s.nome,funcao:s.funcao,usuario:s.usuario,email:s.email,cpf:s.cpf,perfil:s.funcao};return{token:s.token,user:e}}return s};try{return await t()}catch(a){try{return await t("captar")}catch(r){try{const e=await this.listTenants().catch(()=>({rows:[]})),a=(e.rows||[]).map(e=>String(e.Slug??e.slug??"")).filter(Boolean);for(const r of a)try{return await t(r)}catch{}}catch{}throw a}}}async healthDb(){try{return(await this.api.get("/health/db")).data}catch(e){try{return{ok:!!(await this.api.get("/health")).data}}catch(t){try{const e=a.create({baseURL:"http://localhost:8000",headers:{"Content-Type":"application/json"}});return(await e.get("/api/health/db")).data}catch(r){const e=a.create({baseURL:"http://localhost:8000",headers:{"Content-Type":"application/json"}});return{ok:!!(await e.get("/health")).data}}}}}async logout(){await this.api.post("/auth/logout")}async getCurrentUser(){return(await this.api.get("/auth/me")).data}async getPermissoes(){return(await this.api.get("/permissoes")).data}async getPermissao(e){return(await this.api.get(`/permissoes/${e}`)).data}async updatePermissao(e,t){return(await this.api.put(`/permissoes/${e}`,t)).data}async createPermissao(e){return(await this.api.post("/permissoes",e)).data}async deletePermissao(e){return(await this.api.delete(`/permissoes/${e}`)).data}async getPerfilSchema(){try{return(await this.api.get("/perfil/schema")).data}catch(e){const t=a.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"}});return(await t.get("/perfil/schema")).data}}async listPerfil(){const e=(localStorage.getItem("tenantSlug")||"captar").toLowerCase(),t=await this.api.get("/perfil").then(e=>e.data).catch(async()=>{const e=a.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"}});return(await e.get("/perfil")).data});if("captar"===e)return t;const r={"Content-Type":"application/json","X-Tenant":"captar"},s=localStorage.getItem("token");s&&(r.Authorization=`Bearer ${s}`);const n=a.create({baseURL:Se,headers:r}),i=await n.get("/perfil").then(e=>e.data).catch(async()=>{const e=a.create({baseURL:"http://localhost:8000/api",headers:r});return(await e.get("/perfil")).data}),o=t.rows||[],l=i.rows||[],c={};for(const a of[...l,...o]){const e=String(a.Perfil??a.perfil??a.Descricao??a.descricao??"").toUpperCase();c[e]||(c[e]=a)}return{rows:Object.values(c),columns:t.columns||i.columns||[]}}async createPerfil(e){try{return(await this.api.post("/perfil",e)).data}catch(t){const r=a.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"}});return(await r.post("/perfil",e)).data}}async updatePerfil(e,t){try{return(await this.api.put(`/perfil/${e}`,t)).data}catch(r){const s=a.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"}});return(await s.put(`/perfil/${e}`,t)).data}}async deletePerfil(e){try{return(await this.api.delete(`/perfil/${e}`)).data}catch(t){const r=a.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"}});return(await r.delete(`/perfil/${e}`)).data}}async getFuncoesSchema(){return(await this.api.get("/funcoes/schema")).data}async listFuncoes(){const e=(localStorage.getItem("tenantSlug")||"captar").toLowerCase(),t=await this.api.get("/funcoes").then(e=>e.data).catch(async()=>{const e=a.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"}});return(await e.get("/funcoes")).data});if("captar"===e)return t;const r={"Content-Type":"application/json","X-Tenant":"captar"},s=localStorage.getItem("token");s&&(r.Authorization=`Bearer ${s}`);const n=a.create({baseURL:Se,headers:r}),i=await n.get("/funcoes").then(e=>e.data).catch(async()=>{const e=a.create({baseURL:"http://localhost:8000/api",headers:r});return(await e.get("/funcoes")).data}),o=t.rows||[],l=i.rows||[],c={};for(const a of[...l,...o]){const e=String(a.Funcao??a.funcao??a.Descricao??a.descricao??"").toUpperCase();c[e]||(c[e]=a)}return{rows:Object.values(c),columns:t.columns||i.columns||[]}}async createFuncao(e){return(await this.api.post("/funcoes",e)).data}async updateFuncao(e,t){return(await this.api.put(`/funcoes/${e}`,t)).data}async deleteFuncao(e){return(await this.api.delete(`/funcoes/${e}`)).data}async applyFilter(e){return(await this.api.post("/filtros/aplicar",e)).data}async exportExcel(e){return(await this.api.post("/export/excel",{tabela:e},{responseType:"blob"})).data}async exportPdf(e){return(await this.api.post("/export/pdf",{tabela:e},{responseType:"blob"})).data}async exportData(e,t){try{const a="excel"===t?await this.exportExcel(e):await this.exportPdf(e),r=window.URL.createObjectURL(new Blob([a])),s=document.createElement("a");s.href=r,s.setAttribute("download",`${e}.${"excel"===t?"xlsx":"pdf"}`),document.body.appendChild(s),s.click(),s.parentNode?.removeChild(s)}catch(a){throw a}}async getAuditLogs(e=0,t=100){return(await this.api.get("/audit-logs",{params:{skip:e,limit:t}})).data}async createAuditLog(e){return(await this.api.post("/audit-logs",e)).data}async getAuditLogsByUser(e){return(await this.api.get(`/audit-logs/usuario/${e}`)).data}async importCsv(e){const t=new FormData;t.append("file",e);return(await this.api.post("/import/csv",t,{headers:{"Content-Type":"multipart/form-data"}})).data}async getNotificacoes(e){return(await this.api.get(`/notificacoes/${e}`)).data}async createNotificacao(e){return(await this.api.post("/notificacoes",e)).data}async marcarNotificacaoLida(e){return(await this.api.put(`/notificacoes/${e}/marcar-lida`)).data}async getEleitores(){return(await this.api.get("/eleitores")).data}async createEleitor(e){return(await this.api.post("/eleitores",e)).data}async updateEleitor(e,t){return(await this.api.put(`/eleitores/${e}`,t)).data}async deleteEleitor(e){return(await this.api.delete(`/eleitores/${e}`)).data}async getAtivistas(){return(await this.api.get("/ativistas")).data}async getUsuariosSchema(){try{return(await this.api.get("/usuarios/schema")).data}catch(e){const t=a.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"}});return(await t.get("/usuarios/schema")).data}}async listUsuarios(){const e=async()=>{try{const e=localStorage.getItem("tenantSlug")||"captar",t=localStorage.getItem("tenantName")||"",a=(await this.listTenants()).rows||[],r=a.find(e=>String(e.Nome??e.nome).toUpperCase()===String(t).toUpperCase()),s=a.find(t=>String(t.Slug??t.slug)===e),n=r||s;return{id:n?.IdTenant??n?.id,nome:n?.Nome??n?.nome,slug:e}}catch{return{slug:localStorage.getItem("tenantSlug")||"captar",nome:localStorage.getItem("tenantName")||""}}};try{const t=(await this.api.get("/usuarios")).data,a=await e();if("captar"!==(a.slug||"").toLowerCase()){return{rows:(t.rows||[]).filter(e=>Number(e.IdTenant??e.idTenant)===Number(a.id)),columns:t.columns||[]}}return t}catch(t){const r=a.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"}}),s=(await r.get("/usuarios")).data,n=await e();if("captar"!==(n.slug||"").toLowerCase()){return{rows:(s.rows||[]).filter(e=>Number(e.IdTenant??e.idTenant)===Number(n.id)),columns:s.columns||[]}}return s}}async createUsuario(e){try{return(await this.api.post("/usuarios",e)).data}catch(t){const r=a.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"}});return(await r.post("/usuarios",e)).data}}async updateUsuario(e,t){try{return(await this.api.put(`/usuarios/${e}`,t)).data}catch(r){const s=a.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"}});return(await s.put(`/usuarios/${e}`,t)).data}}async uploadUsuarioFoto(e,t){const a=new FormData;t.file&&a.append("file",t.file),t.data_url&&a.append("data_url",t.data_url);return(await this.api.post(`/usuarios/${e}/foto`,a,{headers:{"Content-Type":"multipart/form-data"}})).data}async deleteUsuario(e){try{return(await this.api.delete(`/usuarios/${e}`)).data}catch(t){const r=a.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"}});return(await r.delete(`/usuarios/${e}`)).data}}async getDashboardStats(){const e=(await this.api.get("/dashboard/stats")).data||{};try{if("captar"!==(localStorage.getItem("tenantSlug")||"captar").toLowerCase()){const t=await this.listUsuarios();e.total_usuarios=(t.rows||[]).length}}catch{}return e}async getTopAtivistas(){return(await this.api.get("/dashboard/top-ativistas")).data}async getTopUsuarios(){return(await this.api.get("/dashboard/top-usuarios")).data}async getTopSupervisores(){return(await this.api.get("/dashboard/top-supervisores")).data}async getTopCoordenadores(){return(await this.api.get("/dashboard/top-coordenadores")).data}async getTopBairros(){return(await this.api.get("/dashboard/top-bairros")).data}async getTopZonas(){return(await this.api.get("/dashboard/top-zonas")).data}async listCoordenadores(){return{rows:((await this.listUsuarios()).rows||[]).filter(e=>"COORDENADOR"===String(e.Funcao||e.funcao).toUpperCase().trim()||"ADMINISTRADOR"===String(e.Funcao||e.funcao).toUpperCase().trim())}}async listSupervisores(e){return{rows:((await this.listUsuarios()).rows||[]).filter(t=>"SUPERVISOR"===String(t.Funcao||t.funcao).toUpperCase().trim()&&String(t.Coordenador||t.coordenador).trim()===String(e).trim())}}async getTenantsSchema(){return(await this.api.get("/tenants/schema")).data}async listTenants(){return(await this.api.get("/tenants")).data}async createTenant(e){return(await this.api.post("/tenants",e)).data}async updateTenant(e,t){return(await this.api.put(`/tenants/${e}`,t)).data}async deleteTenant(e){return(await this.api.delete(`/tenants/${e}`)).data}async listTenantParametros(e){return(await this.api.get(`/tenant-parametros/${e}`)).data}async createTenantParametro(e,t){return(await this.api.post(`/tenant-parametros/${e}`,t)).data}async updateTenantParametro(e,t,a){return(await this.api.put(`/tenant-parametros/${e}/${t}`,a)).data}async deleteTenantParametro(e,t){return(await this.api.delete(`/tenant-parametros/${e}/${t}`)).data}async testarIntegracao(e){return(await this.api.post("/integracoes/testar",e)).data}async salvarIntegracaoConfig(e){return(await this.api.post("/integracoes/config",e)).data}async obterIntegracaoConfig(){return(await this.api.get("/integracoes/config")).data}async listarMunicipios(e){return(await this.api.get(`/integracoes/municipios/${e}`)).data}async listarRecursosCkan(e,t){return(await this.api.post("/integracoes/ckan/resources",{dataset:e,uf:t})).data}async previewRecursoCkan(e,t=15){return(await this.api.post("/integracoes/ckan/preview",{resource_url:e,limit:t})).data}},we=f.createContext(be);function Ce({children:e}){const t=f.useMemo(()=>{const e=new Map,t=(e,t)=>`${("undefined"!=typeof window?localStorage.getItem("tenantSlug"):null)||"captar"}:${e}:${JSON.stringify(t)}`,a=be,r={listTenants:a.listTenants.bind(be),listUsuarios:a.listUsuarios.bind(be),listPerfil:a.listPerfil.bind(be),listFuncoes:a.listFuncoes.bind(be),createUsuario:a.createUsuario.bind(be),updateUsuario:a.updateUsuario.bind(be),deleteUsuario:a.deleteUsuario.bind(be),uploadUsuarioFoto:a.uploadUsuarioFoto.bind(be)};return a.listTenants=async()=>{const a=t("listTenants",[]);if(e.has(a))return e.get(a);const s=await r.listTenants();return e.set(a,s),s},a.listUsuarios=async()=>{const a=t("listUsuarios",[]);if(e.has(a))return e.get(a);const s=await r.listUsuarios();return e.set(a,s),s},a.listPerfil=async()=>{const a=t("listPerfil",[]);if(e.has(a))return e.get(a);const s=await r.listPerfil();return e.set(a,s),s},a.listFuncoes=async()=>{const a=t("listFuncoes",[]);if(e.has(a))return e.get(a);const s=await r.listFuncoes();return e.set(a,s),s},a.createUsuario=async t=>{const a=await r.createUsuario(t);return e.clear(),a},a.updateUsuario=async(t,a)=>{const s=await r.updateUsuario(t,a);return e.clear(),s},a.deleteUsuario=async t=>{const a=await r.deleteUsuario(t);return e.clear(),a},a.uploadUsuarioFoto=async(t,a)=>{const s=await r.uploadUsuarioFoto(t,a);return e.clear(),s},be},[]);return r.jsx(we.Provider,{value:t,children:e})}function Ie(){return f.useContext(we)}var Ae,Te={},Pe={exports:{}};function ke(){return Ae||(Ae=1,(e=Pe).exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports),Pe.exports;var e}var Ue,Ee={};var Ne,Oe={},Fe={},De={},Re={exports:{}},Le={exports:{}},Me={exports:{}},_e={exports:{}};function $e(){return Ne||(Ne=1,function(e){function t(a){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(a)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(_e)),_e.exports}var ze,Ve,qe,Be,We={exports:{}};function He(){return Ve||(Ve=1,e=Me,t=$e().default,a=function(){return ze||(ze=1,e=We,t=$e().default,e.exports=function(e,a){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,a||"default");if("object"!=t(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports),We.exports;var e,t}(),e.exports=function(e){var r=a(e,"string");return"symbol"==t(r)?r:r+""},e.exports.__esModule=!0,e.exports.default=e.exports),Me.exports;var e,t,a}function Ye(){return Be||(Be=1,function(e){var t=function(){return qe||(qe=1,e=Le,t=He(),e.exports=function(e,a,r){return(a=t(a))in e?Object.defineProperty(e,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[a]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports),Le.exports;var e,t}();function a(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}e.exports=function(e){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?a(Object(s),!0).forEach(function(a){t(e,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports}(Re)),Re.exports}var Je,Ke,Xe={};function Ge(){if(Ke)return De;Ke=1;var e=ke().default;Object.defineProperty(De,"__esModule",{value:!0}),De.default=void 0;var t=e(Ye()),a=(Je||(Je=1,Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.commonLocale=void 0,Xe.commonLocale={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0}),Xe),r=(0,t.default)((0,t.default)({},a.commonLocale),{},{locale:"pt_BR",today:"Hoje",now:"Agora",backToToday:"Voltar para hoje",ok:"OK",clear:"Limpar",week:"Semana",month:"M√™s",year:"Ano",timeSelect:"Selecionar hora",dateSelect:"Selecionar data",monthSelect:"Escolher m√™s",yearSelect:"Escolher ano",decadeSelect:"Escolher d√©cada",dateFormat:"D/M/YYYY",dateTimeFormat:"D/M/YYYY HH:mm:ss",monthBeforeYear:!1,previousMonth:"M√™s anterior (PageUp)",nextMonth:"Pr√≥ximo m√™s (PageDown)",previousYear:"Ano anterior (Control + esquerda)",nextYear:"Pr√≥ximo ano (Control + direita)",previousDecade:"D√©cada anterior",nextDecade:"Pr√≥xima d√©cada",previousCentury:"S√©culo anterior",nextCentury:"Pr√≥ximo s√©culo",shortWeekDays:["Dom","Seg","Ter","Qua","Qui","Sex","S√°b"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]});return De.default=r,De}var Qe,Ze,et,tt,at,rt,st={};function nt(){if(Qe)return st;Qe=1,Object.defineProperty(st,"__esModule",{value:!0}),st.default=void 0;return st.default={placeholder:"Hora",rangePlaceholder:["Hora de in√≠cio","Hora de t√©rmino"]},st}function it(){if(Ze)return Fe;Ze=1;var e=ke().default;Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.default=void 0;var t=e(Ge()),a=e(nt());const r={lang:Object.assign({placeholder:"Selecionar data",rangePlaceholder:["Data inicial","Data final"]},t.default),timePickerLocale:Object.assign({},a.default)};return Fe.default=r,Fe}function ot(){if(et)return Oe;et=1;var e=ke().default;Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.default=void 0;var t=e(it());return Oe.default=t.default,Oe}function lt(){if(tt)return Te;tt=1;var e=ke().default;Object.defineProperty(Te,"__esModule",{value:!0}),Te.default=void 0;var t=e((Ue||(Ue=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.default=void 0,Ee.default={items_per_page:"/ p√°gina",jump_to:"V√° at√©",jump_to_confirm:"confirme",page:"P√°gina",prev_page:"P√°gina anterior",next_page:"Pr√≥xima p√°gina",prev_5:"5 p√°ginas anteriores",next_5:"5 pr√≥ximas p√°ginas",prev_3:"3 p√°ginas anteriores",next_3:"3 pr√≥ximas p√°ginas",page_size:"tamanho da p√°gina"}),Ee)),a=e(ot()),r=e(it()),s=e(nt());const n="${label} n√£o √© um ${type} v√°lido",i={locale:"pt-br",Pagination:t.default,DatePicker:r.default,TimePicker:s.default,Calendar:a.default,global:{placeholder:"Por favor escolha",close:"Fechar"},Table:{filterTitle:"Menu de Filtro",filterConfirm:"OK",filterReset:"Resetar",filterEmptyText:"Sem filtros",filterCheckAll:"Selecionar todos os itens",filterSearchPlaceholder:"Pesquisar nos filtros",emptyText:"Sem conte√∫do",selectAll:"Selecionar p√°gina atual",selectInvert:"Inverter sele√ß√£o",selectNone:"Apagar todo o conte√∫do",selectionAll:"Selecionar todo o conte√∫do",sortTitle:"Ordenar t√≠tulo",expand:"Expandir linha",collapse:"Colapsar linha",triggerDesc:"Clique organiza por descendente",triggerAsc:"Clique organiza por ascendente",cancelSort:"Clique para cancelar organiza√ß√£o"},Tour:{Next:"Pr√≥ximo",Previous:"Anterior",Finish:"Finalizar"},Modal:{okText:"OK",cancelText:"Cancelar",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancelar"},Transfer:{titles:["",""],searchPlaceholder:"Procurar",itemUnit:"item",itemsUnit:"items",remove:"Remover",selectCurrent:"Selecionar p√°gina atual",removeCurrent:"Remover p√°gina atual",selectAll:"Selecionar todos",removeAll:"Remover todos",selectInvert:"Inverter sele√ß√£o atual"},Upload:{uploading:"Enviando...",removeFile:"Remover arquivo",uploadError:"Erro no envio",previewFile:"Visualizar arquivo",downloadFile:"Baixar arquivo"},Empty:{description:"N√£o h√° dados"},Icon:{icon:"√≠cone"},Text:{edit:"editar",copy:"copiar",copied:"copiado",expand:"expandir"},Form:{optional:"(opcional)",defaultValidateMessages:{default:"Erro ${label} na valida√ß√£o de campo",required:"Por favor, insira ${label}",enum:"${label} deve ser um dos seguinte: [${enum}]",whitespace:"${label} n√£o pode ser um car√°cter vazio",date:{format:" O formato de data ${label} √© inv√°lido",parse:"${label} n√£o pode ser convertido para uma data",invalid:"${label} √© uma data inv√°lida"},types:{string:n,method:n,array:n,object:n,number:n,date:n,boolean:n,integer:n,float:n,regexp:n,email:n,url:n,hex:n},string:{len:"${label} deve possuir ${len} caracteres",min:"${label} deve possuir ao menos ${min} caracteres",max:"${label} deve possuir no m√°ximo ${max} caracteres",range:"${label} deve possuir entre ${min} e ${max} caracteres"},number:{len:"${label} deve ser igual √† ${len}",min:"O valor m√≠nimo de ${label} √© ${min}",max:"O valor m√°ximo de ${label} √© ${max}",range:"${label} deve estar entre ${min} e ${max}"},array:{len:"Deve ser ${len} ${label}",min:"No m√≠nimo ${min} ${label}",max:"No m√°ximo ${max} ${label}",range:"A quantidade de ${label} deve estar entre ${min} e ${max}"},pattern:{mismatch:"${label} n√£o se encaixa no padr√£o ${pattern}"}}},Image:{preview:"Pr√©-visualiza√ß√£o"}};return Te.default=i,Te}function ct(){return rt?at:(rt=1,at=lt())}const dt=g(ct()),ut={},mt=function(e,t,a){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),s=a?.nonce||a?.getAttribute("nonce");r=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in ut)return;ut[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,s&&r.setAttribute("nonce",s),document.head.appendChild(r),t?new Promise((t,a)=>{r.addEventListener("load",t),r.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})},pt=localStorage.getItem("user");let ht=null;if(pt)try{const e=JSON.parse(pt);if(e&&e.login_time){const t=s(e.login_time);if(n(t))ht=e;else{const t=new Date(e.login_time);n(t)?e.login_time=t.toISOString():e.login_time=(new Date).toISOString(),localStorage.setItem("user",JSON.stringify(e)),ht=e}}else ht=e}catch{ht=null,localStorage.removeItem("user")}const gt=i(e=>({user:ht,token:localStorage.getItem("token"),isLoading:!1,isAuthenticated:!!localStorage.getItem("token"),setUser:t=>{t?localStorage.setItem("user",JSON.stringify(t)):localStorage.removeItem("user"),e({user:t})},setToken:t=>{t?localStorage.setItem("token",t):localStorage.removeItem("token"),e({token:t,isAuthenticated:!!t})},setIsLoading:t=>e({isLoading:t}),logout:()=>{localStorage.removeItem("user"),localStorage.removeItem("token"),e({user:null,token:null,isAuthenticated:!1})},login:(t,a)=>{localStorage.setItem("user",JSON.stringify(t)),localStorage.setItem("token",a),e({user:t,token:a,isAuthenticated:!0})}})),ft="/assets/CAPTAR%20LOGO%20OFICIAL-DwGQlJkk.jpg",xt={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 m√™s",other:"cerca de {{count}} meses"},xMonths:{one:"1 m√™s",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},yt={date:o({formats:{full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},defaultWidth:"full"}),time:o({formats:{full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},defaultWidth:"full"}),dateTime:o({formats:{full:"{{date}} '√†s' {{time}}",long:"{{date}} '√†s' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},jt={lastWeek:e=>{const t=e.getDay();return"'"+(0===t||6===t?"√∫ltimo":"√∫ltima")+"' eeee '√†s' p"},yesterday:"'ontem √†s' p",today:"'hoje √†s' p",tomorrow:"'amanh√£ √†s' p",nextWeek:"eeee '√†s' p",other:"P"},vt={code:"pt-BR",formatDistance:(e,t,a)=>{let r;const s=xt[e];return r="string"==typeof s?s:1===t?s.one:s.other.replace("{{count}}",String(t)),a?.addSuffix?a.comparison&&a.comparison>0?"em "+r:"h√° "+r:r},formatLong:yt,formatRelative:(e,t,a,r)=>{const s=jt[e];return"function"==typeof s?s(t):s},localize:{ordinalNumber:(e,t)=>{const a=Number(e);return"week"===t?.unit?a+"¬™":a+"¬∫"},era:l({values:{narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},defaultWidth:"wide"}),quarter:l({values:{narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1¬∫ trimestre","2¬∫ trimestre","3¬∫ trimestre","4¬∫ trimestre"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:l({values:{narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","mar√ßo","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},defaultWidth:"wide"}),day:l({values:{narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","ter√ßa","quarta","quinta","sexta","s√°bado"],wide:["domingo","segunda-feira","ter√ßa-feira","quarta-feira","quinta-feira","sexta-feira","s√°bado"]},defaultWidth:"wide"}),dayPeriod:l({values:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh√£",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh√£",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh√£",afternoon:"tarde",evening:"tarde",night:"noite"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh√£",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh√£",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh√£",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:d({matchPattern:/^(\d+)[¬∫¬™o]?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:c({matchPatterns:{narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},defaultParseWidth:"any"}),quarter:c({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](¬∫)? trimestre/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:c({matchPatterns:{narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|mar√ßo|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},defaultParseWidth:"any"}),day:c({matchPatterns:{narrow:/^(dom|[23456]¬™?|s[a√°]b)/i,short:/^(dom|[23456]¬™?|s[a√°]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a√°]b)/i,wide:/^(domingo|(segunda|ter[c√ß]a|quarta|quinta|sexta)([- ]feira)?|s[a√°]bado)/i},defaultMatchWidth:"wide",parsePatterns:{short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a√°]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a√°]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a√°]b/i]},defaultParseWidth:"any"}),dayPeriod:c({matchPatterns:{narrow:/^(a|p|mn|md|(da) (manh√£|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh√£|tarde|noite))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh√£/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},{Header:St}=C;const bt=x.memo(function(){const e=y(),t=j(),{user:a,logout:i}=gt(),o=Ie(),l=("undefined"!=typeof window?localStorage.getItem("tenantSlug"):null)||"captar",[c,d]=f.useState(localStorage.getItem("tenantName")||"");if(f.useEffect(()=>{const e=localStorage.getItem("tenantSlug")||"captar";(async()=>{try{const t=await o.listTenants(),a=(t.rows||[]).find(t=>String(t.Slug??t.slug).toUpperCase()===String(e).toUpperCase()),r=a?String(a.Nome??a.nome):e;d(r);try{localStorage.setItem("tenantName",r)}catch{}}catch{d(e)}})()},[o]),!a)return null;const p=f.useMemo(()=>{const e=a?.login_time;if(!e)return null;const t=s(e);if(n(t))return t;const r=new Date(e);return isNaN(r.getTime())?null:r},[a?.login_time]),h=p?u(p,"dd/MM/yyyy HH:mm",{locale:vt}):"",[g,x]=f.useState("");f.useEffect(()=>{const e=()=>{if(!p)return void x("");const e=Date.now()-p.getTime(),t=Math.floor(e/36e5),a=Math.floor(e%36e5/6e4),r=Math.floor(e%6e4/1e3),s=String(t).padStart(2,"0"),n=String(a).padStart(2,"0"),i=String(r).padStart(2,"0");x(`${s}:${n}:${i}`)};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[p]);const v=[{key:"logout",label:"LOGOUT",icon:r.jsx(R,{}),onClick:()=>{i(),e("/login")}}],S=[{key:"/",icon:r.jsx(I,{}),label:"DASHBOARD",onClick:()=>e("/")},{key:"cadastros",icon:r.jsx(A,{}),label:"CADASTROS",children:[{key:"/eleitores",icon:r.jsx(A,{}),label:"ELEITORES",onClick:()=>e("/eleitores")},{key:"/ativistas",icon:r.jsx(T,{}),label:"ATIVISTAS",onClick:()=>e("/ativistas")}]},{key:"/estatisticas",icon:r.jsx(P,{}),label:"ESTAT√çSTICAS",onClick:()=>e("/estatisticas")},{key:"/consultas",icon:r.jsx(P,{}),label:"CONSULTAS",onClick:()=>e("/consultas")},{key:"sistema",icon:r.jsx(U,{}),label:"SISTEMA",children:[{key:"/usuarios",icon:r.jsx(P,{}),label:"USU√ÅRIOS",onClick:()=>e("/usuarios")},{key:"/perfil",icon:r.jsx(A,{}),label:"PERFIL",onClick:()=>e("/perfil")},{key:"/funcoes",icon:r.jsx(A,{}),label:"FUN√á√ïES",onClick:()=>e("/funcoes")},{key:"/permissoes",icon:r.jsx(P,{}),label:"PERMISS√ïES",onClick:()=>e("/permissoes")},{key:"/integracoes",icon:r.jsx(k,{}),label:"INTEGRA√á√ïES",onClick:()=>e("/integracoes")}]},{key:"parametros",icon:r.jsx(P,{}),label:"PAR√ÇMETROS",children:(()=>{const t=[{key:"/parametros/metas",icon:r.jsx(P,{}),label:"METAS",onClick:()=>e("/parametros/metas")},{key:"/parametros/tenants",icon:r.jsx(P,{}),label:"TENANTS",onClick:()=>e("/parametros/tenants")},{key:"/parametros/tenant-parametros",icon:r.jsx(P,{}),label:"TENANT PAR√ÇMETROS",onClick:()=>e("/parametros/tenant-parametros")}];return"captar"!==String(l).toLowerCase()?t.filter(e=>"/parametros/tenants"!==e.key&&"/parametros/tenant-parametros"!==e.key):t})()}];return r.jsx(St,{className:"navbar",children:r.jsxs("div",{className:"navbar-container",children:[r.jsxs("div",{className:"navbar-logo",style:{height:"100%",display:"flex",alignItems:"center"},children:[r.jsx("img",{src:ft,alt:"CAPTAR",style:{height:110,backgroundColor:"#ffffff",borderRadius:8,padding:6}}),r.jsxs("span",{style:{marginLeft:12,fontSize:12,color:"#666",letterSpacing:".3px"},children:["TENANT: ",r.jsx("strong",{style:{color:"#333"},children:String(c||l).toUpperCase()})]})]}),r.jsx(m.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},transition:{duration:.4},children:r.jsx(E,{mode:"horizontal",selectedKeys:[t.pathname],items:S,className:"navbar-menu"})}),r.jsxs("div",{className:"navbar-content",children:[r.jsx("div",{className:"navbar-user-info",children:r.jsxs("div",{className:"user-details",children:[r.jsx("p",{className:"user-name",children:a.nome}),r.jsxs("p",{className:"user-meta",children:["Fun√ß√£o: ",r.jsx("strong",{children:a.funcao})," | Perfil: ",r.jsx("strong",{children:a.perfil})]}),r.jsxs("p",{className:"user-login-time",children:["LOGIN: ",h," | TEMPO CONECTADO: ",g]})]})}),r.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:r.jsx(N,{menu:{items:v},trigger:["click"],children:r.jsxs(O,{type:"text",className:"user-menu-button",children:[r.jsx(F,{icon:r.jsx(A,{}),size:"large"}),r.jsx(D,{})]})})})]})]})})}),wt="/assets/CAPTAR%20LOGIN-My8ZjooI.png";function Ct(){const e=y(),{login:t}=gt(),[a,s]=f.useState(!1),[n,i]=f.useState(null),[o]=L.useForm(),l=Ie(),[c,d]=f.useState(null),u=async a=>{s(!0);try{if(a.acesso_direto){try{localStorage.setItem("tenantSlug","captar")}catch{}const a={id:9999,nome:"USU√ÅRIO TEMPOR√ÅRIO",funcao:"ADMINISTRADOR",usuario:"admin",email:"admin@example.com",cpf:"000.000.000-00",perfil:"ADMINISTRADOR",login_time:(new Date).toISOString()};return t(a,"temp-token-dev"),B.success("Acesso direto ativado!"),void e("/")}const r=await l.login({usuario:a.usuario,senha:a.senha}),s={...r.user,login_time:(new Date).toISOString()};t(s,r.token),B.success("Login realizado com sucesso!"),e("/")}catch(r){B.error(r.response?.data?.detail||"Usu√°rio ou senha inv√°lidos")}finally{s(!1)}};return f.useEffect(()=>{const e=wt,t=new Image;t.crossOrigin="anonymous",t.onload=()=>{const a=t.naturalWidth||512,r=t.naturalHeight||512,s=document.createElement("canvas");s.width=a,s.height=r;const n=s.getContext("2d");if(!n)return void d(e);n.drawImage(t,0,0,a,r);const i=n.getImageData(0,0,a,r),o=i.data;for(let e=0;e<o.length;e+=4){const t=o[e],a=o[e+1],r=o[e+2],s=Math.max(t,a,r),n=Math.min(t,a,r);s>230&&n>210&&(o[e+3]=0)}n.putImageData(i,0,0),d(s.toDataURL("image/png"))},t.src=e},[]),r.jsx("div",{style:{minHeight:"100vh"},children:r.jsx(M,{open:!0,centered:!0,footer:null,closable:!1,maskClosable:!1,width:520,destroyOnHidden:!0,className:"login-modal",children:r.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:16},children:[r.jsx("style",{children:".login-modal .ant-modal-content{ border-radius:0 !important; box-shadow:none !important; border:none !important; } .login-modal .ant-modal-header{ border-bottom:none !important; }"}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("img",{src:c||wt,alt:"CAPTAR",style:{width:400,height:"auto",maxWidth:"90%"}})}),r.jsxs(L,{form:o,onFinish:u,layout:"vertical",className:"login-form",style:{width:"100%"},children:[r.jsx(L.Item,{name:"usuario",getValueFromEvent:e=>(e?.target?.value||"").toUpperCase(),rules:[{required:!0,message:"Por favor, insira seu usu√°rio"},{min:3,message:"Usu√°rio deve ter pelo menos 3 caracteres"}],children:r.jsx(_,{prefix:r.jsx(A,{}),placeholder:"Usu√°rio",size:"large",autoComplete:"username",style:{textTransform:"uppercase"}})}),r.jsx(L.Item,{name:"senha",rules:[{required:!0,message:"Por favor, insira sua senha"},{min:3,message:"Senha deve ter pelo menos 3 caracteres"}],children:r.jsx(_.Password,{prefix:r.jsx($,{}),placeholder:"Senha",size:"large",autoComplete:"current-password"})}),r.jsx(L.Item,{children:r.jsx(O,{type:"primary",htmlType:"submit",size:"large",block:!0,loading:a,className:"login-button",children:"ENTRAR"})})]}),r.jsxs(z,{style:{width:"100%",justifyContent:"space-between",marginTop:8},children:[r.jsxs("div",{children:[r.jsx("span",{children:"Status BD: "}),null===n&&r.jsx(V,{children:"?"}),!0===n&&r.jsx(V,{color:"green",children:"OK"}),!1===n&&r.jsx(V,{color:"red",children:"FALHA"})]}),r.jsx(O,{size:"small",onClick:async()=>{try{const e=await l.healthDb();i(!!e?.ok),e?.ok&&B.success("Conex√£o com banco OK")}catch(e){i(!1),B.error(e?.response?.data?.detail||"Falha ao conectar no banco")}},children:"Testar conex√£o"})]}),r.jsx(q,{children:"OU"}),r.jsx(O,{type:"dashed",size:"large",block:!0,loading:a,className:"dev-button",onClick:()=>{u({usuario:"",senha:"",acesso_direto:!0})},children:"üîß Acesso Direto (Desenvolvedor)"}),r.jsxs("div",{className:"login-footer",children:[r.jsx("p",{children:"CAPTAR ¬© 2025 - Sistema de Capta√ß√£o Eleitoral"}),r.jsx("p",{className:"version",children:"v2.0 - React + TypeScript + Vite"})]})]})})})}function It(){const[e,t]=f.useState([]),[a,s]=f.useState(!1),[n,i]=f.useState(!1),[o]=L.useForm(),[l,c]=f.useState(null),d=Ie(),u=e=>{const t=(e||"").replace(/\D/g,"").slice(0,11);return t.length<=2?`(${t}`:t.length<=7?`(${t.slice(0,2)}) ${t.slice(2)}`:`(${t.slice(0,2)}) ${t.slice(2,7)}-${t.slice(7)}`};f.useEffect(()=>{p()},[]);const p=async()=>{try{s(!0);const e=await d.getEleitores();t(e)}catch(e){B.error("Erro ao carregar eleitores")}finally{s(!1)}},h=[{title:"ID",dataIndex:"id",key:"id"},{title:"Nome",dataIndex:"nome",key:"nome"},{title:"CPF",dataIndex:"cpf",key:"cpf"},{title:"Celular",dataIndex:"celular",key:"celular",render:e=>u(String(e||""))},{title:"Bairro",dataIndex:"bairro",key:"bairro"},{title:"A√ß√µes",key:"actions",render:(e,t)=>r.jsxs(z,{children:[r.jsx(O,{type:"primary",size:"small",icon:r.jsx(Y,{}),onClick:()=>(e=>{c(e.id),o.setFieldsValue(e),i(!0)})(t)}),r.jsx(J,{title:"Confirmar exclus√£o",description:"Tem certeza que deseja deletar este eleitor?",onConfirm:()=>(async e=>{try{await d.deleteEleitor(e),B.success("Eleitor deletado com sucesso"),p()}catch(t){B.error("Erro ao deletar eleitor")}})(t.id),okText:"Sim",cancelText:"N√£o",children:r.jsx(O,{type:"primary",danger:!0,size:"small",icon:r.jsx(K,{})})})]})}];return r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsx("div",{className:"page-actions",children:r.jsx(O,{type:"primary",icon:r.jsx(W,{}),onClick:()=>{c(null),o.resetFields(),i(!0)},children:"NOVO ELEITOR"})}),r.jsx(H,{columns:h,dataSource:e,loading:a,rowKey:"id",pagination:{pageSize:10}}),r.jsx(M,{title:l?"EDITAR ELEITOR":"NOVO ELEITOR",open:n,onOk:()=>o.submit(),onCancel:()=>i(!1),children:r.jsxs(L,{form:o,layout:"vertical",onFinish:async e=>{try{l?(await d.updateEleitor(l,e),B.success("Eleitor atualizado com sucesso")):(await d.createEleitor(e),B.success("Eleitor criado com sucesso")),i(!1),p()}catch(t){B.error("Erro ao salvar eleitor")}},children:[r.jsx(L.Item,{name:"nome",label:"Nome",rules:[{required:!0}],children:r.jsx(_,{})}),r.jsx(L.Item,{name:"cpf",label:"CPF",rules:[{required:!0}],children:r.jsx(_,{})}),r.jsx(L.Item,{name:"celular",label:"Celular",children:r.jsx(_,{maxLength:15,onChange:e=>{const t=u(e.target.value);o.setFieldsValue({celular:t})}})}),r.jsx(L.Item,{name:"bairro",label:"Bairro",children:r.jsx(_,{})})]})})]})}function At(){return r.jsx(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:r.jsx("p",{children:"P√°gina de gerenciamento de ativistas"})})}function Tt({open:e,initial:t,onCancel:a,onSaved:i}){const[o]=L.useForm(),[l,c]=f.useState([]),[d,m]=f.useState([]),[p,h]=f.useState([]),[g,x]=f.useState([]),[y,j]=f.useState({}),[v,S]=f.useState({}),[b,w]=f.useState([]),[C,I]=f.useState([]),[T,P]=f.useState({}),[k,U]=f.useState({}),[E,N]=f.useState([]),D=Ie(),R=f.useRef(null),[V,q]=f.useState(null),[B,W]=f.useState(void 0),{user:H}=gt(),Y=f.useMemo(()=>{const e=H?.login_time;if(!e)return null;const t=s(e);if(n(t))return t;const a=new Date(e);return isNaN(a.getTime())?null:a},[H]),[J,K]=f.useState(""),X=Y?u(Y,"dd/MM/yyyy HH:mm",{locale:vt}):"",ue=String(localStorage.getItem("tenantSlug")||"captar"),me=String(localStorage.getItem("tenantName")||"CAPTAR");f.useEffect(()=>{const e=()=>{if(!Y)return void K("");const e=Date.now()-Y.getTime(),t=Math.floor(e/36e5),a=Math.floor(e%36e5/6e4),r=Math.floor(e%6e4/1e3),s=String(t).padStart(2,"0"),n=String(a).padStart(2,"0"),i=String(r).padStart(2,"0");K(`${s}:${n}:${i}`)};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[Y]);const pe=e=>{const t=e?.target?.value;return"string"==typeof t?t.toUpperCase():t},he=e=>{const t=e?.target?.value;return"string"==typeof t?t.toLowerCase():t};f.useEffect(()=>{if(e){(async()=>{try{const e=(await D.getUsuariosSchema()).columns||[],t=new Set(e.map(e=>e.name)),a=["Coordenador","Supervisor","Ativista"].filter(e=>!t.has(e)).map(e=>({name:e,type:"varchar",nullable:!0}));c([...e,...a]),m(e.map(e=>e.name))}catch{}})(),(async()=>{try{const e=(await D.listPerfil()).rows||[],t=e.map(e=>({label:e.Perfil??e.perfil,value:String(e.Perfil??e.perfil)})),a={};for(const r of e){const e=r.Perfil??r.perfil,t=r.IdPerfil??r.id??r.Id??r.ID;void 0!==e&&void 0!==t&&(a[String(e)]=Number(t))}h(t),j(a)}catch{}})(),(async()=>{try{const e=(await D.listFuncoes()).rows||[],t=e.map(e=>({label:e.Funcao??e.Descricao??"",value:String(e.Funcao??e.Descricao??"")})),a={};for(const r of e){const e=r.Funcao??r.Descricao??"",t=r.IdFuncao??r.id??r.Id??r.ID;void 0!==e&&void 0!==t&&(a[String(e)]=Number(t))}x(t),S(a)}catch{}})(),(async()=>{try{const e=(await D.listCoordenadores()).rows||[];w(e.map(e=>({label:e.Nome??e.nome,value:String(e.Nome??e.nome)})));const t={};for(const a of e){const e=a.Nome??a.nome,r=String(a.TenantLayer??a.NomeTenant??a.nomeTenant??"CAPTAR");void 0!==e&&(t[String(e)]=r)}P(t)}catch{}})(),(async()=>{try{const e=((await D.listTenants()).rows||[]).map(e=>({label:e.Nome??e.nome,value:String(e.Nome??e.nome),slug:e.Slug??e.slug}));N(e);const a=localStorage.getItem("tenantSlug")||"captar",r=e.find(e=>(e.slug||"").toLowerCase()===a.toLowerCase());r&&!t&&o.setFieldValue("TenantLayer",r.value)}catch{}})(),t?o.setFieldsValue(t):o.resetFields();try{const e=o.getFieldValue("ImagemUploadDataUrl");W(e||t?.Imagem)}catch{}}},[e,t]);const ge=L.useWatch("Funcao",o),fe=L.useWatch("Coordenador",o),xe=L.useWatch("TenantLayer",o);f.useEffect(()=>{const e=String(ge||"").toUpperCase().trim();"ADMINISTRADOR"===e||"COORDENADOR"===e?(o.setFieldValue("Coordenador",o.getFieldValue("Nome")),o.setFieldValue("Supervisor","NAO SE APLICA"),o.setFieldValue("Ativista","NAO SE APLICA")):"SUPERVISOR"===e&&(o.setFieldValue("Supervisor",o.getFieldValue("Nome")),o.setFieldValue("Ativista","NAO SE APLICA"))},[ge]),f.useEffect(()=>{const e=String(ge||"").toUpperCase().trim();"SUPERVISOR"!==e&&"ATIVISTA"!==e||!fe?I([]):(async()=>{try{const e=(await D.listSupervisores(String(fe))).rows||[];I(e.map(e=>({label:e.Nome??e.nome,value:String(e.Nome??e.nome)})));const t={};for(const a of e){const e=a.Nome??a.nome,r=String(a.TenantLayer??a.NomeTenant??a.nomeTenant??"CAPTAR");void 0!==e&&(t[String(e)]=r)}U(t)}catch{}})()},[fe,ge]);const ye=e=>{const a=new Set(["DataCadastro","Cadastrante","DataUpdate","TipoUpdate","CadastranteUpdate","UltimoAcesso","TokenRecuperacao","TokenExpiracao","Candidato","UsuarioUpdate","IdTenant"]);if("IdUsuario"===e.name)return null;if("IdPerfil"===e.name)return null;if("IdTenant"===e.name)return null;if(a.has(e.name))return null;const s=!e.nullable,n=e.type.toLowerCase();if("Perfil"===e.name)return r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:s}],children:r.jsx(te,{options:p,optionFilterProp:"label",showSearch:!0,style:{borderRadius:8},suffixIcon:r.jsx(ae,{})})},e.name);if("TenantLayer"===e.name){const a=!!!t?.IdUsuario;return r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:!0}],children:r.jsx(te,{options:E,optionFilterProp:"label",showSearch:!0,style:{borderRadius:8},disabled:a})},e.name)}if("Funcao"===e.name)return r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:s}],children:r.jsx(te,{options:g,optionFilterProp:"label",showSearch:!0,style:{borderRadius:8},suffixIcon:r.jsx(re,{})})},e.name);if("Coordenador"===e.name){const t=String(ge||"").toUpperCase().trim(),a="ADMINISTRADOR"===t||"COORDENADOR"===t,s=String(xe||"").trim(),n=s&&"CAPTAR"!==s.toUpperCase()?b.filter(e=>String(T[e.value]||"").toUpperCase()===s.toUpperCase()):b;return r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:"ADMINISTRADOR"!==t&&"COORDENADOR"!==t}],children:r.jsx(te,{options:n,optionFilterProp:"label",showSearch:!0,style:{borderRadius:8},disabled:a})},e.name)}if("Supervisor"===e.name){const t=String(ge||"").toUpperCase().trim(),a="ADMINISTRADOR"===t||"COORDENADOR"===t,s="ATIVISTA"===t,n=String(xe||"").trim(),i=n&&"CAPTAR"!==n.toUpperCase()?C.filter(e=>String(k[e.value]||"").toUpperCase()===n.toUpperCase()):C;return r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:s}],children:r.jsx(te,{options:i,optionFilterProp:"label",showSearch:!0,style:{borderRadius:8},disabled:a})},e.name)}if("Ativista"===e.name)return r.jsx(L.Item,{name:e.name,label:e.name,children:r.jsx(_,{style:{borderRadius:8},disabled:!0})},e.name);if("Senha"===e.name)return r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:s}],children:r.jsx(_.Password,{style:{borderRadius:8},prefix:r.jsx($,{})})},e.name);if(n.includes("boolean"))return r.jsx(L.Item,{name:e.name,valuePropName:"checked",label:e.name,children:r.jsx(se,{})},e.name);if(n.includes("date")){const t=n.includes("timestamp");return r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:s}],children:r.jsx(ne,{style:{width:"100%",borderRadius:8},showTime:t})},e.name)}return n.includes("int")||n.includes("numeric")?r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:s}],children:r.jsx(ie,{style:{width:"100%",borderRadius:8}})},e.name):"Celular"===e.name?r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:s}],children:r.jsx(_,{style:{borderRadius:8},prefix:r.jsx(oe,{}),maxLength:15,onChange:t=>{const a=(e=>{const t=(e||"").replace(/\D/g,"").slice(0,11);if(t.length<=2)return`(${t}`;const a=t.slice(0,2),r=t.slice(2),s="9"===r[0]?r:"9"+r,n=s.slice(0,5),i=s.slice(5,9);return n?i?`(${a}) ${n}-${i}`:`(${a}) ${n}`:`(${a})`})(t.target.value);o.setFieldsValue({[e.name]:a})}})},e.name):"Nome"===e.name?r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:s}],getValueFromEvent:pe,children:r.jsx(_,{style:{borderRadius:8},prefix:r.jsx(A,{}),maxLength:"number"==typeof e.maxLength?e.maxLength:void 0})},e.name):"CPF"===e.name?r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:s}],children:r.jsx(_,{style:{borderRadius:8},prefix:r.jsx(le,{}),maxLength:"number"==typeof e.maxLength?e.maxLength:14,onChange:t=>{const a=(e=>{const t=(e||"").replace(/\D/g,"").slice(0,11),a=t.slice(0,3),r=t.slice(3,6),s=t.slice(6,9),n=t.slice(9,11);let i=a;return r&&(i+=`.${r}`),s&&(i+=`.${s}`),n&&(i+=`-${n}`),i})(t.target.value);o.setFieldsValue({[e.name]:a})}})},e.name):"Email"===e.name?r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:s}],getValueFromEvent:he,children:r.jsx(_,{style:{borderRadius:8},prefix:r.jsx(ce,{}),maxLength:"number"==typeof e.maxLength?e.maxLength:void 0})},e.name):"Usuario"===e.name?r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:s}],getValueFromEvent:pe,children:r.jsx(_,{style:{borderRadius:8},prefix:r.jsx(de,{}),maxLength:"number"==typeof e.maxLength?e.maxLength:void 0})},e.name):"Imagem"===e.name?null:r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:s}],getValueFromEvent:pe,children:r.jsx(_,{style:{borderRadius:8},maxLength:"number"==typeof e.maxLength?e.maxLength:void 0})},e.name)};return r.jsxs(M,{open:e,title:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{className:"navbar-logo",style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("img",{src:ft,alt:"CAPTAR",style:{height:110,backgroundColor:"#ffffff",borderRadius:8,padding:6}}),r.jsxs("div",{style:{fontSize:12},children:["TENANT: ",r.jsx("strong",{style:{color:"#333"},children:String(me||ue).toUpperCase()})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsxs("div",{style:{textAlign:"right"},children:[r.jsx("div",{style:{fontWeight:700},children:H?.usuario?String(H?.usuario).toUpperCase():String(H?.nome||"").toUpperCase()||"USU√ÅRIO"}),r.jsx("div",{style:{fontSize:12},children:`FUN√á√ÉO: ${String(H?.funcao||"").toUpperCase()} | PERFIL: ${String(H?.perfil||"").toUpperCase()}`}),r.jsx("div",{style:{fontSize:12},children:`LOGIN: ${X||"--"} | TEMPO CONECTADO: ${J||"--:--:--"}`})]}),r.jsx(F,{size:"large"})]})]}),onCancel:a,footer:null,destroyOnHidden:!0,width:980,closable:!1,maskClosable:!1,className:"usuarios-modal",children:[r.jsx("style",{children:".usuarios-modal .ant-modal-header{ border-bottom: 1px solid #e8e8e8; } .usuarios-modal .ant-modal-content{ border-radius: 0 !important; } .usuarios-modal .ant-form-item{ margin-bottom:6px; }"}),r.jsxs(L,{form:o,layout:"vertical",children:[r.jsx("div",{style:{display:"grid",gap:16},children:(()=>{const e={};for(const a of l)e[a.name]=a;const t=["Funcao","Perfil","Usuario","Senha","Coordenador","Supervisor","Ativista"].filter(t=>e[t]);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:16},children:[r.jsx(G,{title:"Identifica√ß√£o",size:"small",children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 160px",gap:6,alignItems:"end"},children:[e.CPF&&r.jsx("div",{style:{width:"50%"},children:ye(e.CPF)}),e.Ativo&&r.jsx(L.Item,{name:"Ativo",label:"Ativo",valuePropName:"checked",style:{marginBottom:0},children:r.jsx(Q,{})}),e.Nome&&r.jsx("div",{style:{gridColumn:"1 / span 2"},children:ye(e.Nome)}),e.Celular&&r.jsx("div",{style:{width:"50%"},children:ye(e.Celular)}),e.Email&&r.jsx("div",{style:{gridColumn:"1 / span 2"},children:ye(e.Email)})]})}),r.jsx(G,{title:"Foto",size:"small",children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx(O,{onClick:async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:!0});q(e),R.current&&(R.current.srcObject=e,await R.current.play())}catch{}},children:"Usar Webcam"}),r.jsx(O,{onClick:()=>{const e=R.current;if(e){const t=document.createElement("canvas");t.width=e.videoWidth||640,t.height=e.videoHeight||480;const a=t.getContext("2d");if(a){a.drawImage(e,0,0,t.width,t.height);const r=t.toDataURL("image/jpeg",.92);o.setFieldsValue({ImagemUploadDataUrl:r}),W(r)}}},children:"Capturar"}),r.jsx(O,{onClick:()=>{V&&V.getTracks().forEach(e=>e.stop()),q(null)},children:"Encerrar"})]}),r.jsx("div",{children:r.jsx("input",{type:"file",accept:"image/*,.webp",onChange:e=>{const t=e.target.files?.[0];if(t){o.setFieldsValue({ImagemUploadFile:t});const e=new FileReader;e.onload=()=>{const t=e.result;o.setFieldsValue({ImagemUploadDataUrl:t}),W(t)},e.readAsDataURL(t)}}})}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:V?r.jsx("video",{ref:R,style:{width:"100%",maxWidth:360,borderRadius:8}}):B?r.jsx("img",{src:B,alt:"Preview",style:{width:"100%",maxWidth:360,borderRadius:8,background:"#f5f5f5"}}):r.jsx("div",{style:{width:360,height:240,background:"#fafafa",border:"1px dashed #ddd",borderRadius:8}})})]})})]}),r.jsx(G,{title:"Acesso",size:"small",children:r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:t.map(t=>ye(e[t]))})})]})})()}),r.jsxs(z,{style:{marginTop:16,display:"flex",justifyContent:"flex-end",width:"100%"},children:[r.jsx(O,{onClick:a,icon:r.jsx(Z,{}),children:"CANCELAR"}),r.jsx(O,{type:"primary",onClick:async()=>{try{const s=await o.validateFields();if(s.Perfil&&!s.IdPerfil){const e=y[String(s.Perfil)];void 0!==e&&(s.IdPerfil=e)}if(s.Funcao){const e=String(s.Funcao),t=v[e];void 0!==t&&(s.IdFuncao=t),s.Funcao=e}s.IdPerfil&&delete s.Perfil,s.IdFuncao&&delete s.Funcao;const n=String(s.Nome||"").trim(),l=String(s.Funcao||"").toUpperCase().trim();if("ADMINISTRADOR"===l||"COORDENADOR"===l)s.Coordenador=n,s.Supervisor="NAO SE APLICA",s.Ativista="NAO SE APLICA";else if("SUPERVISOR"===l){if(!String(s.Coordenador||"").trim())throw new Error("Coordenador √© obrigat√≥rio");s.Supervisor=n,s.Ativista="NAO SE APLICA"}else if("ATIVISTA"===l){if(!String(s.Coordenador||"").trim())throw new Error("Coordenador √© obrigat√≥rio");if(!String(s.Supervisor||"").trim())throw new Error("Supervisor √© obrigat√≥rio");s.Ativista=n}if("string"==typeof s.Celular){const e=String(s.Celular);s.Celular=e.length>15?e.slice(0,15):e}const c=async()=>{const e=new Set([...d,"IdPerfil","IdFuncao"]);e.delete("IdTenant");const a={};for(const t of Object.keys(s))e.has(t)&&(a[t]=s[t]);if(a.IdPerfil&&delete a.Perfil,a.IdFuncao&&delete a.Funcao,t?.IdUsuario){const e=await D.updateUsuario(t.IdUsuario,a);return Pt.success("Usu√°rio atualizado"),e.id}{const e=await D.createUsuario(a);return Pt.success("Usu√°rio criado"),e.id}},u=String(localStorage.getItem("tenantName")||"CAPTAR"),m=String(s.TenantLayer||u);if("CAPTAR"===String(u).toUpperCase()){const e=String(s.Coordenador||"").trim(),t=String(s.Supervisor||"").trim();if(e){const t=String(T[e]||m);if(t&&m&&t.toUpperCase()!==m.toUpperCase())return void Pt.error("N√£o √© poss√≠vel vincular: Tenants diferentes")}if(t){const e=String(k[t]||m);if(e&&m&&e.toUpperCase()!==m.toUpperCase())return void Pt.error("N√£o √© poss√≠vel vincular: Tenants diferentes")}}try{const e=(await D.listTenants()).rows||[],t=String(s.TenantLayer||m);(e.find(e=>String(e.Nome??e.nome).toUpperCase()===t.toUpperCase())||e.find(e=>String(e.Slug??e.slug).toUpperCase()===String(localStorage.getItem("tenantSlug")||"captar").toUpperCase()))&&delete s.IdTenant}catch{}try{const t=await c();if(o.getFieldValue("ImagemUploadFile")||o.getFieldValue("ImagemUploadDataUrl")){const r=o.getFieldValue("ImagemUploadFile"),s=o.getFieldValue("ImagemUploadDataUrl");try{await D.uploadUsuarioFoto(t,{file:r,data_url:s}),s&&W(s)}catch{try{if(r&&"image/webp"===r.type||s&&String(s).startsWith("data:image/webp")){const n=s||(r?await(a=r,new Promise((e,t)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=e=>t(e),r.readAsDataURL(a)})):void 0);if(n){const a=await(e=n,new Promise((t,a)=>{const r=new Image;r.onload=()=>{const a=document.createElement("canvas");a.width=r.width||640,a.height=r.height||480;const s=a.getContext("2d");if(s){s.drawImage(r,0,0);try{const e=a.toDataURL("image/jpeg",.92);t(e)}catch(n){t(e)}}else t(e)},r.onerror=e=>a(e),r.src=e}));await D.uploadUsuarioFoto(t,{data_url:a}),W(a)}}}catch{}}}}catch(r){const e=r?.response?.data?.detail||"";if(!s.Celular||"string"!=typeof s.Celular||!e.includes("character varying(15)")){const e=r?.response?.data?.detail||r?.message||"Falha ao salvar usu√°rio";throw Pt.error(e),r}s.Celular=s.Celular.replace(" ",""),await c(),Pt.warning("Celular ajustado para caber no limite atual do banco")}i()}catch{}var e,a},icon:r.jsx(ee,{}),children:"SALVAR"})]})]})]})}const{message:Pt}=X.useApp();function kt(){const[e,t]=f.useState([]),[a,s]=f.useState(!1),[n,i]=f.useState(!1),[o,l]=f.useState(null),[c,d]=f.useState([]),[u,p]=f.useState({}),[h,g]=f.useState([]),x=Ie(),{user:y}=gt(),j=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z",fill:"currentColor"}),r.jsx("path",{d:"M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z",fill:"currentColor"})]}),v=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M6 7h12M9 7v10m6-10v10M4 7h16l-1 14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2L4 7z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),S=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M3 4h6v16H3V4zm12 0h6v16h-6V4z",fill:"currentColor"})}),b=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("circle",{cx:"12",cy:"8",r:"4",stroke:"currentColor",strokeWidth:"2"}),r.jsx("path",{d:"M4 20c0-3.866 3.582-7 8-7s8 3.134 8 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),r.jsx("path",{d:"M18 6h3M19.5 4.5v3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),w=async()=>{try{s(!0);const e=await x.getUsuariosSchema(),a=["IdUsuario","Nome","CPF","Usuario","Funcao","Perfil","Email","DataCadastro","Cadastrante","TenantLayer","Ativo"],r={};for(const t of e.columns||[])r[t.name]=t;const n=a.filter(e=>r[e]).map(e=>r[e]),i=(e.columns||[]).filter(e=>!a.includes(e.name));d([...n,...i]);let o=(await x.listUsuarios()).rows||[];try{const e=(await x.listPerfil()).rows||[],t=e=>e.IdPerfil??e.id??e.Id??e.ID,a=e=>e.Perfil??e.perfil,r=new Map;for(const i of e){const e=t(i),s=a(i);void 0!==e&&void 0!==s&&r.set(Number(e),String(s))}const s=(await x.listFuncoes()).rows||[],n=new Map;for(const i of s){const e=i.IdFuncao??i.id??i.Id??i.ID,t=i.Funcao??i.Descricao;void 0!==e&&void 0!==t&&n.set(Number(e),String(t))}o=o.map(e=>{const t=e.IdPerfil??e.idPerfil??e.id_perfil,a=void 0!==t?r.get(Number(t)):e.Perfil??e.perfil,s=e.IdFuncao??e.idFuncao??e.id_funcao;let i=void 0!==s?n.get(Number(s)):void 0;if(!i){const t=e.Funcao,a=Number(t);i=!isNaN(a)&&String(a)===String(t)?n.get(a):t}return{...e,Perfil:a??e.Perfil,Funcao:i??e.Funcao}})}catch{}t(o);const l={};for(const t of a)r[t]&&(l[t]=!0);for(const t of i)l[t.name]=!1;r.IdPerfil&&(l.IdPerfil=!1);const c=`usuarios.columns.visible.${y?.usuario||"default"}`,u=localStorage.getItem(c);p(u?JSON.parse(u):l);const m=`usuarios.columns.order.${y?.usuario||"default"}`,h=localStorage.getItem(m);g(h?JSON.parse(h):a.filter(e=>r[e]))}catch(e){B.error(e?.response?.data?.detail||"Erro ao carregar usu√°rios")}finally{s(!1)}};f.useEffect(()=>{w()},[]);const C=c.map(t=>{const a=t.name,s=Array.from(new Set((e||[]).map(e=>e[a]).filter(e=>null!=e))).slice(0,20).map(e=>({text:Array.isArray(e)?String(e.join(", ")).toUpperCase():String(e).toUpperCase(),value:Array.isArray(e)?String(e.join(", ")).toUpperCase():String(e).toUpperCase()})),n=(t.type||"").toLowerCase(),i=new Set(["IdUsuario","Ativo","CPF","Funcao","Perfil","DataCadastro","TenantLayer","DataUpdate","UltimoAcesso","TokenExpiracao"]),o={title:{IdUsuario:"ID",Nome:"NOME",CPF:"CPF",Usuario:"USU√ÅRIO",Funcao:"FUN√á√ÉO",Perfil:"PERFIL",Email:"EMAIL",DataCadastro:"DATA E HORA DE CADASTRO",Cadastrante:"CADASTRANTE",TenantLayer:"TENANT LAYER",Ativo:"ATIVO"}[a]||a.toUpperCase(),dataIndex:a,align:i.has(a)?"center":"left",filters:s,onFilter:(e,t)=>String(t[a]).toUpperCase()===String(e).toUpperCase(),sorter:(e,t)=>{const r=e[a],s=t[a];if(null==r)return-1;if(null==s)return 1;if(Array.isArray(r)||Array.isArray(s)){const e=Array.isArray(r)?r.join(", "):String(r),t=Array.isArray(s)?s.join(", "):String(s);return e.toUpperCase().localeCompare(t.toUpperCase())}return n.includes("int")||n.includes("numeric")?Number(r)-Number(s):n.includes("date")||n.includes("timestamp")?new Date(r).getTime()-new Date(s).getTime():String(r).toUpperCase().localeCompare(String(s).toUpperCase())},sortDirections:["ascend","descend"],render:e=>{if("boolean"==typeof e)return e?"SIM":"N√ÉO";if(null==e)return"";if(Array.isArray(e))return e.map(e=>String(e).toUpperCase()).join(" | ");const t=new Set(["DataUpdate","UltimoAcesso","TokenExpiracao"]);if(n.includes("date")||n.includes("timestamp")){const r=new Date(e);if(!isNaN(r.getTime())){if("DataCadastro"===a)return r.toLocaleString("pt-BR",{hour12:!1});if(t.has(a))return r.toLocaleTimeString("pt-BR",{hour12:!1})}}if("Ativo"===a){const t="true"===String(e).toLowerCase()||1===e||"SIM"===String(e).toUpperCase();return r.jsx(V,{color:t?"green":"red",children:t?"SIM":"N√ÉO"})}return"Email"===a?String(e).toLowerCase():String(e).toUpperCase()},onHeaderCell:()=>({draggable:!0,onDragStart:e=>{e.dataTransfer.setData("text/plain",a)},onDragOver:e=>{e.preventDefault()},onDrop:e=>{const t=e.dataTransfer.getData("text/plain"),r=a;t&&t!==r&&g(e=>{const a=e.filter(e=>e!==t),s=a.indexOf(r);if(-1===s)return e;a.splice(s,0,t);const n=`usuarios.columns.order.${y?.usuario||"default"}`;return localStorage.setItem(n,JSON.stringify(a)),a})}})};return"IdUsuario"===a&&(o.defaultSortOrder="ascend"),o}),I={title:"A√á√ïES",dataIndex:"__actions__",render:(e,t)=>r.jsxs(z,{children:[r.jsx(O,{type:"text",icon:r.jsx(j,{}),title:"EDITAR",onClick:()=>{l(t),i(!0)}}),r.jsx(O,{type:"text",danger:!0,icon:r.jsx(v,{}),title:"DELETAR",onClick:async()=>{try{if(!t.IdUsuario)return void B.info("REGISTRO SEM ID");await x.deleteUsuario(t.IdUsuario),B.success("USU√ÅRIO DELETADO"),await w()}catch(e){B.error(e?.response?.data?.detail||"ERRO AO DELETAR USU√ÅRIO")}}})]})},A=(h.length?h:C.map(e=>e.dataIndex)).map(e=>C.find(t=>t.dataIndex===e)).filter(Boolean).filter(e=>u[e.dataIndex]).concat([I]),T=r.jsx("div",{style:{padding:12},children:c.map(e=>r.jsx("div",{style:{marginBottom:6},children:r.jsx(se,{checked:!!u[e.name],onChange:t=>{const a={...u,[e.name]:t.target.checked};p(a);const r=`usuarios.columns.visible.${y?.usuario||"default"}`;localStorage.setItem(r,JSON.stringify(a))},children:e.name.toUpperCase()})},e.name))});return r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:r.jsxs(z,{children:[r.jsx(N,{placement:"bottomRight",trigger:["click"],menu:{items:[]},popupRender:()=>T,children:r.jsx(O,{shape:"circle",icon:r.jsx(S,{}),style:{background:"#FFD700",borderColor:"#FFD700",color:"#000"},title:"VISUALIZA√á√ÉO DE COLUNAS"})}),r.jsx(O,{shape:"circle",icon:r.jsx(b,{}),style:{background:"#FFD700",borderColor:"#FFD700",color:"#000"},onClick:()=>{l(null),i(!0)},title:"NOVO USU√ÅRIO"})]})}),r.jsx("style",{children:"\n        .usuarios-table .ant-table-thead > tr > th{ background:#FFD700; color:#000; font-family: 'Arimo', Arial, sans-serif; }\n        .usuarios-table .ant-table-thead > tr > th .ant-table-column-title{ display:flex; justify-content:center; align-items:center; text-align:center; }\n        .usuarios-table .ant-table-tbody > tr > td{ font-family: 'Roboto Condensed', Arial, sans-serif; padding:2px 6px; line-height:0.95; height:22px; }\n      "}),r.jsx(H,{loading:a,dataSource:e,columns:A,rowKey:e=>e.IdUsuario??e.id??e.ID??e.id_usuario??JSON.stringify(e),bordered:!0,size:"small",className:"ant-table-striped usuarios-table"}),r.jsx(Tt,{open:n,initial:o||void 0,onCancel:()=>i(!1),onSaved:async()=>{i(!1),await w()}})]})}function Ut(){const[e,t]=f.useState([]),[a,s]=f.useState(!1),[n,i]=f.useState(!1),[o,l]=f.useState(null),[c]=L.useForm(),d=Ie();f.useEffect(()=>{u()},[]);const u=async()=>{try{s(!0);const e=await d.getPermissoes();t(e)}catch(e){B.error("Erro ao carregar permiss√µes")}finally{s(!1)}},m=[{title:"PERFIL",dataIndex:"perfil",key:"perfil",sorter:(e,t)=>String(e.perfil).toUpperCase().localeCompare(String(t.perfil).toUpperCase()),sortDirections:["ascend","descend"]},{title:"DESCRI√á√ÉO",dataIndex:"descricao",key:"descricao",sorter:(e,t)=>String(e.descricao).toUpperCase().localeCompare(String(t.descricao).toUpperCase()),sortDirections:["ascend","descend"]},{title:"A√á√ïES",key:"actions",render:(e,t)=>r.jsx(z,{children:r.jsx(O,{type:"text",onClick:()=>(e=>{l(e.id),c.setFieldsValue(e),i(!0)})(t),children:"‚úé"})})}];return r.jsxs("div",{style:{padding:"24px"},children:[r.jsx(H,{columns:m,dataSource:e,loading:a,rowKey:"id",pagination:{pageSize:10}}),r.jsx(M,{title:o?"Editar Permiss√£o":"Nova Permiss√£o",open:n,onOk:()=>c.submit(),onCancel:()=>i(!1),width:800,children:r.jsxs(L,{form:c,layout:"vertical",onFinish:async e=>{try{o&&(await d.updatePermissao(e.perfil,e),B.success("Permiss√£o atualizada com sucesso")),i(!1),u()}catch(t){B.error("Erro ao salvar permiss√£o")}},children:[r.jsx(L.Item,{name:"perfil",label:"Perfil",rules:[{required:!0}],children:r.jsx("input",{disabled:!0})}),r.jsx(L.Item,{name:"descricao",label:"Descri√ß√£o",children:r.jsx("input",{})}),r.jsxs(ue,{gutter:16,children:[r.jsx(me,{span:12,children:r.jsxs(G,{title:"Eleitores",children:[r.jsxs(L.Item,{name:"pode_criar_eleitor",valuePropName:"checked",children:[r.jsx(Q,{})," Criar"]}),r.jsxs(L.Item,{name:"pode_editar_eleitor",valuePropName:"checked",children:[r.jsx(Q,{})," Editar"]}),r.jsxs(L.Item,{name:"pode_deletar_eleitor",valuePropName:"checked",children:[r.jsx(Q,{})," Deletar"]})]})}),r.jsx(me,{span:12,children:r.jsxs(G,{title:"Ativistas",children:[r.jsxs(L.Item,{name:"pode_criar_ativista",valuePropName:"checked",children:[r.jsx(Q,{})," Criar"]}),r.jsxs(L.Item,{name:"pode_editar_ativista",valuePropName:"checked",children:[r.jsx(Q,{})," Editar"]}),r.jsxs(L.Item,{name:"pode_deletar_ativista",valuePropName:"checked",children:[r.jsx(Q,{})," Deletar"]})]})})]}),r.jsxs(ue,{gutter:16,children:[r.jsx(me,{span:12,children:r.jsxs(G,{title:"Usu√°rios",children:[r.jsxs(L.Item,{name:"pode_criar_usuario",valuePropName:"checked",children:[r.jsx(Q,{})," Criar"]}),r.jsxs(L.Item,{name:"pode_editar_usuario",valuePropName:"checked",children:[r.jsx(Q,{})," Editar"]}),r.jsxs(L.Item,{name:"pode_deletar_usuario",valuePropName:"checked",children:[r.jsx(Q,{})," Deletar"]})]})}),r.jsx(me,{span:12,children:r.jsxs(G,{title:"Sistema",children:[r.jsxs(L.Item,{name:"pode_enviar_disparos",valuePropName:"checked",children:[r.jsx(Q,{})," Disparos"]}),r.jsxs(L.Item,{name:"pode_ver_relatorios",valuePropName:"checked",children:[r.jsx(Q,{})," Relat√≥rios"]}),r.jsxs(L.Item,{name:"pode_exportar_dados",valuePropName:"checked",children:[r.jsx(Q,{})," Exportar"]}),r.jsxs(L.Item,{name:"pode_importar_dados",valuePropName:"checked",children:[r.jsx(Q,{})," Importar"]})]})})]})]})})]})}const Et=()=>{const[e]=L.useForm(),[t,a]=f.useState(!1),[s,n]=f.useState([]),[i,o]=f.useState({current:1,pageSize:10,total:0}),l=[{title:"ID",dataIndex:"id",key:"id",width:80,sorter:(e,t)=>String(e.id).localeCompare(String(t.id)),sortDirections:["ascend","descend"]},{title:"NOME",dataIndex:"nome",key:"nome",width:150,sorter:(e,t)=>String(e.nome).toUpperCase().localeCompare(String(t.nome).toUpperCase()),sortDirections:["ascend","descend"]},{title:"TIPO",dataIndex:"tipo",key:"tipo",width:120,sorter:(e,t)=>String(e.tipo).toUpperCase().localeCompare(String(t.tipo).toUpperCase()),sortDirections:["ascend","descend"]},{title:"DATA",dataIndex:"data",key:"data",width:120,sorter:(e,t)=>new Date(e.data).getTime()-new Date(t.data).getTime(),sortDirections:["ascend","descend"]},{title:"STATUS",dataIndex:"status",key:"status",width:100,sorter:(e,t)=>String(e.status).toUpperCase().localeCompare(String(t.status).toUpperCase()),sortDirections:["ascend","descend"],render:e=>r.jsx("span",{style:{color:{ativo:"green",inativo:"red",pendente:"orange"}[e]||"black"},children:String(e).toUpperCase()})},{title:"RESULTADO",dataIndex:"resultado",key:"resultado",width:200,sorter:(e,t)=>String(e.resultado).toUpperCase().localeCompare(String(t.resultado).toUpperCase()),sortDirections:["ascend","descend"]}];return r.jsx("div",{className:"consultas-container",children:r.jsxs(G,{title:"Consultas Avan√ßadas",className:"consultas-card",children:[r.jsxs(L,{form:e,layout:"vertical",onFinish:async()=>{a(!0);try{const e=[{id:"1",nome:"Eleitor 1",tipo:"Eleitor",data:"2025-01-15",status:"ativo",resultado:"Encontrado"},{id:"2",nome:"Ativista 2",tipo:"Ativista",data:"2025-01-14",status:"ativo",resultado:"Encontrado"}];n(e),o({...i,total:e.length})}catch(e){console.error("Erro ao buscar:",e)}finally{a(!1)}},className:"consultas-form",children:[r.jsxs(ue,{gutter:16,children:[r.jsx(me,{xs:24,sm:12,md:8,children:r.jsx(L.Item,{label:"Buscar por",name:"searchType",initialValue:"nome",children:r.jsx(te,{options:[{label:"Nome",value:"nome"},{label:"CPF",value:"cpf"},{label:"Email",value:"email"},{label:"Telefone",value:"telefone"}]})})}),r.jsx(me,{xs:24,sm:12,md:8,children:r.jsx(L.Item,{label:"Valor",name:"searchValue",rules:[{required:!0,message:"Digite um valor"}],children:r.jsx(_,{placeholder:"Digite o valor para buscar"})})}),r.jsx(me,{xs:24,sm:12,md:8,children:r.jsx(L.Item,{label:"Tipo",name:"tipo",initialValue:"todos",children:r.jsx(te,{options:[{label:"Todos",value:"todos"},{label:"Eleitor",value:"eleitor"},{label:"Ativista",value:"ativista"},{label:"Usu√°rio",value:"usuario"}]})})})]}),r.jsxs(ue,{gutter:16,children:[r.jsx(me,{xs:24,sm:12,md:8,children:r.jsx(L.Item,{label:"Data Inicial",name:"dataInicial",children:r.jsx(ne,{style:{width:"100%"}})})}),r.jsx(me,{xs:24,sm:12,md:8,children:r.jsx(L.Item,{label:"Data Final",name:"dataFinal",children:r.jsx(ne,{style:{width:"100%"}})})}),r.jsx(me,{xs:24,sm:12,md:8,children:r.jsx(L.Item,{label:"Status",name:"status",initialValue:"todos",children:r.jsx(te,{options:[{label:"Todos",value:"todos"},{label:"Ativo",value:"ativo"},{label:"Inativo",value:"inativo"},{label:"Pendente",value:"pendente"}]})})})]}),r.jsx(L.Item,{children:r.jsxs(z,{children:[r.jsx(O,{type:"primary",htmlType:"submit",icon:r.jsx(pe,{}),loading:t,children:"Buscar"}),r.jsx(O,{icon:r.jsx(he,{}),onClick:()=>{e.resetFields(),n([])},children:"Limpar"}),r.jsx(O,{icon:r.jsx(ge,{}),onClick:()=>{console.log("Exportando resultados...")},disabled:0===s.length,children:"Exportar"})]})})]}),r.jsx(H,{columns:l,dataSource:s,loading:t,pagination:i,rowKey:"id",size:"middle",bordered:!0,className:"ant-table-striped"})]})})};function Nt({open:e,initial:t,onCancel:a,onSaved:s}){const[n]=L.useForm(),[i,o]=f.useState([]),l=Ie();f.useEffect(()=>{e&&((async()=>{try{const e=await l.getPerfilSchema();o(e.columns||[])}catch{}})(),t?n.setFieldsValue(t):n.resetFields())},[e,t]);return r.jsx(M,{open:e,title:t?.id?"Editar Perfil":"Novo Perfil",onCancel:a,footer:null,destroyOnHidden:!0,children:r.jsxs(L,{form:n,layout:"vertical",children:[i.map(e=>{if("IdPerfil"===e.name)return null;const t=!e.nullable,a=e.type.toLowerCase();if(a.includes("boolean"))return r.jsx(L.Item,{name:e.name,valuePropName:"checked",label:e.name,children:r.jsx(se,{})},e.name);if(a.includes("date")){const s=a.includes("timestamp");return r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:t}],children:r.jsx(ne,{style:{width:"100%"},showTime:s})},e.name)}return a.includes("int")||a.includes("numeric")?r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:t}],children:r.jsx(ie,{style:{width:"100%"}})},e.name):r.jsx(L.Item,{name:e.name,label:e.name,rules:[{required:t}],children:r.jsx(_,{})},e.name)}),r.jsxs(z,{style:{marginTop:16},children:[r.jsx(O,{onClick:a,children:"Cancelar"}),r.jsx(O,{type:"primary",onClick:async()=>{try{const e=await n.validateFields();t?.IdPerfil?(await l.updatePerfil(t.IdPerfil,e),B.success("Perfil atualizado")):(await l.createPerfil(e),B.success("Perfil criado")),s()}catch{}},children:"Salvar"})]})]})})}function Ot(){const[e,t]=f.useState([]),[a,s]=f.useState(!1),[n,i]=f.useState(!1),[o,l]=f.useState(null),[c,d]=f.useState([]),[u,p]=f.useState({}),h=Ie(),g=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z",fill:"currentColor"}),r.jsx("path",{d:"M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z",fill:"currentColor"})]}),x=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M6 7h12M9 7v10m6-10v10M4 7h16l-1 14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2L4 7z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),y=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M3 4h6v16H3V4zm12 0h6v16h-6V4z",fill:"currentColor"})}),j=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),v=async()=>{try{s(!0);const e=await h.getPerfilSchema();d(e.columns||[]);const a=await h.listPerfil();t(a.rows||[]);const r={};for(const t of e.columns||[])r[t.name]=!0;p(r)}catch(e){B.error(e?.response?.data?.detail||"Erro ao carregar perfil")}finally{s(!1)}};f.useEffect(()=>{v()},[]);const S={title:"A√á√ïES",dataIndex:"__actions__",render:(e,t)=>r.jsxs(z,{children:[r.jsx(O,{type:"text",icon:r.jsx(g,{}),onClick:()=>{l(t),i(!0)}}),r.jsx(O,{type:"text",danger:!0,icon:r.jsx(x,{}),onClick:async()=>{try{if(!t.IdPerfil)return void B.info("REGISTRO SEM ID");await h.deletePerfil(t.IdPerfil),B.success("PERFIL DELETADO"),await v()}catch(e){B.error(e?.response?.data?.detail||"ERRO AO DELETAR PERFIL")}}})]})},b=c.map(t=>{const a=t.name,r=Array.from(new Set((e||[]).map(e=>e[a]).filter(e=>null!=e))).slice(0,20).map(e=>({text:String(e).toUpperCase(),value:String(e).toUpperCase()})),s=(t.type||"").toLowerCase();return{title:a.toUpperCase(),dataIndex:a,filters:r,onFilter:(e,t)=>String(t[a]).toUpperCase()===String(e).toUpperCase(),sorter:(e,t)=>{const r=e[a],n=t[a];return null==r?-1:null==n?1:s.includes("int")||s.includes("numeric")?Number(r)-Number(n):s.includes("date")||s.includes("timestamp")?new Date(r).getTime()-new Date(n).getTime():String(r).toUpperCase().localeCompare(String(n).toUpperCase())},sortDirections:["ascend","descend"],render:e=>"boolean"==typeof e?e?"SIM":"N√ÉO":null==e?"":String(e).toUpperCase()}}).filter(e=>u[e.dataIndex]).concat([S]),w=r.jsx("div",{style:{padding:12},children:c.map(e=>r.jsx("div",{style:{marginBottom:6},children:r.jsx(se,{checked:!!u[e.name],onChange:t=>p({...u,[e.name]:t.target.checked}),children:e.name})},e.name))});return r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:r.jsxs(z,{children:[r.jsx(N,{placement:"bottomRight",trigger:["click"],menu:{items:[]},popupRender:()=>w,children:r.jsx(O,{icon:r.jsx(y,{}),children:"COLUNAS"})}),r.jsx(O,{type:"primary",icon:r.jsx(j,{}),onClick:()=>{l(null),i(!0)},children:"NOVO PERFIL"})]})}),r.jsx(H,{loading:a,dataSource:e,columns:b,rowKey:e=>e.IdPerfil||JSON.stringify(e),bordered:!0,size:"middle",className:"ant-table-striped"}),r.jsx(Nt,{open:n,initial:o||void 0,onCancel:()=>i(!1),onSaved:async()=>{i(!1),await v()}})]})}function Ft({open:e,initial:t,onCancel:a,onSaved:s}){const[n]=L.useForm(),i=Ie(),[o,l]=f.useState([]);f.useEffect(()=>{e&&((async()=>{try{const e=await i.listPerfil();l(e.rows||[])}catch{}})(),t?n.setFieldsValue(t):n.resetFields())},[e,t]);return r.jsx(M,{open:e,title:t?.IdFuncao?"Editar Fun√ß√£o":"Nova Fun√ß√£o",onCancel:a,footer:null,destroyOnHidden:!0,children:r.jsxs(L,{form:n,layout:"vertical",children:[r.jsx(L.Item,{name:"Funcao",label:"Funcao",rules:[{required:!0}],children:r.jsx(_,{})}),r.jsx(L.Item,{name:"Perfil",label:"Perfil",rules:[{required:!0}],children:r.jsx(te,{placeholder:"Selecione um perfil",showSearch:!0,options:(o||[]).map(e=>({label:e.Perfil??e.Nome??e.Descricao??String(e.IdPerfil??""),value:e.Perfil??String(e.IdPerfil??"")})),filterOption:(e,t)=>t?.label?.toLowerCase().includes(e.toLowerCase())})}),r.jsx(L.Item,{name:"Cadastrante",label:"Cadastrante",children:r.jsx(_,{})}),r.jsx(L.Item,{name:"Candidato",label:"Candidato",children:r.jsx(_,{})}),r.jsx(L.Item,{name:"TenantLayer",label:"TenantLayer",children:r.jsx(_,{})}),r.jsx(L.Item,{name:"Ativo",label:"Ativo",valuePropName:"checked",children:r.jsx(Q,{})}),r.jsxs(z,{style:{marginTop:16},children:[r.jsx(O,{onClick:a,children:"Cancelar"}),r.jsx(O,{type:"primary",onClick:async()=>{try{const e=await n.validateFields();t?.IdFuncao?(await i.updateFuncao(t.IdFuncao,e),B.success("Fun√ß√£o atualizada")):(await i.createFuncao(e),B.success("Fun√ß√£o criada")),s()}catch{}},children:"Salvar"})]})]})})}function Dt(){const[e,t]=f.useState([]),[a,s]=f.useState(!1),[n,i]=f.useState(!1),[o,l]=f.useState(null),[c,d]=f.useState([]),[u,p]=f.useState({}),h=Ie(),g=()=>r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z",fill:"currentColor"}),r.jsx("path",{d:"M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z",fill:"currentColor"})]}),x=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M6 7h12M9 7v10m6-10v10M4 7h16l-1 14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2L4 7z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),y=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M3 4h6v16H3V4zm12 0h6v16h-6V4z",fill:"currentColor"})}),j=()=>r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),v=(c||[]).map(e=>({title:e.name,dataIndex:e.name})),S=async()=>{try{s(!0);const e=await h.getFuncoesSchema();d(e.columns||[]);const a=await h.listFuncoes();t(a.rows||[]);const r={};for(const t of e.columns||[])r[t.name]=!0;p(r)}catch(e){B.error(e?.response?.data?.detail||"Erro ao carregar fun√ß√µes")}finally{s(!1)}};f.useEffect(()=>{S()},[]);const b={title:"A√ß√µes",key:"actions",render:(e,t)=>r.jsxs(z,{children:[r.jsx(O,{type:"text",icon:r.jsx(g,{}),onClick:()=>{l(t),i(!0)}}),r.jsx(O,{type:"text",danger:!0,icon:r.jsx(x,{}),onClick:async()=>{try{if(!t.IdFuncao)return void B.info("REGISTRO SEM ID");await h.deleteFuncao(t.IdFuncao),B.success("Fun√ß√£o deletada"),await S()}catch(e){B.error(e?.response?.data?.detail||"Erro ao deletar fun√ß√£o")}}})]})},w=v.filter(e=>u[e.dataIndex]).concat([b]),C=r.jsx("div",{style:{padding:12},children:v.map(e=>r.jsx("div",{style:{marginBottom:6},children:r.jsx(se,{checked:!!u[e.dataIndex],onChange:t=>p({...u,[e.dataIndex]:t.target.checked}),children:e.title})},e.dataIndex))});return r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:r.jsxs(z,{children:[r.jsx(N,{placement:"bottomRight",trigger:["click"],menu:{items:[]},popupRender:()=>C,children:r.jsx(O,{icon:r.jsx(y,{}),children:"COLUNAS"})}),r.jsx(O,{type:"primary",icon:r.jsx(j,{}),onClick:()=>{l(null),i(!0)},children:"NOVA FUN√á√ÉO"})]})}),r.jsx(H,{bordered:!0,size:"small",loading:a,columns:w,dataSource:e,rowKey:e=>e.IdFuncao}),r.jsx(Ft,{open:n,initial:o,onCancel:()=>i(!1),onSaved:async()=>{i(!1),await S()}})]})}function Rt(){const[e]=L.useForm(),[t]=L.useForm(),[s]=L.useForm(),[n,i]=f.useState("DESCONECTADO"),[o,l]=f.useState([]),[c,d]=f.useState([]),[u,p]=f.useState([]),[h,g]=f.useState([]),[x,y]=f.useState(0),j=Ie(),v=async()=>{try{const{dataset:t,uf:a}=e.getFieldsValue(),r=await j.listarRecursosCkan(t,a);d(r.resources||[]),y(0)}catch(t){try{const{dataset:t,uf:r}=e.getFieldsValue(),s=`https://dadosabertos.tse.jus.br/api/3/action/package_search?q=${encodeURIComponent(t)}`,n=await a.get(s),i=[];for(const e of n.data?.result?.results||[])for(const t of e.resources||[])i.push({id:t.id,name:t.name,format:t.format,url:t.url||t.download_url});let o="AM"===r?i.filter(e=>(e.name||"").toUpperCase().includes("AMAZONAS")||(e.name||"").toUpperCase().endsWith("AM")):i;if(!o.length){const e=["resultados","prestacao","eleicoes","candidatos"];for(const t of e){const e=`https://dadosabertos.tse.jus.br/api/3/action/package_search?q=${encodeURIComponent(t)}`,r=await a.get(e);for(const t of r.data?.result?.results||[])for(const e of t.resources||[]){const t={id:e.id,name:e.name,format:e.format,url:e.url||e.download_url};o.find(e=>e.id===t.id)||o.push(t)}if(o.length)break}"AM"===r&&(o=o.filter(e=>(e.name||"").toUpperCase().includes("AMAZONAS")||(e.name||"").toUpperCase().endsWith("AM")))}d(o),y(0)}catch{}}},S=async()=>{try{const e=c[x]||c[0];if(!e?.url)return void B.info("Nenhum recurso dispon√≠vel para pr√©via");const t=await j.previewRecursoCkan(e.url,15);p(t.columns),g(t.rows)}catch(e){try{const e=c[x]||c[0],t=await a.get(e.url),r="string"==typeof t.data?t.data:t.request?.responseText;if(!r)throw new Error("Sem dados");const s=r.split(/\r?\n/).filter(e=>e.trim().length>0);if(s.length<2)throw new Error("CSV vazio");const n=s[0].includes(";")?";":",",i=s[0].split(n).map(e=>e.trim()),o=s.slice(1,Math.min(s.length,16)).map(e=>{const t=e.split(n),a={};return i.forEach((e,r)=>{a[e]=(t[r]??"").trim()}),a});p(i),g(o)}catch(t){B.error(t?.message||"Erro ao carregar pr√©via")}}};return f.useEffect(()=>{(async()=>{await(async()=>{try{const e=localStorage.getItem("municipios_AM");if(e){const t=JSON.parse(e);Array.isArray(t)&&t.length&&l(t)}const t=await j.listarMunicipios("AM");l(t.municipios),localStorage.setItem("municipios_AM",JSON.stringify(t.municipios))}catch(e){try{const e=((await a.get("https://servicodados.ibge.gov.br/api/v1/localidades/estados/13/municipios")).data||[]).map(e=>({id:e.id,nome:e.nome}));l(e),localStorage.setItem("municipios_AM",JSON.stringify(e))}catch{}}})(),await v(),await S()})()},[]),r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsx("h1",{className:"page-title",children:"INTEGRA√á√ïES"}),r.jsxs(ue,{gutter:[16,16],children:[r.jsx(me,{xs:24,xl:16,children:r.jsx(G,{title:"APIS TSE",extra:r.jsx(V,{color:"blue",children:"AMAZONAS"}),children:r.jsxs(L,{form:e,layout:"vertical",initialValues:{baseUrl:"https://dadosabertos.tse.jus.br",uf:"AM",dataset:"eleitorado_municipio"},children:[r.jsxs(ue,{gutter:16,children:[r.jsx(me,{xs:24,md:12,children:r.jsx(L.Item,{name:"baseUrl",label:"Base URL",children:r.jsx(_,{placeholder:"https://dadosabertos.tse.jus.br"})})}),r.jsx(me,{xs:24,md:12,children:r.jsx(L.Item,{name:"uf",label:"UF",children:r.jsx(te,{options:[{label:"Amazonas",value:"AM"}]})})})]}),r.jsxs(ue,{gutter:16,children:[r.jsx(me,{xs:24,md:12,children:r.jsx(L.Item,{name:"dataset",label:"Dataset",children:r.jsx(te,{onChange:async()=>{await v(),await S()},options:[{label:"Eleitorado por munic√≠pio",value:"eleitorado_municipio"},{label:"Resultados por munic√≠pio",value:"resultados_municipio"},{label:"Zonas eleitorais",value:"zonas_eleitorais"},{label:"Candidatos",value:"candidatos"}]})})}),r.jsx(me,{xs:24,md:12,children:r.jsx(L.Item,{name:"municipio",label:"Munic√≠pio (opcional)",children:r.jsx(te,{showSearch:!0,placeholder:"Selecione um munic√≠pio",options:o.map(e=>({label:e.nome,value:e.nome}))})})})]}),r.jsxs(z,{children:[r.jsx(O,{type:"primary",onClick:async()=>{try{i("TESTANDO");const{baseUrl:t,uf:r,dataset:s,municipio:n}=e.getFieldsValue();try{const e=await j.testarIntegracao({base_url:t,uf:r,dataset:s,municipio:n});e.connected?(i("CONECTADO"),B.success("Conex√£o realizada com sucesso")):(i("DESCONECTADO"),B.error(`Falha na conex√£o (HTTP ${e.status_code})`))}catch{const e=await a.get(t),r=e.status>=200&&e.status<300;i(r?"CONECTADO":"DESCONECTADO"),B[r?"success":"error"](r?"Conex√£o realizada com sucesso":`Falha na conex√£o (HTTP ${e.status})`)}}catch(t){i("DESCONECTADO"),B.error(t?.response?.data?.detail||"Erro ao testar conex√£o")}},children:"Testar Conex√£o"}),r.jsx(O,{onClick:async()=>{try{const{baseUrl:a,uf:r,dataset:n,municipio:i}=e.getFieldsValue(),{webhookUrl:o,webhookSecret:l}=t.getFieldsValue(),{tseToken:c,externalApiToken:d}=s.getFieldsValue(),u={base_url:a,uf:r,dataset:n,municipio:i,webhook_url:o,webhook_secret:l,tse_token:c,external_api_token:d,active_webhook:!1};(await j.salvarIntegracaoConfig(u)).saved&&B.success("Configura√ß√£o salva")}catch(a){try{const{baseUrl:a,uf:r,dataset:n,municipio:i}=e.getFieldsValue(),{webhookUrl:o,webhookSecret:l}=t.getFieldsValue(),{tseToken:c,externalApiToken:d}=s.getFieldsValue(),u={base_url:a,uf:r,dataset:n,municipio:i,webhook_url:o,webhook_secret:l,tse_token:c,external_api_token:d,active_webhook:!1};localStorage.setItem("integracao_cfg",JSON.stringify(u)),B.success("Configura√ß√£o salva localmente")}catch{B.error(a?.response?.data?.detail||"Erro ao salvar configura√ß√£o")}}},children:"Salvar Configura√ß√£o"}),r.jsxs(V,{color:"CONECTADO"===n?"green":"TESTANDO"===n?"blue":"default",children:["STATUS: ",n]}),r.jsx(O,{onClick:async()=>{await v(),await S()},children:"Pr√©via Dataset (AM)"}),r.jsx(te,{style:{minWidth:240},placeholder:"Selecione recurso",value:c.length?x:void 0,onChange:e=>y(e),options:c.map((e,t)=>({label:e.name||e.url,value:t}))})]})]})})}),r.jsxs(me,{xs:24,xl:8,children:[r.jsx(G,{title:"Webhooks",children:r.jsxs(L,{form:t,layout:"vertical",children:[r.jsx(L.Item,{name:"webhookUrl",label:"URL",children:r.jsx(_,{placeholder:"https://seu-sistema.com/webhook"})}),r.jsx(L.Item,{name:"webhookSecret",label:"Segredo",children:r.jsx(_,{placeholder:"segredo-opcional"})}),r.jsxs(z,{children:[r.jsx(O,{type:"primary",children:"Salvar"}),r.jsx(Q,{checkedChildren:"Ativo",unCheckedChildren:"Inativo"})]})]})}),r.jsx(q,{}),r.jsx(G,{title:"Tokens / Credenciais",children:r.jsxs(L,{form:s,layout:"vertical",children:[r.jsx(L.Item,{name:"tseToken",label:"Token TSE (se aplic√°vel)",children:r.jsx(_,{placeholder:"insira seu token, se necess√°rio"})}),r.jsx(L.Item,{name:"externalApiToken",label:"Token API Externa",children:r.jsx(_,{placeholder:"token de outros servi√ßos"})}),r.jsx(O,{type:"primary",children:"Salvar"})]})}),r.jsx(q,{}),r.jsx(G,{title:"Pr√©via do Dataset Selecionado (primeiras linhas)",children:r.jsx(H,{size:"small",bordered:!0,pagination:!1,columns:u.map(e=>({title:e,dataIndex:e})),dataSource:h,rowKey:e=>JSON.stringify(e)})})]})]})]})}function Lt(){const[e]=L.useForm(),[t,a]=f.useState([]),[s]=f.useState(!1),n=[{title:"Meta",dataIndex:"nome"},{title:"Tipo",dataIndex:"tipo"},{title:"Valor",dataIndex:"valor"},{title:"UF",dataIndex:"uf"},{title:"Munic√≠pio",dataIndex:"municipio"},{title:"Prazo",dataIndex:"prazo"},{title:"Status",dataIndex:"status",render:e=>r.jsx(V,{color:"ATIVA"===e?"green":"default",children:e||"‚Äî"})}];return r.jsxs(m.div,{className:"page-container",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsx("h1",{className:"page-title",children:"METAS"}),r.jsxs(ue,{gutter:[16,16],children:[r.jsx(me,{xs:24,lg:12,children:r.jsx(G,{title:"Cadastrar Meta",children:r.jsxs(L,{form:e,layout:"vertical",onFinish:r=>{const s={id:Math.random().toString(36).slice(2),nome:r.nome,tipo:r.tipo,valor:r.valor,uf:r.uf,municipio:r.municipio,prazo:r.prazo?.format("YYYY-MM-DD"),status:"ATIVA"};a([s,...t]),e.resetFields()},children:[r.jsxs(ue,{gutter:16,children:[r.jsx(me,{xs:24,md:12,children:r.jsx(L.Item,{name:"nome",label:"Meta",rules:[{required:!0}],children:r.jsx(_,{placeholder:"Ex.: Eleitores cadastrados"})})}),r.jsx(me,{xs:24,md:12,children:r.jsx(L.Item,{name:"tipo",label:"Tipo",rules:[{required:!0}],children:r.jsx(te,{options:[{label:"Quantidade",value:"QUANTIDADE"},{label:"Percentual",value:"PERCENTUAL"}]})})})]}),r.jsxs(ue,{gutter:16,children:[r.jsx(me,{xs:24,md:12,children:r.jsx(L.Item,{name:"valor",label:"Valor",rules:[{required:!0}],children:r.jsx(ie,{style:{width:"100%"},min:0})})}),r.jsx(me,{xs:24,md:12,children:r.jsx(L.Item,{name:"prazo",label:"Prazo",children:r.jsx(ne,{style:{width:"100%"}})})})]}),r.jsxs(ue,{gutter:16,children:[r.jsx(me,{xs:24,md:12,children:r.jsx(L.Item,{name:"uf",label:"UF",children:r.jsx(te,{options:[{label:"Amazonas",value:"AM"}]})})}),r.jsx(me,{xs:24,md:12,children:r.jsx(L.Item,{name:"municipio",label:"Munic√≠pio",children:r.jsx(_,{placeholder:"Ex.: Manaus"})})})]}),r.jsxs(z,{children:[r.jsx(O,{type:"primary",htmlType:"submit",loading:s,children:"Salvar"}),r.jsx(O,{onClick:()=>e.resetFields(),children:"Limpar"})]})]})})}),r.jsxs(me,{xs:24,lg:12,children:[r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:r.jsxs(z,{children:[r.jsx(O,{children:"COLUNAS"}),r.jsx(O,{type:"primary",children:"NOVA META"})]})}),r.jsx(H,{size:"middle",bordered:!0,dataSource:t,columns:n.map(e=>({...e,title:String(e.title).toUpperCase()})),rowKey:"id",pagination:{pageSize:8},className:"ant-table-striped"})]})]})]})}const Mt=f.lazy(()=>mt(()=>import("./Dashboard-D61JVGhE.js"),__vite__mapDeps([0,1,2,3]))),_t=f.lazy(()=>mt(()=>import("./Estatisticas-ZH3CH1il.js"),__vite__mapDeps([4,1,2,3]))),$t=f.lazy(()=>mt(()=>import("./Tenants-vbvpcdq3.js"),__vite__mapDeps([5,1,2,3]))),zt=f.lazy(()=>mt(()=>import("./TenantParametros-C4cJGTSr.js"),__vite__mapDeps([6,1,2,3]))),{Content:Vt}=C;function qt(){const{isAuthenticated:e}=gt(),t=j(),a=("undefined"!=typeof window?localStorage.getItem("tenantSlug"):null)||"captar",s="captar"===String(a).toLowerCase();return r.jsx(p,{mode:"wait",children:r.jsx(m.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.25},children:r.jsxs(S,{location:t,children:[r.jsx(b,{path:"/login",element:r.jsx(Ct,{})}),r.jsx(b,{path:"/",element:e?r.jsx(f.Suspense,{fallback:r.jsx("div",{style:{padding:24},children:"Carregando..."}),children:r.jsx(Mt,{})}):r.jsx(w,{to:"/login"})}),r.jsx(b,{path:"/eleitores",element:e?r.jsx(It,{}):r.jsx(w,{to:"/login"})}),r.jsx(b,{path:"/ativistas",element:e?r.jsx(At,{}):r.jsx(w,{to:"/login"})}),r.jsx(b,{path:"/usuarios",element:e?r.jsx(kt,{}):r.jsx(w,{to:"/login"})}),r.jsx(b,{path:"/perfil",element:e?r.jsx(Ot,{}):r.jsx(w,{to:"/login"})}),r.jsx(b,{path:"/funcoes",element:e?r.jsx(Dt,{}):r.jsx(w,{to:"/login"})}),r.jsx(b,{path:"/permissoes",element:e?r.jsx(Ut,{}):r.jsx(w,{to:"/login"})}),r.jsx(b,{path:"/estatisticas",element:e?r.jsx(f.Suspense,{fallback:r.jsx("div",{style:{padding:24},children:"Carregando..."}),children:r.jsx(_t,{})}):r.jsx(w,{to:"/login"})}),r.jsx(b,{path:"/consultas",element:e?r.jsx(Et,{}):r.jsx(w,{to:"/login"})}),r.jsx(b,{path:"/integracoes",element:e?r.jsx(Rt,{}):r.jsx(w,{to:"/login"})}),r.jsx(b,{path:"/parametros/metas",element:e?r.jsx(Lt,{}):r.jsx(w,{to:"/login"})}),r.jsx(b,{path:"/parametros/tenants",element:e&&s?r.jsx(f.Suspense,{fallback:r.jsx("div",{style:{padding:24},children:"Carregando..."}),children:r.jsx($t,{})}):r.jsx(w,{to:"/"})}),r.jsx(b,{path:"/parametros/tenant-parametros",element:e&&s?r.jsx(f.Suspense,{fallback:r.jsx("div",{style:{padding:24},children:"Carregando..."}),children:r.jsx(zt,{})}):r.jsx(w,{to:"/"})}),r.jsx(b,{path:"*",element:r.jsx(w,{to:"/"})})]})},t.pathname)})}function Bt(){const{isAuthenticated:e}=gt();return r.jsxs(v,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[e&&r.jsx(bt,{}),r.jsx(C,{children:r.jsx(Vt,{className:"app-content",children:r.jsx(qt,{})})})]})}ve.createRoot(document.getElementById("root")).render(r.jsx(x.StrictMode,{children:r.jsx(fe,{locale:dt,theme:{algorithm:xe.defaultAlgorithm,token:{colorPrimary:"#667eea",borderRadius:10,fontSize:15,colorBgContainer:"#ffffff"},components:{Table:{headerBg:"#f5f7fa",headerColor:"#1f1f1f",borderRadius:8,rowHoverBg:"#e6f4ff"},Card:{borderRadiusLG:14},Button:{borderRadius:10}}},children:r.jsx(X,{children:r.jsx(Ce,{children:r.jsx(Bt,{})})})})}));export{be as a,Ie as u};
